game.import("extension",{name:"型月",content:function (config,pack){
    
},precontent:function (){
    
},help:{"型月":"<ul><li>首先感谢使用本拓展</li><li>bug反馈请前往无名杀吧，搜索“type-moon”</li><li>bug反馈了我不一定会看见(〜￣▽￣)〜</li><li>第一次做拓展请多包涵</li><li>本拓展引用了很多大神的代码，但并不是完全的引用</li><li>国战模式玩耍请关闭国战武将开关</li><li>对我不爽请到贴吧喷我，但是我会举报</li><li>如有雷同，算我抄你</li><li>ｸﾞｯ!(๑•̀ㅂ•́)و✧"},config:{},package:{
    character:{
        character:{
            "moon_1":["female","saber",5,["moon_1_4","moon_1_3","moon_1_2","moon_1_1"],["zhu","boss","bossallowed","des:刘秀（公元前6年—公元57年3月29日），字文叔，南阳郡蔡阳县人，出生于陈留郡济阳县，东汉王朝开国皇帝，中国历史上著名的政治家、军事家。 　　新莽末年，海内分崩，天下大乱，身为一介布衣却有前朝血统的刘秀在家乡乘势起兵。公元25年，刘秀与更始政权公开决裂，于河北鄗南千秋亭登基称帝，为表刘氏重兴之意，仍以“汉”为其国号，史称“东汉”。 　　经过长达十二年之久的统一战争，刘秀先后平灭了关东、陇右、西蜀等地的割据政权，结束了自新莽末年以来长达近二十年的军阀混战与割据局面。刘秀在位三十三年，大兴儒学、推崇气节，东汉一朝也被后世史家推崇为中国历史上“风化最美、儒学最盛”的时代。 　　建武中元（一作中元）二年（公元57年）二月初五日，刘秀在南宫前殿逝世，享年六十二岁。遗诏说：“我无益于百姓，后事都照孝文皇帝制度，务必俭省。刺史、二千石长吏都不要离开自己所在的城邑，不要派官员或通过驿传邮寄唁函吊唁。”刘秀死后，其子刘庄继位，于同年三月初五日，葬刘秀于原陵，上庙号世祖、谥号光武皇帝。"]],
            "moon_2":["female","assassin",3,["moon_2_1"],["des:两仪式是奈须蘑菇笔下人物，《空之境界》的女主角。出身于退魔四族之一的两仪家（另三家为七夜，巫浄和浅神），作为人为地生出双重人格者的两仪家的次女出生，多人格的素质得到承认，被指定成为两仪家家主的继承人，在『未来福音』时已经成为了正式家主。起源是『无』，名言是“只要是活著的东西，即使是神也杀给你看”。『式』这个名字具有公式、程式之意，意味这个躯体可如同电脑执行不同程式般完美执行各种事情。两仪这个姓指的就是太极，式和织分别代表著太极中的两仪，即阴和阳，这样的区分是因如此包含最多事物。式为阴性、女性的人格以及肯定之心；织为阳性，男性人格及否定之心。"]],
            "moon_4":["male","ruler",5,["moon_4_4","moon_4_3","moon_4_2","moon_4_1"],["des:天草四郎时贞。由东出佑一郎执笔的小说《Fate/Apocrypha》中登场的Master，同时也是第三次圣杯战争中爱因兹贝伦家所召唤出来的Ruler。由于并不是以强力而闻名的英灵，因此当时是靠着自己的谋略、战斗技巧以及Ruler所拥有的令咒来进行防守战。在第三次圣杯战争的最后接触了大圣杯而获得了肉身，并成为监督者言峰璃正的养子。[1] 黑幕的其中一人，实质上的最终头目。作为红之Lancer（迦尔纳）、红之Assassin（赛米拉米斯）、红之Archer（阿塔兰忒）、红之Rider（阿喀琉斯）、红之Caster（莎士比亚）、红之Berserker（斯巴达克斯）、黑之Caster（阿维斯布隆）的御主参与圣杯战争。想要利用圣杯战争，实现“拯救全人类”的宏愿。[2]"]],
            "moon_5":["none","rider",4,["moon_5_6","moon_5_5","moon_5_2","moon_5_1"],["des:阿斯托尔福是东出佑一郎执笔执笔的轻小说《Fate/Apocrypha》中登场所属“黑”阵营的Servant。 以Rider职介现世的Servant，查理曼十二勇士之一的美男子阿斯托尔福，天真烂漫，享乐主义的骑士。遵循自己的良心和愿望行动，绝不为此后悔。 能力值虽然稍稍劣于其他从者，但是以丰富的宝具弥补，玩弄对手。以随心所欲的行动在这次的圣杯大战中创造出意料之外的状况。"]],
            "moon_6":["male","assassin",4,["moon_6_3","moon_6_2","moon_6_1"],["boss","forbidai","bossallowed","des:李书文（1862~1934年），字同臣，河北沧州盐山县王南良村人。一生为人光明磊落，疾恶如仇。他以登峰造极的精技纯功，镇邪恶，御外侮，以武扬威，誉满海内外。更因其枪法、拳术天下无双而得“刚拳无二打、神枪李书文”之美誉。"]],
            "moon_7":["male","saber",3,["moon_7_6","moon_7_5","moon_7_4","moon_7_1"],["boss","bossallowed","des:在德国叙事诗《尼伯龙根之歌》里被描写成主角的英雄——尼德兰的王子，同时也是性格高洁的骑士。比起自己，更愿意为他人带去希望和幸福。携带着从尼伯龙根族那里得到的圣剑巴尔蒙克，在各种远征和冒险里建立战功。在他的功绩里最著名的是将恶龙法夫纳(Fafnir）打退——那时他因沐浴于龙血之中，而得到了近乎不死的肉体。 《Fate/Apocrypha》中以Saber的职阶现世。在圣杯战争的初战中便展现出了强大的战斗力，却被胆小无能的御主施加了束缚。之后为了拯救一位即使全身无法动弹也拥有“活下去”意志的人造人而将自己的心脏献出，以此成功拯救了人造人的性命并就此退出圣杯战争。获得新生的人造人给自己取名为齐格（Sieg），以纪念拯救自己的英雄。"]],
            "moon_8":["male","lancer",4,["moon_8_5","moon_8_4","moon_8_3","moon_8_1"],["des:迪卢木多·奥迪那，《FATE》系列中的角色。第四次圣杯战争中职阶为“枪之骑士”的从者。其真实身份是凯尔特神话中，被誉为“举世无双”的爱尔兰费奥纳骑士团首席勇士——“光辉之貌”迪卢木多·奥迪那。 追求最高的敏捷性和优秀的格斗战能力的英灵[1]，无论体格、性格、样貌和武艺，各个方面都无懈可击。以极高的敏捷度著称，拥有相当强的格斗战能力，虽说“枪兵”属于中远距离兵种，但毫无畏惧地与敌人正面大战一场才是他所喜欢的战斗方式。 第四次圣杯战争中，现世的迪卢木多并没有携带他传说中的看家武器魔剑Moralltach与魔剑Beagalltach。相比其枪，有关他剑法的传说更加有名望[2]。"]],
            "moon_9":["male","archer",5,["ubw","ubw2","moon_9_1","moon_9_2","moon_9_3"],["des:英灵卫宫[Emiya]，TYPE-MOON的游戏作品及相关动画《Fate》系列中的人物。第五次圣杯战争时由远坂凛召唤出的Servant，职阶是Archer。作为英灵的基本能力偏低，主要靠Servant中出现的众多投影产物和自身的战斗经验来弥补差距。精于近身格斗战及弓兵技术，亦擅长对魔术战和家务，本体为未来的卫宫士郎成为守护者后的姿态。可以说是影子主角般的重要角色，《Fate/stay night》有一半可以说是这个男人的故事。[1]他的真身是“卫宫[Emiya]”。即是在未来为了拯救一百名人类而祈求奇迹，作为代价而英灵化的卫宫士郎。虽是无名的英灵，却把士郎所持的固有结界“无限剑制(Unlimited Blade Works)”锻炼、操纵至极限，跟在场的英灵们势均力敌。[2]作为英灵的他处于“守护者”的立场，拥有以虐杀人类来回避灭亡的职责。屈服于不断重覆的杀人以及人类所展示出的丑陋，对杀死士郎以消灭自身产生了希望。可是他无论在哪条路线，结果都选择为了守护他人而战。他的天性，似乎死了也没有治好。[2]"]],
            "moon_3":["female","saber",5,["moon_2_2","moon_3_1","moon_3_3"],["zhu","boss","bossallowed","des:由于和根源之涡相连，因此几乎可以做到任何事（境界式）。但平时几乎都在沉睡般的状态，并不干预式的行动，式和织也都不知其存在。在小说末尾“空之境界”出现，并与干也进行了对话。值得一提的是，“根源式”只是读者为了区别于“两仪式”而取的名称，原作中并没有这种说法。"]],
            "moon_10":["male","assassin",5,["moon_10_1","moon_10_2","moon_10_3"],["forbidai","des:卫宫切嗣，虚渊玄著作的小说及其改编的同名动漫《Fate/Zero》的人物，独占了Zero的序幕和终章，大体上算是主角。[1]而由原作奈须蘑菇 / TYPE-MOON的《fate/stay night》Studio DEEN制作的电视动画以回忆的内容登场。第四次圣杯战争中Saber的Master（御主），卫宫士郎的养父，被称为“魔术师杀手”的男人。虽然是希望世界和平的梦想家，但实践时却是冷酷无情的现实主义者。有着极为沉痛的过去和悲伤的回忆。"]],
            "moon_11":["male","lancer",5,["degula2","moon_11_2","moon_11_1"],["boss","bossallowed","des:瓦拉几亚公国的穿刺公。对祖国的爱和作为执政者的责任感成为了强逼观念，就算阻挠他的人是亲属也将当成害虫来驱除。虽然他如此危险，但其本质上是无微不至人格高尚的人。可是他在“不懂得留情”这一点上越出了人道，所以才容易被误解。看了以自己做模型的德古拉传说书籍和影片后，曾经尽力以成熟的态度视若无睹，但无意中就“不小心”地将它们破坏了。[2] 成为吸血鬼德古拉模型的实际存在的人物(1431年－1476)。拥有如洁癖般的正义感和残忍性，一生中处刑过自己五分之一的国民。他的祖国瓦拉几亚是被夹在大国土耳其和匈牙利中间的小国。他在这国家里度过父亲被暗杀、兄长被活埋、和弟弟战斗的悲惨人生。 和土耳其打仗时，以豁命死拼的游击战和焦土作战，将土耳其兵化作穿刺之山，打退了敌人好几次。可是由于政治上的事情而被匈牙利逮住，度过十二年的软禁生活。其后，在1476年从东正教会改宗到天主教，重新回到瓦拉几亚公的位子，却于同年在弟弟劳顿和土耳其的战争上战死，享年45岁。[2]"]],
            "moon_12":["female","assassin",5,["moon_12_5","moon_12_4","moon_12_3","moon_12_2","moon_12_1"],["des:作为Assassin被召唤出来的杰克。 世界知名的连环杀手。在日本最为人知的称呼是“开膛手杰克”。 杀害了5名女性（均为娼妇），在苏格兰场的全力追捕下也未能逮捕归案， 就像人间蒸发一般销声匿迹。 被杀害的女性也均无反抗痕迹，所以也曾被认为是男性，但是并无其他根据。 另外最初也被称呼为女性化名字的“开膛手吉尔”。 因为开膛手杰克的真身并不明了，所以会随着被召唤时的职阶改变样貌。 这一次是作为Assassin被召唤，其样貌乃是连出生都不被允许的孩子们的集合体。 Assassin的杰克因为在出生之前就被杀死，所以将回归腹中——将回到母亲的胎内作为对圣杯的愿望。 虽然不知世事，但也许是因为作为开膛手杰克被召唤的缘故，头脑非常地灵活。 作为Assassin被召唤的她，虽然自称是“开膛手杰克”，但对于是否是案件的“真凶”这一点她自己也不清楚。 她的确有着杀死过数名女性的记忆，但并不确定她们是否是杰克的牺牲者。 从未感受过母爱的她强烈地追求者爱。 无论Master是男性还是女性，她都会要求对方给予作为“母亲”的爱情吧。 想要以母爱回应她的期望也并无不妥，只不过、她说不定有着钻到你肚子里去的想法呢。[3]"]],
            "moon_13":["male","saber",5,["moon_13_3","moon_13_2","moon_13_1"],["des:亚瑟·潘德拉贡（Arthur Pendragon），又译阿瑟·潘德拉贡，史称亚瑟王（King Arthur），是传说中的古不列颠最富有传奇色彩的伟大国王。人们对他感性认识更多的是来自凯尔特神话传说和中世纪的野史文献，没有人大量涉足过亚瑟王的真实生活。传说他是圆桌骑士的首领，一位近乎神话般的传奇人物，被称为“永恒之王”（the Once and Future King）。"]],
            "moon_14":["male","caster",5,["moon_14_1","moon_14_2","moon_14_3","moon_14_4"],["des:传说中的医生、炼金术士。 作为十六世纪文艺复兴时期的人物而广为所知。 自「四大元素（五大元素）的再发现」、「三原质的再发现」伊始，他留下了为数众多的功绩和书籍。 是罕见地在人类史和魔术史上都声名卓著的人物。 操使五大元素的强力魔术师（Average One） 理智而稳重。生性温和，不喜战斗。 常称人的情爱是至为尊贵之物。 对于现代的魔术师，他悉数当作是继承自己衣钵的弟子之裔，同等地加以疼爱。 ——只要，世界还允许他如此（爱）。 曾向圣杯寄托的愿望是「到达根源」。 更进一步而言，是将「星之光（像是圣剑之类的）即是贯穿根源的光芒」这一理论加以验证——虽说，是如此的。 事到如今，他所寻求的说不定是赎罪吧。[1][2] 生前知己有达·芬奇和玛奇里·佐尔根（间桐脏砚），达·芬奇生前是不是女的他也忘了。"]],
            "moon_15":["male","archer",5,["moon_15_1","moon_15_2","moon_7_5","moon_15_3","moon_15_5","moon_15_6","moon_15_7","moon_15_8"],["boss","bossallowed","des:吉尔伽美什，在“圣杯战争”中大多数以Archer的职阶被召唤到现世，亦可不需要局限在职阶之上，以自身的名字作为职阶现世（Gilgamesh）。其真实身份为古代美索不达米亚地区苏美尔王朝的都市国家乌鲁克的第五任国王，人类最古老的史诗《吉尔伽美什史诗》的主人公，最古老的“英雄王”。他有着“三分之二为神，三分之一为人”的神性，性格高傲，曾是自认为无人能敌的暴君。[1]拥有所有英雄持有的宝具原型。"]],
            "moon_16":["male","lancer",5,["moon_16_1","moon_16_2","moon_16_3","moon_16_5","moon_16_6"],["boss","bossallowed","des:古印度伟大的长篇叙事诗《摩诃婆罗多》中太阳神苏利耶（Surya）与凡人女性贡蒂（Kunti）所生的不死英雄。他作为苏利耶之子的证明是被赐予带来不死的黄金之铠、耳环，然而由于贡蒂年少未婚，也只是为了测试咒语是否灵验才有了迦尔纳，故而不得不舍弃了迦尔纳。贡蒂之后成为俱卢（Kuru）般度王的皇后。[2]  然后，不知母亲是谁并以卑贱身份成长的迦尔纳，不久崭露头角，作为敌视俱卢王的持国后裔（Kaurava）王家之宾客，参与围绕着领地的战争。与迦尔纳势均力敌以矛交锋的，是贡蒂和雷神因陀罗的儿子阿周那。迦尔纳在战斗的最后被因陀罗骗去黄金之铠，受到各种诅咒，失去所有同伴，被同母异父的兄弟阿周那杀死。即使如此，他也没有怨恨任何人，接受了灭亡。[2]  性格冷酷残忍，毫不客气。虽然跟他谈话也会认为他缺乏自我主张而且没趣，其实他心里深思熟虑，有着重情重义的心。冷酷的形象是由于他认为大部分的事物都是“正常的”，而不去干预的缘故。因为这个性质，他不太拥有憎恨妒忌这些负面感情。由于他的言行是针对对方“不想被提起的本质”而作出，所以遭到大多数人讨厌。[2]  "]],
            "moon_17":["male","assassin",5,["moon_17_1","moon_17_2","moon_17_3","moon_17_4","moon_17_5"],["boss","bossallowed","des:面着骷髅假面的暗杀者。    创立了暗杀教团阿萨辛（Assassin）后、『山之翁』这个称号代替其本名、诞生出最初的一名哈桑·萨巴赫。  然而教团的信徒们、甚至连其他18名哈桑也不知道该人物的真身、无从找寻他实际存在过的证据。  当代哈桑·萨巴赫误入歧途时才会出现、并将其斩首的传说中的暗杀者。 即为、杀害哈桑的哈桑。[1]  在暗杀教团中唯一一个没有发现目击者的人、这也是当然的、因为在看见这个人物的瞬间就是生命终结之时。  作为『山之翁』而活的人生、他同时选择了作为对教团的腐败挥下制裁之剑的监视者。  作为受神之教导的正确教团、其行为若对人类而言是恶便无法赦免。  因此、这个人物绝不容许教团的腐败。  守护神之教诲的人们沉溺于人类的欲望。  这正是、对神最大的冒渎。[1]  教团的腐败、即为其首领的『山之翁』的堕落。  无论是精神上的堕落还是技术上的堕落、只要是衰退着就无法授予『山之翁』的名号。  衰退即为死。为了饶恕其罪行而斩断其首、并将希望托付给下一任『山之翁』。  为了给予暗杀暗杀者这项充满破绽的任务打一名分、该人物没有选择隐藏式武器或暗器、而选择了大剑作为武器正面战斗。  当这张骷髅映入眼帘的瞬间、就是这个人的终结。  对与教团的教义有差错的愚蠢之人降下制裁的铁锤后、见到骷髅剑士的人也一同从世上消失了。  埋葬了无数的暗杀者（Assassin）的他在暗杀教团毁灭前都会潜伏在黑暗之中。  作为活生生的传说、没有任何目击者的暗杀者之深渊。  正是这名骷髅的剑士。[1]  "]],
            "moon_18":["male","archer",5,["moon_18_1","moon_18_2","moon_18_3","moon_18_4","moon_18_5"],["boss","bossallowed","des:印度古史诗《摩诃婆罗多》中的大英雄。虽然《摩诃婆罗多》是群集了印度众多英雄的灿烂故事，但即便称阿周那是其核心，也绝称不上言过其实。 其爱弓为甘狄拔（Gāṇḍīva），是火神阿耆尼所授之物。 对自己的另外一个人格，阿周那称之为“黑”。憎恨、嘲笑、奸诈的邪恶。阿周那无法接受这一事实，而化作了他身旁的从者行动。 虽然不太相干，但毗湿奴的转生、其第八化身奎师那乃是和阿周那的人格有别的一位英雄。[3]"]],
            "moon_19":["female","assassin",5,["moon_19_1","moon_19_2","moon_19_10"],["des:无名。因为未取得“哈桑”之名，所以也没有戴骷髅面具。 通过模仿而学习到了前18个哈桑的所有技能，但因为没有自己独创的技能而在竞争中输给了“百貌”。真相是教团对她能将别人修炼一生的技能在短短几年内全部学会而心生恐惧和嫉妒。 否认除了自己教派以外的神秘，获得了圣杯知识之后说出了“我们的神不需要什么杯子”的话，一经召唤就杀死了自己的Master。目的是单枪匹马杀死所有举行异教徒仪式的魔术师。[1]"]],
            "moon_20":["female","rider",5,["moon_20_1","moon_20_2","moon_20_3","moon_20_4"],["des:记载于哈布斯堡家族系谱中的法兰西王妃。十六世纪，路易十六的王妃，梦幻般的贵妇人。是象征着欧洲世界的「贵族阶级统治」的存在。在那至上王权渐渐衰弱的时代奔流中，在这世界发生改变之前便失去了性命。 天生的偶像（Idol）。以微笑治愈众生，以眼眸沁人心醉。因自己作为被宠爱而降生的偶像而喜悦，决定就如被期望的那样做出自己的举止。这样的精神性已经可以说是更接近女神了。虽然在革命期成为了众多人的憎恨对象，但是在现代的法兰西已经进行了名誉恢复。在饥荒时削减宫廷费用作为捐款，亲自向贵族们请求援助受灾的人民等等，被确认为是一个为民着想的女性。[1]有着一身谁都能看得出来的高贵气质，交际能力拔群。因为是从全盛期被召唤出来的，所以对爱恋有着非常深的兴趣。并且，有着一高兴起来就会和人接吻的习惯，曾经还在宫中引发过混乱。最喜欢说的口头禅就是「Vive la France！」。除此之外，因为非常单纯，在恶搞剧情中经常在无意中说出痛击人心灵的实话。 在游戏中拥有非常强的生存能力，一破就能发挥非常不错的实力，缺陷是宝具攻击力非常遗憾而且回血量也明显不足。由于职阶克制加上优秀的生存能力，能够单挑所有魔神柱。"]],
            "moon_21":["male","archer",5,["moon_21_1","moon_21_2","moon_21_3","moon_21_4"],["des:十九至二十世纪的天才科学家，驾驭了电磁。 　　公然宣称连星斗都能一举割裂，无可辩驳的天才。 几多的神话中，屡被述及为神（自然）之传说的雷电之力，正是由这位伟大的硕学解明，而后才为人类文明带来了「电力」。马克·吐温称其为雷电博士。 　　无人能比的天才。现代的普罗米修斯。 　　绝世的美男子。发明王爱迪生的劲敌。 　　将宙斯的雷霆显现于大地之人。 　　其人正是豪壮而华丽的睿智魔人。 　　对Master的态度则是高傲的只言片语。 　　◆ 　　寄托圣杯的愿望是「完成尼古拉·特斯拉系统」。 　　亦即是交流电能和空间本身彼此往来的时代能够到来一事。 　　为能成就于此，尼古拉·特斯拉无疑会倾尽全力协助修复人类史吧。[1]"]],
            "moon_22":["female","",Infinity,["moon_22_1","moon_22_2","moon_22_3"],["boss","bossallowed","des:真祖的公主，月姬的女主角之一  有着红眼、金发和伤痛的过去，个性天真、傻气带点任性。一开始即被志贵以直死魔眼分尸十七块，可第二天却又奇迹出现。  给人莫名的开朗、又有点天然呆的感觉。  另外，也是对志贵的感情最直接的一位。  与一般吸血鬼的印象不同，可在日光下行走，流动的水、大蒜、圣水、十字架等驱魔圣物一概无效，但也保留远胜人类的体能、恢复力、吸血冲动等特征。只是爱尔奎特并不吸血，和一般人吃同样的食物。  拥有超高的战斗能力，即使是其他吸血鬼也难以抗衡，其中以空想具现化（把幻想中的物件变为真实）为最大武器。  十二世纪的时候为了狩猎“堕落的真祖”而生出的特别的真祖，出身方式跟其他自然产生的真祖有些不同，详细情形不明。  有着比其他“不需要压制吸血冲动的真祖”还要强大的战斗能力，也就是说，不用全力就能应付使用全力的其他真祖，在真祖中能力是相当突出的。  另外，身为兵器没有被附加上多馀的机能，直到被志贵杀死后才开始说话，有“身为兵器只要会战斗就好”这种想法，推测是“能说话，认为没必要跟他人交谈”的意思。  第一次因吸血冲动所苦的时候，被罗亚欺骗而吸了他的血，结果是能力失控暴走，把“千年城布伦史塔德”内的其他真祖全杀了。  在此之后将自身封印，平常是沉睡在千年城，只在罗亚出现的时候，处决他而醒来。这次则是因被主角杀死一次而实力弱化，转而要求主角协助。"]],
            "moon_23":["male","berserker",5,["moon_23_1","moon_23_2","moon_23_3","moon_23_4"],["boss","bossallowed","des:凯尔特神话阿尔斯特传说的勇士。 赤枝骑士团的一员也是阿尔斯特最强的战士，使用异界影之国的盟主斯卡哈赐予的无敌的魔枪。 作为和通常不同的Berserker职阶现界。 由于某种原因而全身的装备有了变化 性格也反转，表情冷酷，宝具魔枪也混杂着红色与黑色，充满不祥气息。"]],
            "moon_24":["female","rider",3,["moon_24_1","moon_24_a","moon_24_b"],["boss","bossallowed","des:被称作“千古一帝”的君王，人类文明史上最著名的皇帝之一。 现世所有的皇帝法统只来自两个源头——出现于现世极西之地的罗马帝国，与出现于现世极东之地的秦帝国。此后历经两千多年，再 无第三种法统出现在地球之上，一切帝国都只是秦与罗马的复制与延续。 十二金人，兵马俑，万里长城，统一度量衡，大秦歼星弩……有关这位少女皇帝的传说无数，但她最为知名的传奇身份仍是“永生追求者”。她曾寻求蓬莱仙境、炼制不死仙药，而公元2056年的魔都之战，似乎也与秦始皇两千多年前的探究有关……"]],
        },
        translate:{
            "moon_1":"刘秀",
            "moon_2":"两仪式",
            "moon_4":"天草四郎时贞",
            "moon_5":"阿斯托尔福",
            "moon_6":"李书文",
            "moon_7":"齐格飞",
            "moon_8":"迪卢木多",
            "moon_9":"卫宫士郎",
            "moon_3":"根源式",
            "moon_10":"卫宫切嗣",
            "moon_11":"弗拉德三世",
            "moon_12":"杰克",
            "moon_13":"亚瑟",
            "moon_14":"霍恩海姆",
            saber:"剑",
            saberColor:"#3232CD",
            lancer:"枪",
            lancerColor:"#236B8E",
            archer:"弓",
            archerColor:"#545454",
            rider:"骑",
            riderColor:"#9932CD",
            caster:"法",
            casterColor:"#6B238E",
            assassin:"杀",
            assassinColor:"#2F2F4F",
            berserker:"狂",
            berserkerColor:"#990000",
            avenger:"仇",
            avengerColor:"#CC3300",
            ruler:"裁",
            rulerColor:"#000000",
            monster:"怪",
            monsterColor:"#4F2F4F",
            "moon_15":"吉尔伽美什",
            "moon_16":"迦尔纳",
            "moon_17":"山の翁",
            "moon_18":"阿周那",
            "moon_19":"狂信徒•无名",
            "moon_20":"玛丽•安托瓦内特",
            "moon_21":"特斯拉",
            "moon_22":"爱尔奎特",
            "moon_23":"库•丘林",
            "moon_24":"嬴政",
        },
    },
    card:{
        card:{
            "moon_xuming":{
                type:"equip",
                subtype:"equip5",
                skills:["moon_xuming"],
                ai:{
                    basic:{
                        equipValue:function (card,player){
                if(player.hp<=2) return 8;
                return 6;
            },
                        order:function (card,player){
                return 8+ai.get.equipValue(card,player)/20;
            },
                        useful:2,
                        value:function (card,player){
                var value=0;
                var info=get.info(card);
                if(player.get('e',info.subtype[5])&&card!=player.get('e',info.subtype[5])){
                    value=ai.get.value(player.get('e',info.subtype[5]),player);
                }
                var equipValue=info.ai.equipValue||info.ai.basic.equipValue;
                if(typeof equipValue=='function') return equipValue(card,player)-value;
                return equipValue-value;
            },
                    },
                    result:{
                        target:function (player,target){
                return ai.get.equipResult(player,target,name);
            },
                    },
                },
                enable:true,
                selectTarget:-1,
                filterTarget:function (card,player,target){
        return target==player;
    },
                modTarget:true,
                content:function (){
        target.equip(card);
    },
                fullimage:true,
            },
        },
        translate:{
            "moon_xuming":"黑框眼镜",
            "moon_xuming_info":"结束阶段，若你的体力值是全场最小的之一，你可以回复一点体力",
        },
        list:[["heart","1","moon_xuming"]],
    },
    skill:{
        skill:{
            ubw:{
                unique:true,
                trigger:{
                    player:"changeHp",
                },
                forced:true,
                init:function (player){
        player.storage.ubw=0;
    },
                filter:function (event,player){
        return player.storage.ubw<=5;
    },
                content:function (){
       
        player.storage.ubw+=Math.abs(trigger.num);
        if(player.storage.ubw){
            player.markSkill('ubw');
        }
        game.addVideo('storage',player,['ubw',player.storage.ubw]);
    },
                intro:{
                    content:"mark",
                },
                ai:{
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(player.hasSkill('jueqing')) return [1,-1.5];
                    if(player.hp>=4) return [1,1.5];
                    if(target.hp==3) return [1,1];
                    if(target.hp==2) return [1,0.5];
                }
            },
                    },
                },
            },
            "ubw2":{
                animationColor:"fire",
                skillAnimation:"legend",
                enable:"phaseUse",
                filter:function (event,player){
      return player.storage.ubw>5;
    },
                content:function (){
"step 0"
player.storage.ubw=0;
player.unmarkSkill('ubw');
"step 1"
player.addTempSkill('ubw3','phaseAfter');
var cards=[];
    for(var i=0;i<6;i++){
        cards.push(game.createCard('sha'));
    }
        player.gain(cards,'gain2');
     },
            },
            "ubw3":{
                mod:{
                    cardUsable:function (card){
            if(get.info(card)&&get.info(card).forceUsable) return;
            return Infinity;
        },
                },
            },
            degula:{
                trigger:{
                    source:"damageAfter",
                },
                forced:true,
                content:function (){
        player.recover(trigger.num);
   },
            },
            "degula2":{
                skillAnimation:true,
                trigger:{
                    player:"dying",
                },
                filter:function (event,player){
return !player.storage.degula2;
    },
                forced:true,
                priority:100,
                content:function (){
"step 0"
player.storage.degula2=true;
"step 1"
player.recover( 
player.maxHp-player.hp);
        player.addSkill('degula3')
player.addSkill('degula');
        player.addSkill('degula4');
        player.addTempSkill('qianxing',{player:'phaseBegin'});

    },
            },
            "degula3":{
                trigger:{
                    player:"dying",
                },
                priority:7,
                unique:true,
                forced:true,
                filter:function (event,player){
        return player.hp<=0;
    },
                content:function (){
        'step 0'
        player.judge(function(card){
            return get.suit(card)=='spade'?-1:1;
        });
        'step 1'
        if(result.bool){
            player.recover(2-player.hp);
            player.gainMaxHp();
        }
    },
                ai:{
                    threaten:0.8,
                },
            },
            "degula4":{
                enable:"chooseToUse",
                filterCard:function (card){
        return get.color(card);
    },
                viewAsFilter:function (player){
        return player.num('h')>0;
    },
                viewAs:{
                    name:"sha",
                },
                prompt:"将一张手牌当杀使用",
                check:function (card){return 8-ai.get.value(card)},
                threaten:1.2,
                ai:{
                    playernowuxie:true,
                    basic:{
                        useful:[6,4],
                        value:[6,4],
                    },
                    result:{
                        player:1,
                        target:function (player,target){
                        if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                            if(ai.get.attitude(player,target)>0){
                                return -6;
                            }
                            else{
                                return -3;
                            }
                        }
                        return -1.5;
                    },
                    },
                    expose:0.2,
                    order:3,
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                        if(card.nature=='poison') return;
                        return 1;
                    },
                        natureDamage:function (card){
                        if(card.nature) return 1;
                    },
                        fireDamage:function (card,nature){
                        if(card.nature=='fire') return 1;
                    },
                        thunderDamage:function (card,nature){
                        if(card.nature=='thunder') return 1;
                    },
                        poisonDamage:function (card,nature){
                        if(card.nature=='poison') return 1;
                    },
                    },
                },
            },
            "moon_1_1":{
                inherit:"bagua_skill",
                filter:function (event,player){
        if(!event.filterCard({name:'shan'})) return false;
        if(event.getParent().player.num('s','unequip')) return false;
      
  if(player.get('e','2')) return true;
        return true;
    },
                ai:{
                    effect:{
                        target:function (card,player,target){
                if(player==target&&get.subtype(card)=='equip2'){
                    if(ai.get.equipValue(card)<=8) return 0;
                }
                if(target.get('e','2')) return;
                if(player.hasSkill('unequip')) return;
                if(get.tag(card,'respondShan')) return [0.5,0];
            },
                    },
                },
                trigger:{
                    player:"chooseToRespondBegin",
                },
                audio:"ext:fate eod:true",
                check:function (event,player){
        if(ai.get.damageEffect(player,event.player,player)>=0) return false;
        return true;
    },
                content:function (){
        "step 0"
        player.draw(2);
        player.recover();
        player.judge('bagua',function(card){return (get.color(card)=='red')?1.5:-0.5});
        "step 1"
        if(result.judge>0){
            trigger.untrigger();
            trigger.responded=true;
            trigger.result={bool:true,card:{name:'shan'}}
        }
    },
            },
            "moon_1_2":{
                trigger:{
                    player:["damageAfter","loseHpAfter","loseMaxHpAfter"],
                },
                forced:true,
                unique:true,
                content:function (){
        "step 0"
        event.players=get.players(player);
        event.players.remove(player);
        player.draw(trigger.num+trigger.num);
        "step 1"
        if(event.players.length){
            event.players.shift().loseHp(trigger.num+trigger.num);
            event.redo();
        }
    },
            },
            "moon_1_3":{
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'&&player!=target){
                return false;
            }
        },
                    targetInRange:function (){
            return true;
        },
                },
                trigger:{
                    player:"damageBefore",
                },
                filter:function (event){
        if(event.nature) return true;
    },
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
player.recover(player.maxHp-player.hp);
    },
                ai:{
                    effect:{
                        target:function (card){
                if(get.tag(card,'natureDamage')){
                    return [0,2];
                }
            },
                    },
                },
            },
            "moon_1_4":{
                trigger:{
                    source:"damageAfter",
                },
                unique:true,
                forced:true,
                filter:function (event,player){
        return event.nature!='fire';
    },
                content:function (){
        "step 0"
        event.players=get.players(player);
        player.recover();
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            if(current.isEnemyOf(player)){
                player.line(current,'fire');
                current.damage(1,'fire');
            }
            event.redo();
        }
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].canUse('sha',player)&&game.players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            "moon_2_1":{
                skillAnimation:true,
                trigger:{
                    player:"dying",
                },
                filter:function (event,player){
return !player.storage.moon_2_1;
    },
                forced:true,
                unique:true,
                priority:100,
                content:function (){
"step 0"
player.storage.moon_2_1=true;
player.maxHp==5;
        player.changeHujia(5);
"step 1"
player.recover( 
player.maxHp-player.hp);
        player.addTempSkill('qianxing',{player:'phaseBegin'});
player.addSkill('moon_2_3');
player.addSkill('moon_2_2');
    },
            },
            "moon_2_2":{
                trigger:{
                    source:"damageBefore",
                },
                forced:true,
                filter:function (event,player){
        return event.player!=player;
    },
                content:function (){
trigger.untrigger();
        trigger.finish();

trigger.player.loseMaxHp(true);
   },
            },
            "moon_2_3":{
                enable:"phaseUse",
                filterTarget:function (card,player,target){
        if(player==target) return false;
        return get.distance(player,target,'attack')<=1;
    },
                content:function (){
        'step 0'
        target.loseMaxHp(target.maxHp);
        'step 1'
player.removeSkill('moon_2_3');
    },
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
  
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_3_1":{
                trigger:{
                    player:"phaseBegin",
                },
                frequent:true,
                content:function (){
player.judge(function(card){
if(get.suit(card)=='spade') 
{
player.addSkill('moon_3_2');
}
if(get.suit(card)=='club'){
player.addSkill('moon_2_3');
}
if(get.suit(card)=='heart'){
player.recover(player.maxHp-player.hp);
}
if(get.suit(card)=='diamond'){
player.draw(4);
}
});
},
                group:"moon_3_1_phase",
                subSkill:{
                    phase:{
                        trigger:{
                            global:"phaseBefore",
                        },
                        forced:true,
                        filter:function (event,player){
                return event.player!=player;
            },
                        content:function (){
                player.phase();
            },
                    },
                },
                mod:{
                    cardUsable:function (card){
            if(get.info(card)&&get.info(card).forceUsable) return;
            return Infinity;
        },
                    globalFrom:function (from,to){
return -Infinity;
        },
                },
            },
            "moon_3_2":{
                skillAnimation:"legend",
                enable:"phaseUse",
                filterTarget:function (card,player,target){
        return player!=target;
    },
                content:function (){
target.die();
player.removeSkill('moon_3_2');
},
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
         
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_3_3":{
                trigger:{
                    global:"dieAfter",
                },
                filter:function (event,player){
        return player.hp<player.maxHp;
    },
                forced:true,
                content:function (){
        player.recover(player.maxHp-player.hp);
    },
                ai:{
                    threaten:1.2,
                },
            },
            "moon_4_1":{
                skillAnimation:"legend",
                enable:"phaseUse",
                unique:true,
                filter:function (event,player){
return !player.storage.moon_4_1;
},
                content:function (){
        "step 0"
player.storage.moon_4_1=true;
        var players=get.players(player);
        players.remove(player);
        event.players=players;
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            var hs=current.get('h');
            if(hs.length){
                current.lose(hs)._triggered=null;
                current.$throw(hs);
            }
            else{
                current.loseHp();
            }
            game.delay(0.5);
            event.redo();
        }
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].canUse('sha',player)&&game.players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            "moon_4_2":{
                enable:"phaseUse",
                usable:1,
                forced:true,
                filter:function (event,player){
 if(player.isLinked()) return true;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i]!=player&&!game.players[i].isLinked()){
                return true;
            }
        }
        return false;
    },
                content:function (){
        "step 0"
       event.targets=game.players.slice(0);
        event.targets.remove(player);
        event.targets.sort(lib.sort.seat);
        if(player.isLinked()) player.link();
        "step 1"
        if(event.targets.length){
            var target=event.targets.shift();
            if(!target.isLinked()){
                target.link();
            }
            event.redo();
        }
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].canUse('sha',player)&&game.players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            "moon_4_3":{
                unique:true,
                trigger:{
                    player:["phaseDrawBefore","phaseEnd"],
                },
                frequent:true,
                content:function (){
        player.draw(2);
    },
            },
            "moon_4_4":{
                trigger:{
                    player:"dying",
                },
                priority:100,
                unique:true,
                forced:true,
                filter:function (event,player){
        return player.hp<=0;
    },
                content:function (){
"step 0"
            player.recover(player.maxHp-player.hp);
    player.draw(5);
        player.addTempSkill('qianxing',{player:'phaseBegin'});
"step 1"
player.removeSkill('moon_4_4');
    },
                ai:{
                    threaten:0.8,
                },
            },
            "moon_5_1":{
                enable:"phaseUse",
                usable:1,
                changeSeat:true,
                filterTarget:function (card,player,target){
        return player!=target&&player.next!=target&&player.canUse('sha',target,false);
    },
                filter:function (event,player){
        var min=Math.max(1,player.maxHp-player.hp);
        return lib.filter.filterCard({name:'sha'},player);
    },
                content:function (){
        game.swapSeat(player,target,true,true);
        player.useCard({name:'sha'},target,false);
    },
                ai:{
                    result:{
                        target:function (player,target){
                return ai.get.effect(target,{name:'sha'},player,target);
            },
                    },
                    order:4,
                },
            },
            "moon_5_2":{
                trigger:{
                    player:"damageEnd",
                },
                forced:true,
                priority:10,
                filter:function (event,player){
        return event.source&&event.source.isAlive()&&event.source!=player;
    },
                intro:{
                    content:"players",
                },
                content:function (){
        trigger.source.goMad('phaseAfter');
        if(!player.storage.kuangluan){
            player.storage.kuangluan=[];
        }
        player.storage.kuangluan.add(trigger.source);
        player.markSkill('kuangluan');
    },
                ai:{
                    threaten:0.3,
                },
                group:["kuangluan2","kuangluan3"],
            },
            "moon_5_3":{
                mod:{
                    cardUsable:function (card,player,num){
            if(card.name=='sha') return Infinity;
        },
                    cardEnabled:function (card,player){
            if(get.type(card,'trick')=='trick') return false;
        },
                    cardRespondable:function (card,player){
            if(get.type(card,'trick')=='trick') return false;
        },
                    cardSavable:function (card,player){
            if(get.type(card,'trick')=='trick') return false;
        },
                },
                enable:["chooseToUse","chooseToRespond"],
                filterCard:function (card){
        return get.type(card,'trick')=='trick';
    },
                selectCard:1,
                viewAs:{
                    name:"sha",
                },
                check:function (){return 1},
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'respondSha')&&current<0) return 0.6
            },
                    },
                    respondSha:true,
                    order:4,
                    useful:-1,
                    value:-1,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    result:{
                        target:function (player,target){
                if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                    if(ai.get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3;
                    }
                }
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                        natureDamage:function (card){
                if(card.nature) return 1;
            },
                        fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                        thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                        poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                    },
                },
            },
            "moon_5_4":{
                enable:"chooseToUse",
                filterCard:function (card){
        return get.color(card);
    },
                viewAsFilter:function (player){
        return player.num('h')>0;
    },
                viewAs:{
                    name:"wuxie",
                    suit:"spade",
                    number:13,
                },
                prompt:"将一张手牌当无懈可击使用",
                check:function (card){return 8-ai.get.value(card)},
                threaten:1.2,
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'&&player!=target){
                return false;
            }
        },
                },
                ai:{
                    playernowuxie:true,
                    basic:{
                        useful:[6,4],
                        value:[6,4],
                    },
                    result:{
                        player:1,
                    },
                    expose:0.2,
                },
            },
            "moon_5_5":{
                trigger:{
                    player:"phaseBegin",
                },
                frequent:true,
                content:function (){
player.judge(function(card){
if(get.color(card)=='red') 
{
player.addSkill('moon_5_4');
player.removeSkill('moon_5_3');
}
else
{
player.addSkill('moon_5_3');
player.removeSkill('moon_5_4');
}
});
},
            },
            "moon_5_6":{
                trigger:{
                    global:"loseEnd",
                },
                check:function (event,player){
        return ai.get.damageEffect(event.player,player,player)>0;
    },
                filter:function (event,player){
        if(event.player.num('h')) return false;
        if(_status.currentPhase!=player) return false;
        if(event.player==player) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){
        player.line(trigger.player,'green');
        trigger.player.damage();
    },
                ai:{
                    threaten:1.1,
                },
            },
            "moon_6_1":{
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)&&player!=target){
                return false;
            }
        },
                },
                trigger:{
                    player:"phaseDiscardBefore",
                },
                priority:15,
                unique:true,
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
            },
            "moon_6_2":{
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                check:function (event,player){
        return ai.get.attitude(player,event.target)<=0;
    },
                content:function (){
        trigger.directHit=true;
player.removeSkill('moon_6_1');

    },
            },
            "moon_6_3":{
                enable:"phaseUse",
                filterTarget:function (card,player,target){
        if(player==target) return false;
       if(player.hp!=1) return false;
        return get.distance(player,target,'attack')<=1;
    },
                content:function (){
target.damage(target.hp-1);

    },
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
         
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_7_1":{
                trigger:{
                    player:"phaseBegin",
                },
                frequent:true,
                forced:true,
                content:function (){
player.judge(function(card){
if(get.color(card)=='red') 
{
player.addSkill('moon_7_2');
player.removeSkill('moon_7_3');
    player.recover();
}
else
{
player.addSkill('moon_7_3');
player.removeSkill('moon_7_2');
}
});
},
            },
            "moon_7_2":{
                trigger:{
                    player:["damageBefore","loseHpBefore","loseMaxHpBefore"],
                },
                priority:10,
                unique:true,
                forced:true,
                content:function (){
trigger.untrigger();
        trigger.finish();
    },
            },
            "moon_7_3":{
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                check:function (){
        return false;
    },
                content:function (){
        player.loseHp();
    },
            },
            "moon_7_4":{
                skillAnimation:true,
                trigger:{
                    player:"dying",
                },
                forced:true,
                unique:true,
                priority:100,
                content:function (){
        "step 0"

player.recover( 
player.maxHp-player.hp);
player.loseMaxHp();
        "step 1"
        player.update();
        ui.clear();
        while(_status.event.name!='phaseLoop'){
            _status.event=_status.event.parent;
        }
        for(var i=0;i<game.players.length;i++){
            for(var j in game.players[i].tempSkills){
                game.players[i].skills.remove(j);
                delete game.players[i].tempSkills[j];
            }
        }
        _status.paused=false;
        _status.event.player=player;
        _status.event.step=0;
        if(game.bossinfo){
            game.bossinfo.loopType=1;
        }
    },
            },
            "moon_7_5":{
                trigger:{
                    player:"loseEnd",
                },
                forced:true,
                filter:function (event,player){
        return (player.num('h')<Math.min(5));
    },
                content:function (){
     player.draw(Math.min(5)-player.num('h'));
    },
            },
            "moon_7_6":{
                trigger:{
                    global:"dieAfter",
                },
                forced:true,
                unique:true,
                content:function (){
        
        player.gainMaxHp();
        
        player.recover();
    },
                ai:{
                    threaten:1.5,
                },
                mod:{
                    cardUsable:function (card){
            if(get.info(card)&&get.info(card).forceUsable) return;
            return Infinity;
        },
                    targetInRange:function (){
            return true;
        },
                },
            },
            "moon_8_1":{
                trigger:{
                    player:"shaBegin",
                },
                check:function (event,player){
        return ai.get.attitude(player,event.target)<0;
    },
                content:function (){
        "step 0"
        player.judge(function(){return 0});
        if(!trigger.target.hasSkill('fengyin')){
            trigger.target.addTempSkill('fengyin','phaseAfter');
        }
        "step 1"
        var suit=get.suit(result.card);
        var target=trigger.target;
        var num=target.num('h','shan');
        target.chooseToDiscard('请弃置一张'+get.translation(suit)+'牌，否则不能使用闪抵消此杀','he',function(card){
            return get.suit(card)==_status.event.suit;
        }).set('ai',function(card){
            var num=_status.event.num;
            if(num==0) return 0;
            if(card.name=='shan') return num>1?2:0;
            return 8-ai.get.value(card);
        }).set('num',num).set('suit',suit);
        "step 2"
        if(!result.bool){
            trigger.directHit=true;
        }
    },
            },
            "moon_8_3":{
                mod:{
                    cardUsable:function (card,player,num){
            if(card.name=='sha') return Infinity;
        },
                },
                group:["moon_8_3_sha","moon_8_3_shan"],
                subSkill:{
                    sha:{
                        enable:["chooseToUse","chooseToRespond"],
                        filterCard:{
                            name:"shan",
                        },
                        viewAs:{
                            name:"sha",
                            suit:"diamond",
                            number:10,
                        },
                        viewAsFilter:function (player){
                if(!player.num('h','shan')) return false;
            },
                        prompt:"将一张闪当杀使用或打出",
                        check:function (){return 1},
                        ai:{
                            effect:{
                                target:function (card,player,target,current){
                        if(get.tag(card,'respondSha')&&current<0) return 0.6
                    },
                            },
                            respondSha:true,
                            skillTagFilter:function (player){
                    if(!player.num('h','shan')) return false;
                },
                            order:4,
                            useful:-1,
                            value:-1,
                            basic:{
                                useful:[5,1],
                                value:[5,1],
                            },
                            result:{
                                target:function (player,target){
                        if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                            if(ai.get.attitude(player,target)>0){
                                return -6;
                            }
                            else{
                                return -3;
                            }
                        }
                        return -1.5;
                    },
                            },
                            tag:{
                                respond:1,
                                respondShan:1,
                                damage:function (card){
                        if(card.nature=='poison') return;
                        return 1;
                    },
                                natureDamage:function (card){
                        if(card.nature) return 1;
                    },
                                fireDamage:function (card,nature){
                        if(card.nature=='fire') return 1;
                    },
                                thunderDamage:function (card,nature){
                        if(card.nature=='thunder') return 1;
                    },
                                poisonDamage:function (card,nature){
                        if(card.nature=='poison') return 1;
                    },
                            },
                        },
                    },
                    shan:{
                        enable:["chooseToRespond"],
                        filterCard:{
                            name:"sha",
                        },
                        viewAs:{
                            name:"shan",
                            suit:"heart",
                            number:9,
                        },
                        prompt:"将一张杀当闪打出",
                        check:function (){return 1},
                        ai:{
                            respondShan:true,
                            skillTagFilter:function (player){
                    if(!player.num('h','sha')) return false;
                },
                            effect:{
                                target:function (card,player,target,current){
                        if(get.tag(card,'respondShan')&&current<0) return 0.6
                    },
                            },
                            order:4,
                            useful:-1,
                            value:-1,
                            basic:{
                                useful:[7,2],
                                value:[7,2],
                            },
                        },
                    },
                },
            },
            "moon_8_4":{
                trigger:{
                    source:"damageBefore",
                },
                content:function (){
trigger.untrigger();
        trigger.finish();

trigger.player.loseMaxHp(true);
   },
            },
            "moon_8_5":{
                trigger:{
                    player:"phaseBegin",
                },
                filter:function (event,player){
        if(!player.num('h',{suit:'spade'})) return false;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i].num('j','shandian')){
                return false;
            }
        }
        return true;
    },
                forced:true,
                check:function (){
        return false;
    },
                content:function (){
        'step 0'
        var card=get.cardPile('shandian',true);
        if(card){
            player.addJudge(card);
            player.$draw(card);
            game.delay();
        }
        else{
            event.finish();
        }
        'step 1'
        game.delay();
    },
                ai:{
                    threaten:1.5,
                },
            },
            "moon_9_1":{
                enable:"phaseUse",
                direct:true,
                delay:false,
                unique:true,
                filter:function (event,player){
        return player.storage.ubw>0
    },
                content:function (){
        'step 0'
        player.storage.ubw--;
if(!player.storage.ubw){
player.unmarkSkill('ubw');
}
        var list=get.gainableSkills();
        list.remove('moon_9_1');
        list=list.randomGets(6);
        event.skillai=function(){
            return list.randomGet();
        };
        if(event.isMine()){
            var dialog=ui.create.dialog();
            dialog.add('选择获得一项技能');
            var clickItem=function(){
                _status.event._result=this.link;
                dialog.close();
                game.resume();
            };
            for(var i=0;i<list.length;i++){
                if(lib.translate[list[i]+'_info']){
                    var translation=get.translation(list[i]);
                    if(translation[0]=='新'&&translation.length==3){
                        translation=translation.slice(1,3);
                    }
                    else{
                        translation=translation.slice(0,2);
                    }
                    var item=dialog.add('<div class="popup" style="width:50%;display:inline-block"><div class="skill">【'+
                    translation+'】</div><div>'+lib.translate[list[i]+'_info']+'</div></div>');
                    item.firstChild.addEventListener('click',clickItem);
                    item.firstChild.link=list[i];
                }
            }
            dialog.add(ui.create.div('.placeholder'));
            event.switchToAuto=function(){
                event._result=event.skillai();
                dialog.close();
                game.resume();
            };
            _status.imchoosing=true;
            game.pause();
        }
        else{
            event._result=event.skillai();
        }
        'step 1'
        _status.imchoosing=false;
        var link=result;
        player.addAdditionalSkill('moon_9_1',link);
        player.popup(link);
        game.log(player,'获得了技能','【'+get.translation(link)+'】');
        player.checkMarks();
        player.markSkill('moon_9_1');
        game.delay();
    var chat=['兵器不论真赝，只取决于使用者的能力'].randomGet()
                  player.say(chat);

    },
                intro:{
                    content:function (storage,player){
            return '当前技能：'+get.translation(player.additionalSkills.moon_9_1);
        },
                },
                ai:{
                    order:11,
                    result:{
                        player:function (player){
                if(player.getStat().skill.moon_9_1) return 0;
                return 1;
            },
                    },
                },
            },
            "moon_9_2":{
                mod:{
                    globalFrom:function (from,to){
return -Infinity;
        },
                },
            },
            "moon_9_3":{
                enable:"phaseUse",
                usable:1,
                unique:true,
                filter:function (event,player){
return player.storage.ubw>0
},
                content:function (){
        "step 0"
 player.storage.ubw--;
if(!player.storage.ubw){
player.unmarkSkill('ubw');
}     
        "step 1"
        event.players=get.players(player);
        "step 2"
        if(event.players.length){
            var current=event.players.shift();
            if(current.isEnemyOf(player)){
                player.line(current,'fire');
                current.damage(1,'fire');
            }
            event.redo();
        }
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].canUse('sha',player)&&game.players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            "moon_10_1":{
                trigger:{
                    player:"phaseAfter",
                },
                forced:true,
                filter:function (event,player){
        return event.parent.name!='moon_10_1';
    },
                content:function (){
        player.phase();
    },
                ai:{
                    threaten:1.8,
                },
            },
            "moon_10_2":{
                trigger:{
                    player:"shaBegin",
                },
                direct:true,
                unique:true,
                filter:function (event,player){
        if(!player.num('he')) return false;
        return true;
    },
                content:function (){
        "step 0"
        player.chooseCardTarget({
            position:'he',
            filterTarget:function(card,player,target){
                if(player==target) return false;
                if(!lib.character[target.name]) return false;
                return true;
            },
            filterCard:lib.filter.cardDiscardable,
            ai1:function(card){
                return ai.get.unuseful(card)+9;
            },
            ai2:function(target){
                if(target.storage.moon_10_2) return Math.max(1,10-target.maxHp);
                return 1/target.maxHp;
            },
            prompt:get.prompt('moon_10_2')
        });
        "step 1"
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('moon_10_2',target);
            if(target.storage.moon_10_2){
                target.loseMaxHp();
                target.turnOver();
                
            }
            else{
                target.disableSkill('moon_10_2',lib.character[target.name][3]);
                target.storage.moon_10_2=true;
            }
            player.discard(result.cards);
        }
      
    },
                ai:{
                    expose:0.2,
                },
            },
            "moon_10_3":{
                trigger:{
                    player:"phaseBegin",
                },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_10_3'),function(card,player,target){
            if(target.isFriendOf(player)) return false;
            return lib.filter.targetEnabled({name:'sha'},player,target);
        }).ai=function(target){
            return ai.get.effect(target,{name:'sha'},player);
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_10_3');
            player.useCard({name:'sha'},result.targets,false);
            player.turnOver();
        }

    },
                group:"moon_10_4",
                ai:{
                    expose:0.2,
                    threaten:1.3,
                },
            },
            "moon_10_4":{
                trigger:{
                    player:"damageBefore",
                },
                filter:function (event,player){
        return player.isTurnedOver();
    },
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
            },
            "moon_11_1":{
                mod:{
                    targetInRange:function (card,player,target,now){
            if(card.name=='sha') return true;
        },
                    selectTarget:function (card,player,range){
            if(card.name=='sha'&&range[1]!=-1) range[1]=Infinity;
        },
                },
            },
            "moon_11_2":{
                mod:{
                    cardUsable:function (card){
            if(get.info(card)&&get.info(card).forceUsable) return;
            return Infinity;
        },
                    targetInRange:function (){
            return true;
        },
                },
                trigger:{
                    player:"useCard",
                },
                filter:function (event,player){
        if(_status.currentPhase!=player) return false;
        return get.cardCount(event.card,player)>1;
    },
                forced:true,
                content:function (){
        player.loseHp();
        player.gainMaxHp();
    },
            },
            "moon_12_1":{
                trigger:{
                    player:"damageBefore",
                },
                filter:function (event,player){
        return player.isTurnedOver();
    },
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
            },
            "moon_12_2":{
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        if(player==target) return false;
if(!target.isTurnedOver()) return false;
        return target.sex=='female';
      
    },
                content:function (){
        "step 0"
        target.die();
        "step 1"
        if(!player.isTurnedOver()){
                player.turnOver();
            }
    },
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
  
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_12_3":{
                skillAnimation:"legend",
                enable:"phaseUse",
                forced:true,
                filter:function (event,player){
return !player.storage.moon_12_3;
 if(player.isTurnedOver()) return true;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i]!=player&&!game.players[i].isTurnedOver()){
                return true;
            }
        }
        return false;
    },
                content:function (){
        "step 0"
     player.storage.moon_12_3=true;  event.targets=game.players.slice(0);
        event.targets.remove(player);
        event.targets.sort(lib.sort.seat);
        if(player.isTurnedOver()) player.turnOver();
        "step 1"
        if(event.targets.length){
            var target=event.targets.shift();
            if(!target.isTurnedOver()){
                target.turnOver();
            }
            event.redo();
        }
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].canUse('sha',player)&&game.players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            "moon_12_4":{
                trigger:{
                    global:"dieAfter",
                },
                filter:function (event,player){
        return player.hp<player.maxHp;
    },
                forced:true,
                content:function (){
        player.recover();
    },
                ai:{
                    threaten:1.2,
                },
            },
            "moon_12_5":{
                trigger:{
                    source:"damageEnd",
                },
                forced:true,
                filter:function (event,player){
        return event.player.isAlive()&&event.player!=player;
    },
                content:function (){
        'step 0'
        trigger.player.turnOver();
        'step 1'
        player.turnOver();
    },
            },
            "moon_13_1":{
                unique:true,
                trigger:{
                    player:"loseEnd",
                },
                forced:true,
                init:function (player){
        player.storage.moon_13_1=0;
    },
                filter:function (event,player){
        return player.storage.moon_13_1<=12;
    },
                content:function (){
       
        player.storage.moon_13_1+=Math.abs(trigger.num);
        if(player.storage.moon_13_1){
            player.markSkill('moon_13_1');
        }
        game.addVideo('storage',player,['moon_13_1',player.storage.moon_13_1]);
    },
                intro:{
                    content:"mark",
                },
                ai:{
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(player.hasSkill('jueqing')) return [1,-1.5];
                    if(player.hp>=4) return [1,1.5];
                    if(target.hp==3) return [1,1];
                    if(target.hp==2) return [1,0.5];
                }
            },
                    },
                },
            },
            "moon_13_2":{
                animationColor:"true",
                skillAnimation:"legend",
                enable:"phaseUse",
                priority:101,
                filterTarget:function (card,player,target){
        if(player==target) return false;
return player.storage.moon_13_1>12;
    },
                content:function (){
"step 0"
player.storage.moon_13_1=0;
player.unmarkSkill('moon_13_1');

       "step 1" 
       target.damage(target.maxHp);
        "step 2"
        target.die();
   
    },
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
  
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_13_3":{
                enable:"phaseUse",
                usable:1,
                unique:true,
                content:function (){
        "step 0"
     event.players=get.players(player);
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            if(current.isEnemyOf(player)){
                player.line(current,'thunder');
                current.damage(1,'thunder');
            }
            event.redo();
        }
        player.recover();
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].canUse('sha',player)&&game.players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            "moon_14_1":{
                enable:"phaseUse",
                usable:1,
                filter:function (event,player){
return game.dead.length>0;
},
                direct:true,
                notarget:true,
                content:function (){
                "step 0"
                 var list=[];
                 for(var i=0;i<game.dead.length;i++){
                     list.push(game.dead[i].name);
                 }                 player.chooseButton(ui.create.dialog('选择1名角色复活',[list,'character']),function(button){
                 for(var i=0;i<game.dead.length&&game.dead[i].name!=button.link;i++);
                     return ai.get.attitude(_status.event.player,game.dead[i]);
                 }); 
                "step 1"
                 if(result.bool){
                     for(var i=0;i<game.dead.length&&game.dead[i].name!=result.buttons[0].link;i++);
                     var dead=game.dead[i];
                     player.logSkill('moon_14_1',dead);
                     dead.revive(dead.maxHp);
                     dead.draw(dead.maxHp);
           dead.addSkill('degula3');
     }
},
            },
            "moon_14_2":{
                trigger:{
                    player:"damageBefore",
                },
                filter:function (event){
        if(event.nature) return true;
    },
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
player.recover(trigger.num);
    },
                ai:{
                    effect:{
                        target:function (card){
                if(get.tag(card,'natureDamage')){
                    return [0,2];
                }
            },
                    },
                },
            },
            "moon_14_3":{
                trigger:{
                    player:"phaseBegin",
                },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_14_3'),function(card,player,target){
            return player!=target;
        }).ai=function(target){
            return ai.get.damageEffect(target,player,player,'thunder');
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_14_3',result.targets);
            result.targets[0].damage(1,'thunder');
        }
    },
            },
            "moon_14_4":{
                enable:"phaseUse",
                usable:3,
                chooseButton:{
                    dialog:function (){
            var list1=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='trick') list1.push(['trick','',i]);
            }
            var list2=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='basic') list2.push(['basic','',i]);
            }
            var dialog=ui.create.dialog();
            dialog.add('基本牌');
            dialog.add([list2,'vcard']);
            dialog.add('锦囊牌');
            dialog.add([list1,'vcard']);
            return dialog;
        },
                    filter:function (button,player){
            return lib.filter.filterCard({name:button.link[2]},player,_status.event.getParent());
        },
                    check:function (button,player){
            var player=_status.event.player;
            var recover=0,lose=1;
            for(var i=0;i<game.players.length;i++){
                if(!game.players[i].isOut()){
                    if(game.players[i].hp<game.players[i].maxHp){
                        if(ai.get.attitude(player,game.players[i])>0){
                            if(game.players[i].hp<2){
                                lose--;
                                recover+=0.5;
                            }
                            lose--;
                            recover++;
                        }
                        else if(ai.get.attitude(player,game.players[i])<0){
                            if(game.players[i].hp<2){
                                lose++;
                                recover-=0.5;
                            }
                            lose++;
                            recover--;
                        }
                    }
                    else{
                        if(ai.get.attitude(player,game.players[i])>0){
                            lose--;
                        }
                        else if(ai.get.attitude(player,game.players[i])<0){
                            lose++;
                        }
                    }
                }
            }
            if(lose>recover&&lose>0&&player.storage.pd=='trick') return (button.link[2]=='wanjian')?1:-1;
            if(lose<recover&&recover>0&&player.storage.pd=='trick') return (button.link[2]=='taoyuan')?1:-1;
            if(player.storage.pd=='basic'&&player.isDamaged()) return (button.link[2]=='tao')?1:-1;
            if(player.storage.pd=='basic'&&player.num('h','sha')) return (button.link[2]=='jiu')?1:-1;
            if(player.storage.pd=='basic'&&!player.num('h','sha')) return (button.link[2]=='sha')?1:-1;
            if(player.storage.pd=='trick')    return (button.link[2]=='wuzhong')?1:-1;
            if(game.players.length<4&&player.storage.pd=='trick') return (button.link[2]=='shunshou')?1:-1;
            return (button.link[2]=='guohe')?1:-1;
        },
                    backup:function (links,player){
            return {
                filterCard:function(){return false},
                selectCard:-1,
                popname:true,
                viewAs:{name:links[0][2]},
                onuse:function(result,player){
                    player.logSkill('moon_14_4');
                    game.log(player,'声明了'+get.translation(links[0][0])+'牌');
                    var cards=get.cards();
                    player.showCards(cards);
                    result.cards=cards;
                    if(get.type(cards[0],'trick')!=links[0][0]){
                        player.loseHp();
                    }
                    delete player.storage.pd;
                }
            }
        },
                    prompt:function (links,player){
            return '亮出牌堆顶的一张牌，并将此牌当'+get.translation(links[0][2])+'使用。若亮出的牌不为'+get.translation(links[0][0])+'牌，你须先失去1点体力。(你的出牌阶段限一次。)';
        },
                },
                ai:{
                    order:10,
                    result:{
                        player:function (player){
                if(player.storage.pd!=undefined) return 1;
                if(player.hp<=1&&player.storage.pd==undefined) return -10;
                if(Math.random()<0.67) return 0.5;
                return -1;
            },
                    },
                    threaten:4,
                },
                group:["moon_14_4_a","moon_14_4_b","moon_14_4_c"],
                subSkill:{
                    c:{
                        enable:"chooseToRespond",
                        filter:function (event,player){
        return _status.dying!=player&&event.parent.name!='phaseUse';
    },
                        filterCard:function (){return false},
                        selectCard:-1,
                        check:function (card,event){
        var player=_status.event.player;
        if(player.storage.pd=='basic') return 1;
        if(player.num('h','shan')) return 0;    
        return 1;    
    },
                        viewAs:{
                            name:"shan",
                        },
                        onrespond:function (result,player){
        var cards=get.cards();
        player.showCards(cards);
        result.cards=cards;
        if(get.type(cards[0],'trick')!='basic'){
            player.loseHp();
        }
        delete player.storage.pd;
    },
                        ai:{
                            skillTagFilter:function (player){
            return _status.dying!=player;
        },
                            respondShan:true,
                            basic:{
                                useful:[7,2],
                                value:[7,2],
                            },
                        },
                    },
                    b:{
                        enable:"chooseToUse",
                        filter:function (event,player){
        return _status.dying!=player&&event.parent.name!='phaseUse';
    },
                        filterCard:function (){return false},
                        "ai2":function (target){
        var player=_status.event.player;
        if(player.storage.pd=='trick') return 1;
        if(player.hp==1&&player.storage.pd!='trick') return 0;
        if(ai.get.attitude(player,_status.currentPhase)>=2){
            if(_status.currentPhase.hasJudge('lebu')||_status.currentPhase.hasJudge('bingliang')){
                return 10;
            }
            return 0;
        }
        if(player.hp<=2&&!player.num('h','tao')) return 0;
        return 1;
    },
                        selectCard:-1,
                        viewAs:{
                            name:"wuxie",
                        },
                        viewAsFilter:function (player){
        return _status.dying!=player;
    },
                        onuse:function (result,player){
        var cards=get.cards();
        player.showCards(cards);
        result.cards=cards;
        if(get.type(cards[0],'trick')!='trick'){
            player.loseHp();
        }
        delete player.storage.pd;
    },
                        ai:{
                            basic:{
                                useful:[6,4],
                                value:[6,4],
                            },
                            result:{
                                player:1,
                            },
                            expose:0.2,
                        },
                    },
                    a:{
                        enable:["chooseToUse","chooseToRespond"],
                        filter:function (event,player){
        return _status.dying!=player&&event.parent.name!='phaseUse';
    },
                        filterCard:function (){return false},
                        selectCard:-1,
                        check:function (card,event){
        var player=_status.event.player;
        if(player.storage.pd=='basic') return 1;
        if(player.num('h','sha')) return 0;    
        return 1;    
    },
                        viewAs:{
                            name:"sha",
                        },
                        onuse:function (result,player){
        var cards=get.cards();
        player.showCards(cards);
        result.cards=cards;
        if(get.type(cards[0],'trick')!='basic'){
            player.loseHp();
        }
        delete player.storage.pd;
    },
                        onrespond:function (result,player){
        var cards=get.cards();
        player.showCards(cards);
        result.cards=cards;
        if(get.type(cards[0],'trick')!='basic'){
            player.loseHp();
        }
        delete player.storage.pd;
    },
                        ai:{
                            skillTagFilter:function (player){
            return _status.dying!=player;
        },
                            respondSha:true,
                            basic:{
                                useful:[5,1],
                                value:[5,1],
                            },
                            order:3,
                            result:{
                                target:function (player,target){
                if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                    if(ai.get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3;
                    }
                }
                return -1.5;
            },
                            },
                            tag:{
                                respond:1,
                                respondShan:1,
                                damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                                natureDamage:function (card){
                if(card.nature) return 1;
            },
                                fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                                thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                                poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                            },
                        },
                    },
                },
            },
            "moon_15_1":{
                enable:"phaseUse",
                filter:function (event,player){
        return player.num('he',{subtype:'equip1'});
    },
                filterCard:function (card){
        return get.subtype(card)=='equip1';
    },
                position:"he",
                selectCard:[1,Infinity],
                filterTarget:function (card,player,target){
        return player!=target;
    },
                check:function (card){
        8-ai.get.value(card);
    },
                content:function (){
        target.damage(cards.length);
       

    },
                group:["moon_15_1_changeHp","moon_15_1_lose"],
                subSkill:{
                    lose:{
                        trigger:{
                            player:"loseEnd",
                        },
                        unique:true,
                        forced:true,
                        usable:5,
                        check:function (){return 1},
                        content:function (){
                var card=get.cardPile(function(card){
                    return get.subtype(card)=='equip1';
                });
                if(card){
                    player.gain(card,'gain2');
                    game.log(player,'从牌堆获得了',card);
                }
                player.recover();
                var chat=['打开宝物库的门锁吧！'].randomGet()
                  player.say(chat);

            },
                    },
                    changeHp:{
                        trigger:{
                            player:["recoverEnd","loseHpEnd"],
                        },
                        unique:true,
                        forced:true,
                        check:function (){return 1},
                        content:function (){
                player.draw();
                var chat=['打开宝物库的门锁吧！'].randomGet()
                  player.say(chat);

            },
                    },
                },
                ai:{
                    order:function (){
            return lib.card.sha.ai.order-1;
        },
                    result:{
                        target:function (player,target){
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_15_2":{
                trigger:{
                    player:"phaseEnd",
                },
                unique:true,
                forced:true,
                filter:function (event,player){
        return player.hp!=player.maxHp;
    },
                content:function (){
        "step 0"
        event.players=get.players(player);
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            if(current.isEnemyOf(player)){
                player.line(current,'thunder');
                current.damage(3,'thunder');
            }
            event.redo();
        }
        var chat=['领教起源之理吧。天地乖离开辟之星！'].randomGet()
                  player.say(chat);

    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].canUse('sha',player)&&game.players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            "moon_15_3":{
                enable:"phaseUse",
                usable:1,
                filterCard:{
                    suit:["heart","spade","diamond","club"],
                },
                position:"he",
                filter:function (event,player){
        return player.num('he')>0;
    },
                filterTarget:function (card,player,target){
        return target!=player;
    },
                check:function (card){
        return 6-ai.get.value(card);
    },
                content:function (){
        target.addTempSkill('moon_15_4','phaseAfter');
        
    },
                ai:{
                    order:7.9,
                    result:{
                        target:function (player,target){
                var nh=target.num('h');
                if(ai.get.attitude(player,target)<0&&nh>=3&&
                player.canUse('sha',target)&&player.num('h','sha')&&
                ai.get.effect(target,{name:'sha'},player,player)>0){
                    return -nh-5;
                }
                return -nh;
            },
                    },
                },
            },
            "moon_15_4":{
                mod:{
                    cardEnabled:function (){
                    return false;
                },
                    cardUsable:function (){
                    return false;
                },
                    cardRespondable:function (){
                    return false;
                },
                    cardSavable:function (){
                    return false;
                },
                },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                        if(get.tag(card,'respondShan')||get.tag(card,'respondSha')){
                            if(current<0) return 1.5;
                        }
                    },
                    },
                },
            },
            "moon_15_5":{
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('全知全能之星',[list.trick,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=[];
                for(var i=0;i<game.players.length;i++){
                    if(lib.filter.filterTarget(card,player,game.players[i])){
                        targets.push(game.players[i]);
                    }
                }
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                // player.addTempSkill('moon_15_5_1',{player:'Begin'});
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
            player.useCard(event.card,result.targets);
        }
     

    },
                ai:{
                    threaten:1.5,
                },
            },
            "moon_15_6":{
                mod:{
                    globalFrom:function (from,to){
return -Infinity;
        },
                },
            },
            "moon_15_7":{
                trigger:{
                    player:"dying",
                },
                priority:100,
                unique:true,
                forced:true,
                filter:function (event,player){
        return player.hp<=0;
    },
                content:function (){
"step 0"
            player.recover(player.maxHp-player.hp);
    player.addTempSkill('qianxing',{player:'phaseBegin'});
"step 1"
player.removeSkill('moon_15_7');
       

    },
                ai:{
                    threaten:0.8,
                },
            },
            "moon_16_1":{
                trigger:{
                    global:"gameDrawAfter",
                },
                forced:true,
                content:function (){
        player.changeHujia(Infinity);
},
                group:["moon_16_1_1","moon_16_1_2"],
            },
            "moon_16_2":{
                skillAnimation:"legend",
                enable:"phaseUse",
                filter:function (event,player){
        return player.hujia?true:false;
    },
                filterTarget:function (card,player,target){
        return player!=target;
    },
                selectTarget:1,
                content:function (){
        target.damage(player.hujia);
        target.die();
        if(target==targets[0]){
            player.changeHujia(-player.hujia);
        }
        player.removeSkill('moon_16_2');
        player.removeSkill('moon_16_1');
    },
                ai:{
                    order:9,
                    result:{
                        target:function (player,target){
                var eff=ai.get.damageEffect(target,player,target)+0.5;
                if(eff>0&&eff<=0.5) return 0;
                return eff;
            },
                    },
                },
            },
            "moon_16_3":{
                trigger:{
                    player:"phaseBegin",
                },
                group:"moon_16_4",
                direct:true,
                content:function (){
        "step 0"
        if(player.num('he')){
            player.chooseCardTarget({
                prompt:get.prompt('moon_16_3'),
                filterCard:lib.filter.cardDiscardable,
                position:'he',
                filterTarget:function(card,player,target){
                    if(target==player) return false;
           
                    var name=target.name.indexOf('unknown')==0?target.name2:target.name;
                    if(name==player.storage.moon_16_3) return false;

                    var info=lib.character[name];
                    if(info){
                        var skills=info[3];
                        for(var j=0;j<skills.length;j++){
                            if(lib.translate[skills[j]+'_info']&&lib.skill[skills[j]]&&
                                !lib.skill[skills[j]].unique&&!player.hasSkill(skills[j])){
                                return true;
                            }
                        }
                    }
                    return false;
                },
                ai1:function(card){
                    if(player.additionalSkills.moon_16_3&&player.additionalSkills.moon_16_3.length>0) return 0;
                    return 7-ai.get.value(card);
                },
                ai2:function(target){
                    if(target.isMin()) return 0;
                    return 6-target.maxHp;
                }
            });
        }
        else{
            event.finish();
        }
        "step 1"
        if(result.bool){
            player.unmark(player.storage.moon_16_3+'_charactermark');
            player.discard(result.cards);
            player.logSkill('moon_16_3',result.targets);
            var name=result.targets[0].name;
            if(name.indexOf('unknown')==0){
                name=result.targets[0].name2;
            }
            var list=[];
            var skills=lib.character[name][3];
            for(var j=0;j<skills.length;j++){
                if(lib.translate[skills[j]+'_info']&&lib.skill[skills[j]]&&
                    !lib.skill[skills[j]].unique&&!player.hasSkill(skills[j])){
                    list.push(skills[j]);
                }
            }
            player.addAdditionalSkill('moon_16_3',list);
            player.markCharacter(name,null,true,true);
            game.addVideo('markCharacter',player,{
                name:'幻形',
                content:'',
                id:'moon_16_3',
                target:name
            });
            player.storage.moon_16_3=name;
        }
    },
                ai:{
                    threaten:1.5,
                },
            },
            "moon_16_4":{
                trigger:{
                    player:"damageAfter",
                },
                priority:-15,
                forced:true,
                filter:function (event,player){
                return player.additionalSkills.moon_16_3&&player.additionalSkills.moon_16_3.length>0;
            },
                content:function (){
                player.unmark(player.storage.moon_16_3+'_charactermark');
                player.removeAdditionalSkill('moon_16_3');
                delete player.storage.moon_16_3;
                player.checkMarks();
            },
            },
            "moon_16_5":{
                enable:"chooseToUse",
                filterCard:function (card){
        return get.color(card);
    },
                viewAsFilter:function (player){
        return player.num('h')>0;
    },
                viewAs:{
                    name:"wuxie",
                    suit:"diamond",
                    number:11,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"diamond","number":11,"name":"shan","_transform":"translateX(112px)","clone":{"name":"shan","suit":"diamond","number":11,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":3407},"original":"h","timeout":3386}],
                },
                prompt:"将一张手牌当无懈可击使用",
                check:function (card){return 8-ai.get.value(card)},
                threaten:1.2,
                ai:{
                    basic:{
                        useful:[6,4],
                        value:[6,4],
                    },
                    result:{
                        player:1,
                    },
                    expose:0.2,
                },
            },
            "moon_16_6":{
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_16_6'),function(card,player,target){
            return player!=target;
        }).ai=function(target){
            return ai.get.damageEffect(target,player,player,'fire');
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_16_6',result.targets);
            result.targets[0].damage('fire',2);
        }
    },
            },
            "moon_17_1":{
                trigger:{
                    source:"damageBefore",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
       
        return event.player!=player&&Math.random()<=0.1;
    },
                content:function (){
        "step 0"
        trigger.player.damage(Infinity);
        "step 1"
        trigger.player.die();
    },
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'&&player!=target){
                return false;
            }
        },
                    targetInRange:function (){
            return true;
        },
                },
                group:["moon_17_1_1","moon_17_1_2","moon_17_1_3","moon_17_1_a"],
                subSkill:{
                    a:{
                        trigger:{
                            player:"damageBegin",
                        },
                        forced:true,
                        priority:-500,
                        content:function (){
if(trigger.num>player.hp) trigger.num=1;
},
                    },
                },
            },
            "moon_17_1_1":{
                trigger:{
                    player:["turnOverBefore","loseHpBefore","loseMaxHpBefore"],
                },
                forced:true,
                unique:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
            },
            "moon_17_2":{
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                unique:true,
                check:function (event,player){
        return ai.get.attitude(player,event.target)<=0;
    },
                filter:function (event,player){
       return Math.random()<=0.9;

    },
                content:function (){
        trigger.directHit=true;
    },
                group:["moon_17_2_1","moon_17_2_2","moon_17_2_3","moon_17_2_4","moon_17_2_5","moon_17_2_a"],
                subSkill:{
                    a:{
                        trigger:{
                            source:"damageAfter",
                        },
                        filter:function (event){
    return Math.random()<=0.6;

    },
                        forced:true,
                        content:function (){
        trigger.player.damage();
    },
                    },
                },
            },
            "moon_17_2_1":{
                trigger:{
                    source:"damageEnd",
                },
                filter:function (event){
    return Math.random()<=0.3;

    },
                forced:true,
                content:function (){
        trigger.player.loseMaxHp();
    },
            },
            "moon_17_2_2":{
                trigger:{
                    player:"shaBefore",
                },
                forced:true,
                content:function (){
        player.getStat().card.sha--;
    },
            },
            "moon_17_2_3":{
                trigger:{
                    player:"shaAfter",
                },
                forced:true,
                content:function (){
        player.draw();
    },
            },
            "moon_17_3":{
                trigger:{
                    player:"dying",
                },
                priority:100,
                unique:true,
                forced:true,
                filter:function (event,player){
        return player.hp<=0;
    },
                content:function (){
"step 0"
            player.recover(player.maxHp-player.hp);
        player.addSkill('moon_17_5');
       player.addTempSkill('qianxing',{player:'phaseBegin'});
    
"step 1"
player.removeSkill('moon_17_3');
       

    },
                ai:{
                    threaten:0.8,
                },
            },
            "moon_17_4":{
                trigger:{
                    player:"damageAfter",
                },
                forced:true,
                unique:true,
                priority:100,
                filter:function (event,player){
       return Math.random()<=0.7;

    },
                content:function (){
      player.hp+=trigger.num;
      player.changeHujia(trigger.num);
    },
                group:"moon_17_4_1",
            },
            "moon_17_4_1":{
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
       return Math.random()<=0.7;

    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
      player.draw(2);
    },
            },
            "moon_17_5":{
                skillAnimation:"legend",
                enable:"phaseUse",
                forced:true,
                unique:true,
                filterTarget:function (card,player,target){
        return player!=target;
    },
                content:function (){
        "step 0"
        target.damage(Infinity)._triggered=null;
        "step 1"

        target.die()._triggered=null;

        player.removeSkill('moon_17_5');
},
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
         
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_17_2_4":{
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                unique:true,
                content:function (){
                var card=get.cardPile('sha');
                if(!card){
                    card=game.createCard('sha');
                }
                player.gain(card,'gain2');
    },
                ai:{
                    threaten:1.3,
                },
            },
            "moon_17_2_5":{
                trigger:{
                    player:"damageAfter",
                },
                forced:true,
                unique:true,
                check:function (event,player){
        return ai.get.attitude(player,event.source)<=0;
    },
                filter:function (event,player){
        return event.source&&event.source.isAlive()&&event.source!=player;
    },
                content:function (){
        player.draw(2);
        player.useCard({name:'sha'},trigger.source);
    },
                ai:{
                    threaten:1.5,
                    expose:0.1,
                },
            },
            "moon_17_1_2":{
                trigger:{
                    player:"dieBefore",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
       return player.hp>=1;

    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        player.hp==player.hp;
    },
            },
            "moon_17_1_3":{
                trigger:{
                    source:"damageBefore",
                },
                forced:true,
                unique:true,
                priority:100,
                filter:function (event,player){
        return event.player.isAlive()&&event.player!=player;
    },
                content:function (){
     if(!trigger.player.hasSkill('fengyin')){
            trigger.player.addTempSkill('fengyin',{player:'phaseAfter'});
        }
    },
            },
            "moon_18_1":{
                trigger:{
                    global:"phaseBegin",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
    return event.player!=player&&Math.random()<=0.1;


},
                content:function (){
     trigger.player.die();
},
            },
            "moon_18_2":{
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                unique:true,
                check:function (event,player){
        return ai.get.attitude(player,event.target)<=0;
    },
                filter:function (event,player){
       return Math.random()<=0.6;

    },
                content:function (){
        trigger.directHit=true;
    },
                mod:{
                    targetInRange:function (){
            return true;
        },
                },
            },
            "moon_18_3":{
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                unique:true,
                content:function (){
        "step 0"
        event.players=get.players(player);
        event.players.remove(player);
        player.recover();
        "step 1"
        if(event.players.length){
            event.players.shift().damage('thunder');
            event.redo();
        }
    },
            },
            "moon_18_4":{
                trigger:{
                    source:"damageAfter",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
       
        return event.player!=player&&Math.random()<=0.4;
    },
                content:function (){
        trigger.player.damage('fire');
    },
                group:["moon_18_4_1","moon_18_4_2"],
            },
            "moon_18_4_1":{
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                unique:true,
                filter:function (event){
        return event.nature=='fire';
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        player.recover();
    },
                ai:{
                    effect:{
                        target:function (card){
                if(get.tag(card,'fireDamage')){
                    return [0,2];
                }
            },
                    },
                },
            },
            "moon_18_5":{
                trigger:{
                    player:"damageEnd",
                },
                forced:true,
                unique:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_18_5'),function(card,player,target){
            return player!=target;
        }).ai=function(target){
            return ai.get.damageEffect(target,player,player,'fire');
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_18_5',result.targets);
            result.targets[0].damage('fire',1);
        }
    },
            },
            "moon_18_4_2":{
                trigger:{
                    source:"damageEnd",
                },
                forced:true,
                unique:true,
                filter:function (event){
        return event.nature=='fire';
    },
                content:function (){
        player.recover();
    },
            },
            "moon_16_1_1":{
                trigger:{
                    player:["damageBefore","loseHpBefore","loseMaxHpBefore"],
                },
                forced:true,
                unique:true,
                filter:function (player){
        return player.Hujia!=0;
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
            },
            "moon_16_1_2":{
                trigger:{
                    player:"dieBefore",
                },
                forced:true,
                unique:true,
                filter:function (player){
        return player.Hujia!=0;
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        player.hp==player.MaxHp;
    },
            },
            "moon_19_1":{
                trigger:{
                    global:"phaseBefore",
                },
                forced:true,
                filter:function (event,player){
        return event.player!=player&&!player.storage.moon_19_1;
    },
                check:function (event,player){
        return ai.get.attitude(player,event.player)<0&&
        ((player.num('h')>player.hp&&player.num('h','lebu')==0)||get.distance(player,event.player)>1);
    },
                intro:{
                    content:function (storage,player){
            var str='';
            if(player.storage.moon_19_1_h.length){
                if(player.isUnderControl(true)){
                    str+='手牌区：'+get.translation(player.storage.moon_19_1_h);
                }
                else{
                    str+='手牌区：'+(player.storage.moon_19_1_h.length)+'张牌';
                }
            }
            if(player.storage.moon_19_1_e.length){
                if(str.length) str+='、';
                if(player.isUnderControl(true)){
                    str+='装备区：'+get.translation(player.storage.moon_19_1_e);
                }
                else{
                    str+='装备区：'+(player.storage.moon_19_1_e.length)+'张牌';
                }
            }
            return str;
        },
                    mark:function (dialog,content,player){
            if(player.storage.moon_19_1_h.length){
                if(player.isUnderControl(true)){
                    dialog.add('<div class="text center">手牌区</div>');
                    dialog.addSmall(player.storage.moon_19_1_h);
                }
                else{
                    dialog.add('<div class="text center">手牌区：'+player.storage.moon_19_1_h.length+'张牌</div>');
                }
            }
            if(player.storage.moon_19_1_e.length){
                if(player.isUnderControl(true)){
                    dialog.add('<div class="text center">装备区</div>');
                    dialog.addSmall(player.storage.moon_19_1_e);
                }
                else{
                    dialog.add('<div class="text center">装备区：'+player.storage.moon_19_1_e.length+'张牌</div>');
                }
            }
        },
                },
                logTarget:"player",
                content:function (){
        "step 0"
        player.draw(false);
        player.$draw();
        "step 1"
        player.storage.moon_19_1_h=player.get('h');
        player.storage.moon_19_1_e=player.get('e');
        player.storage.moon_19_1_n=1;
        player.syncStorage('moon_19_1_e');
        player.phase();
        player.storage.moon_19_1=trigger.player;
        player.removeSkill('moon_19_1_1');
        player.markSkill('moon_19_1');
        "step 2"
        if(!player.isTurnedOver()){
            player.turnOver();
        }
        delete player.storage.moon_19_1;
    },
                mod:{
                    targetInRange:function (card,player,target,now){
            if(target==player.storage.moon_19_1) return true;
        },
                },
                group:["moon_19_1_2","moon_19_1_3","moon_19_1_4"],
                ai:{
                    expose:0.1,
                    effect:{
                        target:function (card){
                if(card.name=='guiyoujie') return [0,0];
            },
                    },
                },
            },
            "moon_19_1_1":{
                trigger:{
                    player:["gainBegin","loseBegin"],
                },
                forced:true,
                popup:false,
                content:function (){
                player.removeSkill('moon_19_1_1');
            },
            },
            "moon_19_1_2":{
                unique:true,
                trigger:{
                    global:"damageEnd",
                },
                filter:function (event,player){
        return player.storage.moon_19_1_h&&player.storage.moon_19_1_e&&
        player.storage.moon_19_1_n>0&&!player.hasSkill('moon_19_1_1');
    },
                check:function (event,player){
        var n1=player.num('he');
        var n2=player.storage.moon_19_1_h.length+player.storage.moon_19_1_e.length;
        if(n1<n2) return true;
        if(player.hp==player.maxHp) return false;
        if(n1==n2+1) return true;
        if(n2==n2+2&&player.hp<=1) return true;
        return false;
    },
                video:function (player){
        var cards=player.get('he');
        for(var i=0;i<cards.length;i++){
            cards[i].remove();
        }
        for(var i=0;i<player.storage.moon_19_1_e.length;i++){
            player.$equip(player.storage.moon_19_1_e[i]);
        }
    },
                content:function (){
        game.addVideo('skill',player,'moon_19_1_2');
        for(var i=0;i<player.storage.moon_19_1_h.length;i++){
            if(get.position(player.storage.moon_19_1_h[i])=='s'){
                player.storage.moon_19_1_h[i]=game.createCard(player.storage.moon_19_1_h[i]);
            }
        }
        for(var i=0;i<player.storage.moon_19_1_e.length;i++){
            if(get.position(player.storage.moon_19_1_e[i])=='s'){
                player.storage.moon_19_1_e[i]=game.createCard(player.storage.moon_19_1_e[i]);
            }
        }
        player.removeEquipTrigger();
        var cards=player.get('he');
        for(var i=0;i<cards.length;i++){
            ui.discardPile.appendChild(cards[i]);
        }
        player.directgain(player.storage.moon_19_1_h);
        for(var i=0;i<player.storage.moon_19_1_e.length;i++){
            player.$equip(player.storage.moon_19_1_e[i]);
        }
        if(cards.length>player.storage.moon_19_1_h.length+player.storage.moon_19_1_e.length){
            player.recover();
        }
        player.storage.moon_19_1_n--;
        if(player.storage.moon_19_1_n<=0){
            delete player.storage.moon_19_1_h;
            delete player.storage.moon_19_1_e;
            delete player.storage.moon_19_1_n;
            player.unmarkSkill('moon_19_1');
        }
        else{
            player.addSkill('moon_19_1_1');
        }
    },
            },
            "moon_19_1_3":{
                trigger:{
                    global:"phaseAfter",
                },
                forced:true,
                priority:15,
                content:function (){
    if(player.isTurnedOver()){
        player.turnOver();
    }
},
                group:"moon_19_1_3_phaseBegin",
                subSkill:{
                    phaseBegin:{
                        trigger:{
                            player:"phaseBegin",
                        },
                        forced:true,
                        priority:25,
                        content:function (){
                if(!player.isTurnedOver()){
                    player.turnOver();
                }
            },
                    },
                },
            },
            "moon_19_1_4":{
                trigger:{
                    player:["damageBefore","loseHpBefore","loseMaxHpBefore","dieBefore"],
                },
                filter:function (event,player){
        return player.isTurnedOver();
    },
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
        player.hp==player.hp;
    },
            },
            "moon_19_2":{
                trigger:{
                    global:"recoverBefore",
                },
                forced:true,
                filter:function (event,player){
    return player!=event.player;
},
                content:function (){
     trigger.untrigger();
     trigger.finish();
},
                mod:{
                    cardUsable:function (card){
            if(get.info(card)&&get.info(card).forceUsable) return;
            return Infinity;
        },
                    targetInRange:function (){
            return true;
        },
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'&&player!=target){
                return false;
            }
        },
                },
                ai:{
                    playernowuxie:true,
                },
            },
            "moon_19_3":{
                skillAnimation:"legend",
                enable:"phaseUse",
                filterTarget:function (card,player,target){
        return player!=target;
    },
                content:function (){
target.die();
        player.recover(player.maxHp-player.hp);
player.removeSkill('moon_19_3');
},
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
         
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_19_4":{
                trigger:{
                    source:"damageBefore",
                },
                unique:true,
                forced:true,
                content:function (){
        'step 0'
        trigger.player.loseHp();
        'step 1'
                    trigger.source=trigger.player;
    
                    trigger.trigger('damageBefore');
   
    },
            },
            "moon_19_5":{
                trigger:{
                    player:"damageAfter",
                },
                forced:true,
                unique:true,
                check:function (event,player){
        return ai.get.attitude(player,event.source)<=0;
    },
                filter:function (event,player){
        return event.source&&event.source.isAlive()&&event.source!=player;
    },
                content:function (){
    trigger.source.loseHp(trigger.source.hp);
    },
                ai:{
                    threaten:1.5,
                    expose:0.1,
                },
            },
            "moon_19_6":{
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_19_6'),function(card,player,target){
            return player!=target;
        }).ai=function(target){
            return ai.get.damageEffect(target,player,player);
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_19_6',result.targets);
            result.targets[0].goMad({player:'phaseAfter'});
        }
        player.recover();
    },
            },
            "moon_19_7":{
                inherit:"juece",
                trigger:{
                    global:"loseEnd",
                },
                check:function (event,player){
        return ai.get.damageEffect(event.player,player,player)>0;
    },
                filter:function (event,player){
        if(event.player.num('h')) return false;
        if(_status.currentPhase!=player) return false;
        if(event.player==player) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){
        player.line(trigger.player,'green');
        trigger.player.damage();
    },
                ai:{
                    threaten:1.1,
                },
                audio:"ext:型月:2",
            },
            "moon_19_8":{
                trigger:{
                    global:"damageEnd",
                },
                forced:true,
                filter:function (event,player){
        return event.player.isAlive()&&event.player!=player;
    },
                content:function (){
        'step 0'
     if(!trigger.player.isTurnedOver()){
         trigger.player.turnOver();
     }
    },
            },
            "moon_19_9":{
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                content:function (){
if(trigger.num>1) trigger.num=1;
},
            },
            "moon_19_10":{
                skillAnimation:"legend",
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                content:function (){
player.addSkill('moon_19_3');
player.addSkill('moon_19_4');
player.addSkill('moon_19_5');
player.addSkill('moon_19_6');
player.addSkill('moon_19_7');
player.addSkill('moon_19_8');
player.addSkill('moon_19_9');
player.removeSkill('moon_19_10');
},
            },
            "moon_20_1":{
                enable:"phaseUse",
                usable:1,
                unique:true,
                filterTarget:function (card,player,target){
        return player!=target&&target.sex=='male';
    },
                content:function (){
        player.addSkill(target.skills);
        player.gain(target.get('h'),target);
        target.$give(target.num('h'),player);
    },
                ai:{
                    order:10,
                    result:{
                        player:function (player){
            
                return 1;
            },
                        target:function (player,target){
              
                return 1;
            },
                    },
                    threaten:1.5,
                    effect:{
                        target:function (card){
                if(card.name=='guiyoujie') return [0,2];
            },
                    },
                },
            },
            "moon_20_2":{
                unique:true,
                filter:function (event,player){
        return event.player!=player&&event.card&&(event.card.name=='sha'||get.type(event.card)=='trick');
    },
                logTarget:"player",
                check:function (event,player){
        if(ai.get.attitude(player,event.player)>0){
            return false;
        }
        if(get.tag(event.card,'respondSha')){
            if(player.num('h',{name:'sha'})==0){
                return true;
            }
        }
        else if(get.tag(event.card,'respondShan')){
            if(player.num('h',{name:'shan'})==0){
                return true;
            }
        }
        else if(get.tag(event.card,'damage')){
            if(player.num('h')<2) return true;
        }
        else if(event.card.name=='shunshou'&&player.hp>2){
            return true;
        }
        return false;
    },
                priority:10,
                trigger:{
                    target:"useCardToBefore",
                },
                content:function (){
        "step 0"
        player.loseHp();
        trigger.player.loseHp();
        "step 1"
        trigger.untrigger();
        trigger.finish();
    },
                ai:{
                    expose:0.3,
                },
                group:"moon_20_2_hp",
                subSkill:{
                    hp:{
                        unique:true,
                        trigger:{
                            player:["damageBefore","loseHpBefore","loseMaxHpBefore"],
                        },
                        forced:true,
                        content:function (){
        trigger.untrigger();
        trigger.finish();
        player.hp--;
        if(player.num('h')) player.hp++;
    },
                    },
                },
            },
            "moon_20_3":{
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                content:function (){
        player.hp++;
        player.changeHujia();
},
            },
            "moon_20_4":{
                trigger:{
                    player:"phaseBefore",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
        return game.hasPlayer(function(current){
            return current!=player&&current.num('h');
        });
    },
                content:function (){
        "step 0"
        var players=get.players(player);
        players.remove(player);
        event.players=players;
        player.line(players,'green');
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            var hs=current.get('h')
            if(hs.length){
                var card=hs.randomGet();
                player.gain(card,current);
                current.$giveAuto(card,player);
            }
            event.redo();
        }
    },
            },
            "moon_21_1":{
                trigger:{
                    source:"damageBefore",
                },
                forced:true,
                filter:function (event,player){
        return game.hasPlayer(function(current){
            return current.isEnemyOf(player)&&event.nature!='thunder'&&event.num>=1&&!current.isLinked();
        });
    },
                content:function (){
        "step 0"
        event.targets=game.filterPlayer();
        event.targets.sort(lib.sort.seat);
        "step 1"
        if(event.targets.length){
            var target=event.targets.shift();
            if(!target.isLinked()&&target.isEnemyOf(player)){
                player.line(target,'green');
                target.link();
            }
            event.redo();
        }
    },
                group:["moon_21_1_1","moon_21_1_2","moon_21_1_4","moon_21_1_5"],
            },
            "moon_21_1_1":{
                trigger:{
                    source:"damageEnd",
                },
                filter:function (event){
        return event.nature!='thunder';
    },
                forced:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_21_1_1'),function(card,player,target){
            return player!=target;
        }).ai=function(target){
            return ai.get.damageEffect(target,player,player,'thunder');
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_21_1_1',result.targets);
            result.targets[0].damage('thunder',1);
        }
    },
            },
            "moon_21_1_2":{
                trigger:{
                    player:"damageBefore",
                },
                filter:function (event){
        if(event.nature) return true;
    },
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
player.recover(trigger.num);
    },
                ai:{
                    effect:{
                        target:function (card){
                if(get.tag(card,'natureDamage')){
                    return [0,2];
                }
            },
                    },
                },
            },
            "moon_21_2":{
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                content:function (){
        "step 0"
            player.chooseTarget('选择一名角色随机获得一个技能',true).ai=function(target){
                if(player.hp==1){
                    return ai.get.attitude(player,target)>=3&&player!=target;
                }
                return ai.get.attitude(player,target)+10;
            }

        "step 1"
        var skills=[]; 
        for(var i in lib.character){ 
            for(var j=0;j<lib.character[i][3].length;j++){ 
                var info=lib.skill[lib.character[i][3][j]];
                if(info&&(info.gainable||!info.unique)){
                    skills.add(lib.character[i][3][j]); 
                }
            } 
        }
        var link=skills.randomGet();
        player.line(result.targets[0],'green');
        result.targets[0].addSkill(link);
        result.targets[0].mark(link,{
            name:get.translation(link),
            content:lib.translate[link+'_info']
        });
        game.log(result.targets[0],'获得技能','【'+get.translation(link)+'】');        
    },
                ai:{
                    expose:0.2,
                },
                group:["moon_21_2_1","moon_21_2_2"],
            },
            "moon_21_2_1":{
                trigger:{
                    player:["damageAfter","loseHpAfter"],
                },
                forced:true,
                unique:true,
                filter:function (event,player){
       return Math.random()<=0.8;

    },
                content:function (){
      player.recover(trigger.num);
    },
            },
            "moon_21_2_2":{
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
        return event.card&&Math.random()<=0.8&&(event.card.name=='sha'||event.card.name=='juedou')&&
        event.parent.name!='_lianhuan'&&event.parent.name!='_lianhuan2';
    },
                forced:true,
                content:function (){
        trigger.num++;
    },
            },
            "moon_21_3":{
                trigger:{
                    player:"phaseDrawAfter",
                },
                forced:true,
                filter:function (event,player){
 if(player.isLinked()) return true;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i]!=player&&!game.players[i].isLinked()){
                return true;
            }
        }
        return false;
    },
                content:function (){
        "step 0"
        player.hp++;
        player.draw(2);
       event.targets=game.players.slice(0);
        event.targets.remove(player);
        event.targets.sort(lib.sort.seat);
        if(!player.isLinked()) player.link();
        "step 1"
        if(event.targets.length){
            var target=event.targets.shift();
            if(!target.isLinked()){
                target.link();
            }
            event.redo();
        }
    },
            },
            "moon_21_4":{
                skillAnimation:"legend",
                trigger:{
                    player:"changeHp",
                },
                priority:100,
                unique:true,
                forced:true,
                filter:function (event,player){
        return player.hp!=player.maxHp;
    },
                content:function (){
"step 0"
            player.recover(player.maxHp-player.hp);
    
"step 1"
player.addSkill('moon_21_1_3');
player.addSkill('moon_21_4_1');
player.removeSkill('moon_21_4');
        "step 2"
        player.update();
        ui.clear();
        while(_status.event.name!='phaseLoop'){
            _status.event=_status.event.parent;
        }
        for(var i=0;i<game.players.length;i++){
            for(var j in game.players[i].tempSkills){
                game.players[i].skills.remove(j);
                delete game.players[i].tempSkills[j];
            }
        }
        _status.paused=false;
        _status.event.player=player;
        _status.event.step=0;
        if(game.bossinfo){
            game.bossinfo.loopType=1;
        }
    },
                ai:{
                    threaten:0.8,
                },
            },
            "moon_21_4_1":{
                skillAnimation:"legend",
                enable:"phaseUse",
                usable:1,
                forced:true,
                unique:true,
                filterTarget:function (card,player,target){
        return player!=target;
    },
                content:function (){
        target.damage(3);
},
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
         
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
            },
            "moon_21_1_3":{
                trigger:{
                    source:"damageBefore",
                },
                forced:true,
                filter:function (event,player){
        return game.hasPlayer(function(current){
            return current.isEnemyOf(player)&&event.nature=='thunder'&&event.num>=1&&!current.isLinked();
        });
    },
                content:function (){
        "step 0"
        event.targets=game.filterPlayer();
        event.targets.sort(lib.sort.seat);
        "step 1"
        if(event.targets.length){
            var target=event.targets.shift();
            if(!target.isLinked()&&target.isEnemyOf(player)){
                player.line(target,'green');
                target.link();
            }
            event.redo();
        }
    },
            },
            "moon_21_1_4":{
                trigger:{
                    player:"linkBefore",
                },
                forced:true,
                content:function (){
    if(player.isLinked()){
        player.link();
    }
        if(!player.isLinked()){
            trigger.untrigger();
            trigger.finish();
        }
},
            },
            "moon_21_1_5":{
                trigger:{
                    player:["damageEnd","loseHpEnd"],
                },
                forced:true,
                unique:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_21_1_5'),function(card,player,target){
            return player!=target;
        }).ai=function(target){
            return ai.get.damageEffect(target,player,player);
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_21_1_5',result.targets);
            result.targets[0].damage();
        }
    },
            },
            "moon_15_8":{
                trigger:{
                    player:"damageEnd",
                },
                unique:true,
                forced:true,
                content:function (){
        "step 0"
        var players=get.players(player);
        players.remove(player);
        event.players=players;
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            var hs=current.get('h');
            if(hs.length){
                current.lose(hs)._triggered=null;
                current.$throw(hs);
            }
            else{
                current.damage()._triggered=null;
            }
            game.delay(0.5);
            event.redo();
        }
        var chat=['该死该死该死……！'].randomGet()
                  player.say(chat);

    },
            },
            "moon_15_5_1":{
                ai:{
                    playernowuxie:true,
                },
            },
            "moon_22_1":{
                enable:"phaseUse",
                chooseButton:{
                    dialog:function (){
            var list1=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='hsdusu') list1.push(['hsdusu','',i]);
            }
            var list2=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='hslingjian') list2.push(['hslingjian','',i]);
            }
            var list3=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='hsshenqi') list3.push(['hsshenqi','',i]);
            }
            var list4=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='jiqi') list2.push(['jiqi','',i]);
            }
            var list5=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='jiguan') list2.push(['jiguan','',i]);
            }
            var list6=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='hsbaowu') list2.push(['hsbaowu','',i]);
            }
            var list7=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='food') list2.push(['food','',i]);
            }
            var list8=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='zhenfa') list2.push(['zhenfa','',i]);
            }
            var list9=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='hsqingyu') list2.push(['hsqingyu','',i]);
            }
            var list10=[];
            for(var i in lib.card){
                if(!lib.translate[i+'_info']) continue;
                if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                if(lib.config.hiddenCardPack.indexOf(i)==0) continue;
                if(lib.card[i].type=='hsmengjing') list2.push(['hsmengjing','',i]);
            }
            var dialog=ui.create.dialog();
            dialog.add('空想具现化');
            dialog.add([list1,'vcard']);
            dialog.add([list2,'vcard']);
            dialog.add([list3,'vcard']);
            dialog.add([list4,'vcard']);
            dialog.add([list5,'vcard']);
            dialog.add([list6,'vcard']);
            dialog.add([list7,'vcard']);
            dialog.add([list8,'vcard']);
            dialog.add([list9,'vcard']);
            dialog.add([list10,'vcard']);
            return dialog;
        },
                    filter:function (button,player){
            return lib.filter.filterCard({name:button.link[2]},player,_status.event.getParent());
        },
                    check:function (button,player){
            var player=_status.event.player;
            var recover=0,lose=1;
            for(var i=0;i<game.players.length;i++){
                if(!game.players[i].isOut()){
                    if(game.players[i].hp<game.players[i].maxHp){
                        if(ai.get.attitude(player,game.players[i])>0){
                            if(game.players[i].hp<2){
                                lose--;
                                recover+=0.5;
                            }
                            lose--;
                            recover++;
                        }
                        else if(ai.get.attitude(player,game.players[i])<0){
                            if(game.players[i].hp<2){
                                lose++;
                                recover-=0.5;
                            }
                            lose++;
                            recover--;
                        }
                    }
                    else{
                        if(ai.get.attitude(player,game.players[i])>0){
                            lose--;
                        }
                        else if(ai.get.attitude(player,game.players[i])<0){
                            lose++;
                        }
                    }
                }
            }
            if(player.storage.pd=='basic'&&player.isDamaged()) return (button.link[2]=='tao')?1:-1;
            if(player.storage.pd=='basic'&&player.num('h','sha')) return (button.link[2]=='jiu')?1:-1;
            if(player.storage.pd=='basic'&&!player.num('h','sha')) return (button.link[2]=='sha')?1:-1;
        },
                    backup:function (links,player){
            return {
                filterCard:function(){return false},
                selectCard:-1,
                popname:true,
                viewAs:{name:links[0][2]},
                
            }
        },
                },
                group:["moon_22_1_1","moon_22_1_2","moon_22_1_3"],
                ai:{
                    order:10,
                    result:{
                        player:function (player){
                if(player.storage.pd!=undefined) return 1;
                if(player.hp<=1&&player.storage.pd==undefined) return -10;
                if(Math.random()<0.67) return 0.5;
                return -1;
            },
                    },
                    threaten:4,
                },
            },
            "moon_22_1_1":{
                trigger:{
                    global:"damageBegin",
                },
                filter:function (event,player){
        return event.source!=player;
    },
                direct:true,
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('空想具现化',[list.trick,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=game.filterPlayer(function(current){
                    return lib.filter.filterTarget(card,player,current);
                });
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            player.useCard(event.card,result.targets);
        }
    },
                ai:{
                    threaten:3,
                },
            },
            "moon_22_1_2":{
                trigger:{
                    player:"phaseBegin",
                },
                unique:true,
                forced:true,
                check:function (){return 1},
                content:function (){
        var card=get.cardPile(function(card){
            return get.subtype(card)=='equip5';
        });
        if(card){
            player.gain(card,'gain2');
            game.log(player,'从牌堆获得了',card);
        }
    },
            },
            "moon_22_1_3":{
                trigger:{
                    player:"equipBegin",
                },
                frequent:true,
                filter:function (event,player){
                    return player.num('e',{subtype:'equip5'})&&get.subtype(event.card)== 'equip5';
                },
                content:function (){
                    "step 0"
                    trigger.untrigger();
                    trigger.finish();
                    player.$equip(trigger.card);
                    game.addVideo('equip',player,get.cardInfo(trigger.card));
                    game.log(player,'装备了',trigger.card);
                    "step 1"
                    var info=get.info(trigger.card);
                    if(info.onEquip&&(!info.filterEquip||info.filterEquip(trigger.card,player))){
                        var next=game.createEvent('equip_'+trigger.card.name);
                        next.setContent(info.onEquip);
                        next.player=player;
                        next.trigger.card=trigger.card;
                        game.delayx();
                    }
                    delete player.equiping;
                },
                ai:{
                    effect:{
                        player:function (card,player,target){
                            if(get.subtype(card)=='equip5') return[1,10];
                        },
                    },
                },
            },
            "moon_xuming":{
                trigger:{
                    global:"phaseBegin",
                },
                forced:true,
                content:function (){
        'step 0'
        player.gainMaxHp();
        player.recover();
        player.addSkill('moon_e5');
        'step 1'
        event.target=game.filterPlayer().randomGet(player);
        if(!event.target){
            event.finish();
            return;
        }
        player.line(event.target);
        game.delayx();
        'step 2'
        event.target.loseMaxHp();
    },
                group:["moon_xuming_die","moon_xuming_damage"],
                subSkill:{
                    die:{
                        trigger:{
                            player:"dieBegin",
                        },
                        unique:true,
                        forced:true,
                        priority:10,
                        filter:function (event,player){
                return !player.storage.moon_xuming_die;
            },
                        content:function (){
                "step 0"
                player.storage.moon_xuming_die=true;
                trigger.untrigger();
                trigger.finish();
                player.hp=0;
                "step 1"
        event.target=game.filterPlayer().randomGet(player);
        if(!event.target){
            event.finish();
            return;
        }
        player.line(event.target);
        game.delayx();
                "step 2"
        player.addSkill(event.target.skills);
        player.gain(event.target.get('h'),event.target);
        player.gainMaxHp(event.target.maxHp);
        player.recover(event.target.hp);
        event.target.$give(event.target.num('h'),player);
        event.target.clearSkills();
        event.target.loseMaxHp(event.target.maxHp);
    },
                    },
                    damage:{
                        trigger:{
                            player:"dieBefore",
                        },
                        forced:true,
                        filter:function (event,player){
                return player.hp>=1;
            },
                        content:function (){
                trigger.untrigger(),
                    trigger.finish(),
                    player.hp==player.hp;
            },
                    },
                },
            },
            "moon_22_2":{
                enable:"phaseUse",
                filter:function (event,player){
       return !player.storage.moon_22_2;
 
    },
                filterTarget:function (card,player,target){
        return target!=player;
    },
                content:function (){
                'step 0'
                     player.storage.moon_22_2=true;
        'step 1'
        target.addSkill('moon_22_2_1');
        
        
    },
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
  
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
                group:"moon_22_2_a",
                subSkill:{
                    a:{
                        trigger:{
                            player:"damageEnd",
                        },
                        forced:true,
                        filter:function (event,player){
        return event.source&&event.source.isIn()&&event.source!=player;
    },
                        content:function (){

trigger.source.addTempSkill('moon_22_2_1',{player:'phaseAfter'});
   },
                    },
                },
            },
            "moon_22_2_1":{
                trigger:{
                    source:"damageBefore",
                },
                forced:true,
                content:function (){
        trigger.untrigger();
        trigger.finish();
        trigger.player.recover(trigger.num);
    },
                group:["moon_22_2_1_a","moon_22_2_1_b","moon_22_2_1_c"],
                subSkill:{
                    a:{
                        trigger:{
                            player:"recoverBefore",
                        },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
                player.loseHp(trigger.num);
            },
                    },
                    b:{
                        trigger:{
                            player:"damageBefore",
                        },
                        forced:true,
                        content:function (){
                player.loseMaxHp();
            },
                    },
                    c:{
                        trigger:{
                            player:"phaseEnd",
                        },
                        forced:true,
                        content:function (){
                player.loseHp();
            },
                    },
                },
            },
            "moon_22_3":{
                trigger:{
                    player:"damageAfter",
                },
                forced:true,
                filter:function (event,player){
        return event.num>=5;
    },
                content:function (){
        "step 0"
        player.maxHp=5;
        player.hp=5;
        "step 1"
        player.addSkill('moon_22_3_1');
        player.removeSkill('moon_22_2');
        player.addSkill('moon_22_2_2');
    },
                group:"moon_22_3_die",
                subSkill:{
                    die:{
                        trigger:{
                            player:"dieBefore",
                        },
                        filter:function (event,player){
                return player.hp>=1;
            },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
                player.hp==player.hp;
            },
                    },
                },
            },
            "moon_22_3_1":{
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                priority:-500,
                content:function (){
if(trigger.num>1) trigger.num=1
},
                group:"moon_22_3_1_a",
                subSkill:{
                    a:{
                        trigger:{
                            player:"loseHpBefore",
                        },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
            },
                    },
                },
            },
            "moon_22_2_2":{
                enable:"phaseUse",
                filter:function (event,player){
       return !player.storage.moon_22_2_2;
 
    },
                filterTarget:function (card,player,target){
        return target!=player;
    },
                content:function (){
                'step 0'
                     player.storage.moon_22_2_2=true;
        'step 1'
        target.addSkill('moon_22_2_1');
        
        
    },
                ai:{
                    order:8,
                    result:{
                        player:function (player,target){
  
                return 0;
            },
                        target:function (player,target){
                if(!player.get('e','1')){
                    if(player.hp<2) return 0;
                    if(player.hp==2&&target.hp>=2) return 0;
                }
                return ai.get.damageEffect(target,player);
            },
                    },
                },
                group:"moon_22_2_2_a",
                subSkill:{
                    a:{
                        trigger:{
                            player:"damageEnd",
                        },
                        forced:true,
                        filter:function (event,player){
        return event.source&&event.source.isIn()&&event.source!=player;
    },
                        content:function (){

trigger.source.addSkill('moon_22_2_1');
   },
                    },
                },
            },
            "moon_e5":{
                trigger:{
                    player:["loseEnd"],
                },
                filter:function (event,player){
        if(!player.equiping) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='e'&&get.subtype(event.cards[i])=='equip5') return true;
        }
        return false;
    },
                content:function (){
        var card;
        for(var i=0;i<trigger.cards.length;i++){
            if(trigger.cards[i].original=='e'&&get.subtype(trigger.cards[i])=='equip5'){
                card=trigger.cards[i];
            }
        }
        if(card){
            if(player.storage.moon_e5){
                player.unmark(player.storage.moon_e5,'moon_e5');
                player.discard(player.storage.moon_e5);
                game.addVideo('unmarkId',player,[get.cardInfo(player.storage.moon_e5),'moon_e5']);
            }
            if(card.clone){
                card.clone.moveDelete(player);
                game.addVideo('gain2',player,get.cardsInfo([card.clone]));
                player.mark(card,'moon_e5');
                game.addVideo('markId',player,[get.cardInfo(card),'moon_e5']);
            }
            ui.special.appendChild(card);
            player.storage.moon_e5=card;
            var info=get.info(card);
            if(info.skills){
                player.addAdditionalSkill('moon_e5',info.skills);
            }
            else{
                player.removeAdditionalSkill('moon_e5');
            }
        }

    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.subtype(card)=='equip5') return [1,3];
            },
                    },
                },
                intro:{
                    content:"card",
                },
                group:"moon_e5_2",
                subSkill:{
                    "2":{
                        trigger:{
                            player:"dieBegin",
                        },
                        forced:true,
                        popup:false,
                        silent:true,
                        filter:function (event,player){
                return player.storage.moon_e5?true:false;
            },
                        content:function (){
                if(player.storage.moon_e5){
                    ui.discardPile.appendChild(player.storage.moon_e5);
                    player.$throw(player.storage.moon_e5);
                }
            },
                    },
                },
            },
            "moon_23_1":{
                trigger:{
                    player:"damageEnd",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
        return event.source&&event.source.isIn()&&event.source!=player;
    },
                content:function (){
                trigger.source.damage(player.maxHp-player.hp+1);
   },
                mod:{
                    targetInRange:function (){
            return true;
        },
                },
                group:["moon_23_1_a","moon_23_1_b"],
                subSkill:{
                    a:{
                        trigger:{
                            source:"damageBegin",
                        },
                        forced:true,
                        alter:true,
                        filter:function (event,player){
        return event.player.isAlive()&&event.player!=player;
    },
                        content:function (){
                if(trigger.player.previous!=player){
        trigger.player.previous.loseHp(trigger.num);
                }
                if(trigger.player.next!=player){
            trigger.player.next.loseHp(trigger.num);
                }
    },
                    },
                    b:{
                        trigger:{
                            player:["loseHpBefore","loseMaxHpBefore"],
                        },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
            },
                    },
                },
            },
            "moon_23_2":{
                trigger:{
                    global:"damageBefore",
                },
                filter:function (event,player){
        return event.player!=player&&event.source!=player;
    },
                unique:true,
                forced:true,
                content:function (){
        trigger.player=trigger.player;
        trigger.source=player;
        trigger.trigger('damageBegin');
   },
                group:["moon_23_2_a","moon_23_2_b"],
                subSkill:{
                    a:{
                        trigger:{
                            player:"damageEnd",
                        },
                        usable:1,
                        forced:true,
                        content:function (){
                player.recover()._triggered=null;
            },
                    },
                    b:{
                        trigger:{
                            global:"dieBegin",
                        },
                        forced:true,
                        filter:function (event,player){
                return event.player!=player;
            },
                        content:function (){
                trigger.player.clearSkills();
            },
                    },
                },
            },
            "moon_23_3":{
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                filter:function (event,player){
        return event.num>player.hp;
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
            },
            "moon_23_4":{
                trigger:{
                    player:"dying",
                },
                priority:100,
                unique:true,
                forced:true,
                filter:function (event,player){
        return player.hp<=0&&!player.storage.moon_23_4;
    },
                content:function (){
        "step 0"
            player.recover(player.maxHp-player.hp);
    player.storage.moon_23_4=true;
        "step 1"
        player.addTempSkill('qianxing',{player:'phaseBegin'});
        player.addSkill('moon_23_5');
        player.addSkill('moon_23_6');
        player.removeSkill('moon_23_1');
    },
                ai:{
                    threaten:0.8,
                },
            },
            "moon_23_5":{
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                forced:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('moon_23_5'),function(card,player,target){
            if(target.isFriendOf(player)) return false;
            return lib.filter.targetEnabled({name:'sha'},player,target);
        }).ai=function(target){
            return ai.get.effect(target,{name:'sha'},player);
        }
        "step 1"
        if(result.bool){
            player.logSkill('moon_23_5');
            player.useCard({name:'sha'},result.targets,false);
        }
    },
                mod:{
                    cardUsable:function (card){
            if(get.info(card)&&get.info(card).forceUsable) return;
            return Infinity;
        },
                },
                ai:{
                    expose:0.2,
                    threaten:1.3,
                },
                group:["moon_23_5_a","moon_23_5_b","moon_23_5_c"],
                subSkill:{
                    c:{
                        trigger:{
                            player:"damageBefore",
                        },
                        filter:function (event){
        if(event.nature) return true;
    },
                        forced:true,
                        content:function (){
        trigger.untrigger();
        trigger.finish();
player.recover(trigger.num);
    },
                        ai:{
                            effect:{
                                target:function (card){
                if(get.tag(card,'natureDamage')){
                    return [0,2];
                }
            },
                            },
                        },
                    },
                    b:{
                        trigger:{
                            player:["loseHpBefore","loseMaxHpBefore"],
                        },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
            },
                    },
                    a:{
                        trigger:{
                            player:"damageBefore",
                        },
                        forced:true,
                        filter:function (event,player){
            return event.num!=1;
        },
                        content:function (){
            trigger.untrigger();
            trigger.finish();
        },
                    },
                },
            },
            "moon_23_6":{
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                check:function (event,player){
        return ai.get.attitude(player,event.target)<=0;
    },
                content:function (){
        trigger.directHit=true;
    },
                group:["moon_23_6_a","moon_23_6_b","moon_23_6_c"],
                subSkill:{
                    a:{
                        trigger:{
                            player:"dying",
                        },
                        forced:true,
                        priority:10,
                        filter:function (event,player){
                return player.hp<=0&&!player.storage.moon_23_6_a;
            },
                        content:function (){
                "step 0"
                player.storage.moon_23_6_a=true; 
                "step 1"
                player.recover(player.maxHp-player.hp);
                player.addSkill('moon_23_1');
                player.addTempSkill('qianxing',{player:'phaseBegin'});
                player.removeSkill('moon_23_6');
            },
                    },
                    b:{
                        trigger:{
                            player:"phaseBegin",
                        },
                        forced:true,
                        unique:true,
                        content:function (){
                var card=get.cardPile('sha');
                if(!card){
                    card=game.createCard('sha');
                }
                player.gain(card,'gain2');
    },
                    },
                    c:{
                        trigger:{
                            source:"damageEnd",
                        },
                        forced:true,
                        filter:function (event,player){
                return event.player!=player&&event.player.isAlive();
            },
                        content:function (){
                if(player.hp!=player.maxHp){
                    player.hp+=player.maxHp-player.hp;
                }
                trigger.player.damage();
            },
                    },
                },
            },
            "moon_24_1":{
                trigger:{
                    global:"dieAfter",
                },
                filter:function (event,player){
return game.dead.length>0;
},
                forced:true,
                content:function (){
            for(var i=0;i<game.dead.length;i++){
                game.dead[i].draw(game.dead[i].maxHp);
game.dead[i].revive(game.dead[i].maxHp);
}
     
},
                group:["moon_24_1_a","moon_24_1_b","moon_24_1_c","moon_24_1_d"],
                subSkill:{
                    d:{
                        trigger:{
                            global:"phaseEnd",
                        },
                        forced:true,
                        content:function (){
        "step 0"
        event.current=player.next;
        "step 1"
        event.current.chooseToUse({name:'sha'},function(card,player,target){
            if(player==target) return false;
            if(get.distance(player,target)<=1) return true;
            var players=game.filterPlayer();
            for(var i=0;i<players.length;i++){
                if(players[i]==player) continue;
                if(get.distance(player,players[i])<get.distance(player,target)) return false;
            }
            return true;
        })
        "step 2"
        if(result.bool==false) event.current.damage();
        if(event.current.next!=player){
            event.current=event.current.next;
            game.delay(0.5);
            event.goto(1);
        }
    },
                        ai:{
                            order:1,
                            result:{
                                player:function (player){
                if(player.num('h','shan')) return 1;
                var num=0,players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(players[i].canUse('sha',player)&&players[i].num('h')>1){
                        num--;
                    }
                    else{
                        num++;
                    }
                }
                return num;
            },
                            },
                        },
                    },
                    c:{
                        trigger:{
                            global:"gameDrawAfter",
                        },
                        forced:true,
                        content:function (){
                player.mark('齐');
                player.mark('楚');
                player.mark('燕');
                player.mark('韩');
                player.mark('赵');
                player.mark('魏');
            },
                    },
                    b:{
                        trigger:{
                            player:"dieBefore",
                        },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
                player.hp=player.maxHp;
                if(player.num('h')<player.maxHp){
                    player.draw(player.maxHp-player.num('h'));
                }
            },
                    },
                    a:{
                        trigger:{
                            global:"loseMaxHpBefore",
                        },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
            },
                    },
                },
            },
            "moon_24_a":{
                mod:{
                    targetInRange:function (card,player,target,now){
            if(card.name=='sha') return true;
        },
                    selectTarget:function (card,player,range){
            if(card.name=='sha'&&range[1]!=-1) range[1]=Infinity;
        },
                },
                init:function (player){
player.storage.moon_24_a=0
},
                trigger:{
                    source:"dieAfter",
                },
                forced:true,
                content:function (){
player.storage.moon_24_a++
if(player.storage.moon_24_a==1) player.unmark('韩')
if(player.storage.moon_24_a==2) player.unmark('赵')
if(player.storage.moon_24_a==3) player.unmark('魏')
if(player.storage.moon_24_a==4) player.unmark('楚')
if(player.storage.moon_24_a==5) player.unmark('燕')
if(player.storage.moon_24_a==6) player.unmark('齐')
if(player.storage.moon_24_a==7) player.mark('秦',{content:'德兼三皇，功过五帝',});
if(player.storage.moon_24_a<=6) player.gainMaxHp()
},
                group:"moon_24_a_1",
                subSkill:{
                    "1":{
                        trigger:{
                            player:"damageEnd",
                        },
                        forced:true,
                        unique:true,
                        filter:function (event,player){
        return event.source&&event.source.isIn()&&event.source!=player;
    },
                        content:function (){
                trigger.source.damage(trigger.num);
   },
                    },
                },
            },
            "_moon_24_a11":{
                trigger:{
                    player:"phaseDrawBegin",
                },
                forced:true,
                direct:true,
                priority:-100,
                filter:function (event,player){
return player.storage.moon_24_a>0
},
                content:function (){
trigger.num+=2;
},
            },
            "_moon_24_a12":{
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                filter:function (event,player){
return player.storage.moon_24_a>1
},
                content:function (){
player.recover();
},
            },
            "_moon_24_a13":{
                trigger:{
                    source:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
return player.storage.moon_24_a>2
},
                content:function (){
trigger.num++
},
            },
            "_moon_24_a14":{
                trigger:{
                    player:"phaseBegin",
                },
                direct:true,
                forced:true,
                filter:function (event,player){
return player.storage.moon_24_a>3
},
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('横扫六合',[list.trick,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=game.filterPlayer(function(current){
                    return lib.filter.filterTarget(card,player,current);
                });
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            player.useCard(event.card,result.targets);
        }
    },
                ai:{
                    threaten:1.5,
                },
            },
            "_moon_24_a15":{
                trigger:{
                    player:"phaseAfter",
                },
                forced:true,
                priority:-50,
                filter:function (event,player){
        return event.parent.name!='_moon_24_a15'&&player.storage.moon_24_a>4;
    },
                content:function (){
        player.draw();
        player.phase();
    },
                ai:{
                    threaten:1.8,
                },
            },
            "_moon_24_a16":{
                trigger:{
                    global:"phaseDrawAfter",
                },
                forced:true,
                check:function (event,player){
        return ai.get.attitude(player,event.player)<=0;
    },
                filter:function (event,player){
        return event.player&&player.storage.moon_24_a>5&&event.player.isAlive()&&event.player!=player;
    },
                content:function (){
        player.draw(2);
        player.recover();
        player.useCard({name:'juedou'},trigger.player);
    },
                ai:{
                    threaten:1.5,
                    expose:0.1,
                },
            },
            "moon_24_2":{
                trigger:{
                    player:"damageEnd",
                },
                forced:true,
                content:function (){
        "step 0"
        var players=get.players(player);
        players.remove(player);
        event.players=players;
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            var hs=current.get('h');
            if(hs.length){
                current.lose(hs)._triggered=null;
                current.$throw(hs);
            }
            else{
                current.damage();
            }
            game.delay(0.5);
            event.redo();
        }

    },
                group:["moon_24_2_a","moon_24_2_b"],
                subSkill:{
                    b:{
                        trigger:{
                            source:"damageEnd",
                        },
                        usable:1,
                        forced:true,
                        unique:true,
                        filter:function (event,player){
        return game.hasPlayer(function(current){
            return current!=player&&current.num('h');
        });
    },
                        content:function (){
        "step 0"
        var players=get.players(player);
        players.remove(player);
        event.players=players;
        player.line(players,'green');
        "step 1"
        if(event.players.length){
            var current=event.players.shift();
            var hs=current.get('h')
            if(hs.length){
                var card=hs.randomGet();
                player.gain(card,current);
                current.$giveAuto(card,player);
            }
            event.redo();
        }
    },
                    },
                    a:{
                        trigger:{
                            source:"damageBefore",
                        },
                        forced:true,
                        filter:function (event,player){
        return game.hasPlayer(function(current){
            return current.isEnemyOf(player)&&event.nature!='thunder'&&event.nature!='fire'&&event.num>=1&&!current.isLinked();
        });
    },
                        content:function (){
        "step 0"
        event.targets=game.filterPlayer();
        event.targets.sort(lib.sort.seat);
        "step 1"
        if(event.targets.length){
            var target=event.targets.shift();
            if(!target.isLinked()&&target.isEnemyOf(player)){
                player.line(target,'green');
                target.link();
            }
            event.redo();
        }
    },
                    },
                },
            },
            "moon_24_3":{
                trigger:{
                    global:"useCard",
                },
                forced:true,
                filter:function (event,player){
return event.player!=player;
},
                content:function (){
player.gain(trigger.cards)
},
                group:["moon_24_3_a","moon_24_3_b","moon_24_3_c"],
                subSkill:{
                    c:{
                        trigger:{
                            player:"damageEnd",
                        },
                        forced:true,
                        content:function (){
            player.recover();
            },
                    },
                    b:{
                        trigger:{
                            player:"dieBefore",
                        },
                        forced:true,
                        filter:function (event,player){
                return player.hp>=1;
            },
                        content:function (){
                trigger.untrigger();
                trigger.finish();
                player.hp=player.maxHp;
            },
                    },
                    a:{
                        trigger:{
                            player:["loseHpBefore","loseMaxHsBefore"],
                        },
                        forced:true,
                        content:function (){
                trigger.untrigger();
                trigger.finish();
            },
                    },
                },
            },
            "moon_24_b":{
                unique:true,
                trigger:{
                    source:"dieAfter",
                },
                direct:true,
                forced:true,
                init:function (player){
        player.storage.moon_24_b=[];
        // player.storage.moon_24_b2=0;
    },
                intro:{
                    content:"characters",
                },
                content:function (){
        'step 0'
        // if(player.storage.moon_24_b2<1){
        //     player.storage.moon_24_b2++;
        //     event.finish();
        // }
        // else{
        //     player.storage.moon_24_b2=0;
        // }
        'step 1'
        player.logSkill('moon_24_b');
        var list=[];
        var list2=[];
        var players=game.players.concat(game.dead);
        for(var i=0;i<players.length;i++){
            list2.add(players[i].name);
            list2.add(players[i].name1);
            list2.add(players[i].name2);
        }
        for(var i in lib.character){
            
            
            if(lib.character[i][4].contains('minskin')) continue;
            if(player.storage.moon_24_b.contains(i)) continue;
            if(list2.contains(i)) continue;
            list.push(i);
        }
        var name=list.randomGet();
        player.storage.moon_24_b.push(name);
        player.markSkill('moon_24_b');
        var skills=lib.character[name][3];
        for(var i=0;i<skills.length;i++){
            player.addSkill(skills[i]);
        }
        event.dialog=ui.create.dialog('<div class="text center">'+get.translation(player)+'发动了【天下兵戈】',[[name],'character']);
        game.delay(2);
        'step 2'
        event.dialog.close();
    },
            },
            "_moon_24_a17":{
                skillAnimation:true,
                animationStr:"王者，御天下之尊也",
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                filter:function (event,player){
return player.storage.moon_24_a>6&&!player.storage._moon_24_a17;
},
                content:function (){
    "step 0"
    player.storage._moon_24_a17=true;
    "step 1"
player.removeSkill('moon_24_1');
        player.addSkill('moon_24_2');
        player.addSkill('moon_24_3');
        player.recover(player.maxHp-player.hp);
},
            },
        },
        translate:{
            ubw:"无限剑制",
            "ubw_info":"无限剑制，当你体力发生变化时，获得等于变化数量的无限剑制标记，上限为六",
            "ubw2":"无限剑制",
            "ubw2_info":"无限剑制，出牌阶段，当你拥有六个无限剑制标记时发动，消耗所有无限剑制标记，获得六张杀且你在该回合没有使用牌的数量限制",
            "ubw3":"无限剑制",
            "ubw3_info":"无限剑制，你没有使用牌的数量限制",
            degula:"吸血",
            "degula_info":"每当你造成伤害，你回复等于你造成伤害值的体力",
            "degula2":"鲜血的传承",
            "degula2_info":"鲜血的传承，限定技，当你首次进入濒死状态时，你将体力恢复至上限进入潜行状态，并获得技能\"德古拉\"、\"吸血\"、\"不死\"",
            "degula3":"不死",
            "degula3_info":"锁定技，当你进入濒死状态时，你进行一次判定，若结果不为黑桃，你将体力回复至2并增加一点体力上限",
            "degula4":"德古拉",
            "degula4_info":"你可以将一张手牌当\"杀\"使用和打出",
            "moon_1_1":"柔能克剛",
            "moon_1_1_info":"柔能克刚，你在任何时候都视为装备有\"八卦阵\"，每当你发动该技能带来的八卦阵效果，你回复一点体力并摸两张牌",
            "moon_1_2":"光武之相",
            "moon_1_2_info":"光武之相，当你体力与体力上限下降时，你摸x张牌，其他所有角色流失x点体力，x为你下降的体力数的两倍",
            "moon_1_3":"天命攸帰",
            "moon_1_3_info":"天命攸帰EX，延时锦囊不能以你为目标，你使用牌无距离限制，当你受到属性伤害时，你防止之，并回复体力至上限",
            "moon_1_4":"火德星·昆阳赤霄",
            "moon_1_4_info":"火德星•昆阳赤霄，锁定技，你在造成非火焰伤害伤害后，回复一点体力并对敌方所有角色造成一点火焰伤害",
            "moon_2_1":"理解死亡",
            "moon_2_1_info":"当你首次进入濒死状态发动，将体力上限变更为五，回复体力至上限进入潜行状态并获得五点护甲，获得技能\"死线\"\"死点\"",
            "moon_2_2":"死线",
            "moon_2_2_info":"你对目标造成的伤害效果改为扣除目标一点体力上限",
            "moon_2_3":"死点",
            "moon_2_3_info":"出牌阶段对攻击距离内目标使用，使目标失去全部体力上限，之后失去技能\"死点\"",
            "moon_3_1":"根源之怪",
            "moon_3_1_info":"根源之怪，你使用牌无数量限制，你没有攻击距离的限制，你的回合开始阶段，进行一次判定，黑桃，你获得技能\"直死\"，梅花，获得技能\"死点\"，红桃，回复体力至上限，方片，摸4张牌，其他角色回合开始前你可进行一个额外回合",
            "moon_3_2":"直死",
            "moon_3_2_info":"出牌阶段，选择一名其他角色，使其直接死亡，之后失去技能\"直死\"",
            "moon_3_3":"根源之涡",
            "moon_3_3_info":"根源之涡，锁定技，每当有一名角色死亡，你将体力回复至体力上限",
            "moon_4_1":"双腕·零次集束",
            "moon_4_1_info":"双腕·零次集束，限定技，出牌阶段使用，弃置其他所有角色的所有手牌，无手牌的角色流失一点体力",
            "moon_4_2":"神裁",
            "moon_4_2_info":"出牌阶段限一次，将其他所有角色横置，如果你处于横置状态，则恢复之",
            "moon_4_3":"启示",
            "moon_4_3_info":"摸牌阶段前，回合结束后，你各获得两张牌",
            "moon_4_4":"洗礼",
            "moon_4_4_info":"濒死状态发动，回复体力至上限进入潜行状态并摸五张牌，之后失去技能\"洗礼\"",
            "moon_5_1":"此世无存的幻马",
            "moon_5_1_info":"此世无存的幻马，出牌阶段限一次，你可以移动到任意一名角色的前一位，视为对其使用了一张不计入出杀次数的杀",
            "moon_5_2":"疯狂之月",
            "moon_5_2_info":"疯狂之月，锁定技，每当一名其他角色对你造成伤害，该角色进入混乱状态直到当前回合结束；回合开始阶段，若上轮有至少两名不同角色因你而进入混乱状态，你回复全部体力并进入混乱状态进到本回合结束",
            "moon_5_3":"理性蒸发",
            "moon_5_3_info":"理性蒸发，锁定技，你不能使用锦囊牌，但你可以将一张锦囊牌当\"杀\"使用和打出，你没有使用\"杀\"的数量限制",
            "moon_5_4":"破却宣言",
            "moon_5_4_info":"破却宣言，锁定技，你使用的非延时类锦囊牌不能被无懈可击响应；你不能成为其他角色的延时类锦囊的目标，你可以将任意一张手牌当\"无懈可击\"使用",
            "moon_5_5":"月之狂气",
            "moon_5_5_info":"月之狂气，回合开始前判定，红色，你获得技能\"破却宣言\"失去\"理性蒸发\"，黑色，你获得技能\"理性蒸发\"失去\"破却宣言\"",
            "moon_5_6":"触碰即摔",
            "moon_5_6_info":"触碰即摔，每当一名其他角色在你回合内失去最后一张手牌，你可以对其造成一点伤害",
            "moon_6_1":"圈境",
            "moon_6_1_info":"你没有弃牌阶段，其他角色的卡不能以你为目标",
            "moon_6_2":"中华武术",
            "moon_6_2_info":"中华武术，你的\"杀\"强制命中，当你第一次使用\"杀\"之后，你失去技能\"圈境\"",
            "moon_6_3":"无二打",
            "moon_6_3_info":"无二打，出牌阶段使用，限你的体力为一时使用，限对攻击范围内目标使用，对目标造成等于其当前体力值减一的伤害",
            "moon_7_1":"尼伯龙根之歌",
            "moon_7_1_info":"尼伯龙根之歌，回合开始阶段判定，红色，获得技能\"正血铠\"失去技能\"反血铠\",体力回复一点，黑色，获得技能\"反血铠\"，失去技能\"正血铠\"",
            "moon_7_2":"正血铠",
            "moon_7_2_info":"正血铠，你的体力与上限不会减少",
            "moon_7_3":"反血铠",
            "moon_7_3_info":"反血铠，回合结束阶段你流失一点体力",
            "moon_7_4":"重整旗鼓",
            "moon_7_4_info":"重整旗鼓，当你濒死时，血量恢复至上限，扣除一点体力上限，并立刻开始你的回合",
            "moon_7_5":"黄金律",
            "moon_7_5_info":"黄金律，你的手牌数始终不小于五",
            "moon_7_6":"屠龙者",
            "moon_7_6_info":"屠龙者，你使用牌无距离及数量限制，当有角色死亡时，你增加一点体力上限并回复一点体力",
            "moon_8_1":"破魔的红蔷薇",
            "moon_8_1_info":"当你使用【杀】指定一名角色为目标后，你可以进行一次判定并令该角色的非锁定技失效直到回合结束，除非该角色弃置一张与判定结果花色相同的牌，否则不能使用【闪】抵消此【杀】。",
            "moon_8_3":"心眼",
            "moon_8_3_info":"你可以将[杀]当[闪]，或[闪]当[杀]使用或打出，你没有出［杀］的次数限制",
            "moon_8_4":"必灭的黄蔷薇",
            "moon_8_4_info":"你对目标造成的伤害效果可以改为扣除目标一点体力上限",
            "moon_8_5":"幸运E",
            "moon_8_5_info":"幸运e，锁定技，回合开始阶段，若场上没有闪电且你手牌中有黑桃牌，你将牌堆中的一张闪电置于你的判定区",
            "moon_9_1":"投影",
            "moon_9_1_info":"出牌阶段限，你可以消耗一个无限剑制标记，选择随机六个技能中的一个作为你的技能",
            "moon_9_2":"鹰眼",
            "moon_9_2_info":"你和其他角色的距离始终默认为1",
            "moon_9_3":"幻想崩坏",
            "moon_9_3_info":"幻想崩坏，出牌阶段限一次，消耗一枚无限剑制标记，对所有敌方造成一点火焰伤害",
            "moon_10_1":"固有时制御",
            "moon_10_1_info":"固有时制御，锁定技，回合结束后，你进行一个额外的回合",
            "moon_10_2":"起源弹",
            "moon_10_2_info":"起源弹，当你使用了\"杀\"后，你可以弃置一张牌，指定一个目标使其全部技能失效，如果其技能已经失效则扣除其一点体力上限并翻面",
            "moon_10_3":"暗杀",
            "moon_10_3_info":"准备阶段，你可以选择一名敌方角色，若如此做，视为对其使用了一张[杀]，之后你将武将牌翻面，你在翻面状态下防止任何伤害",
            "moon_10_4":"暗杀",
            "moon_10_4_info":"翻面状态下防止任何伤害",
            "moon_11_1":"极刑王",
            "moon_11_1_info":"极刑王，你的\"杀\"可以指定任意目标",
            "moon_11_2":"护国之鬼将",
            "moon_11_2_info":"护国之鬼将，锁定技，你使用的任何卡牌无数量及距离限制；当你于回合内重复使用同名卡牌时，你失去一点体力并增加一点体力上限",
            "moon_12_1":"情报抹消",
            "moon_12_1_info":"情报抹消，你在翻面状态下防止任何伤害",
            "moon_12_2":"解体圣母",
            "moon_12_2_info":"解体圣母，出牌阶段限一次，限目标为已翻面的女性，将目标致死,之后你将武将牌翻至背面",
            "moon_12_3":"暗黑雾都",
            "moon_12_3_info":"暗黑雾都，限定技，出牌阶段使用，将其他全部角色翻面",
            "moon_12_4":"外科手术",
            "moon_12_4_info":"外科手术，每当场上有角色死亡，你回复一点体力",
            "moon_12_5":"雾夜杀人",
            "moon_12_5_info":"锁定技，每当你对一名其他角色造成一次伤害，受伤害角色与你各将武将牌翻面",
            "moon_13_1":"圆桌拘束",
            "moon_13_1_info":"每当你使用或打出一张牌，你解除一层圆桌拘束，获得一枚圆桌拘束标记，上限为十三",
            "moon_13_2":"誓约胜利之剑",
            "moon_13_2_info":"誓约胜利之剑，出牌阶段，消耗十三枚圆桌拘束标记发动，给目标造成等于其当前体力上限的伤害并致死",
            "moon_13_3":"风王铁鎚",
            "moon_13_3_info":"风王铁鎚，出牌阶段限一次，你回复一点体力，并对所有敌人造成一点雷电伤害",
            "moon_14_1":"贤者之石",
            "moon_14_1_info":"贤者之石，出牌阶段限一次，令一名角色复活，然后该角色将手牌补至体力上限，并获得技能\"不死\"",
            "moon_14_2":"元素",
            "moon_14_2_info":"你防止受到的属性伤害，改为回复相应数值的体力",
            "moon_14_3":"元素使的魔剑",
            "moon_14_3_info":"元素使的魔剑，准备阶段，你可以对一名其他角色造成1点雷电伤害",
            "moon_14_4":"道具炼成",
            "moon_14_4_info":"道具炼成，出牌阶段三次，当你需要使用或打出一张基本牌或非延时锦囊牌时，你可以声明之，然后亮出牌堆顶的一张牌，并将此牌当你所述之牌使用或打出，若其与你所述之牌不为同一类别，你须先失去1点体力。若回合外你须使用除桃以外的牌时，也可以如此",
            "moon_15_1":"王之财宝",
            "moon_15_1_info":"王之财宝，出牌阶段，你可以弃置至少一张武器牌，对目标造成你弃置武器牌数量的伤害，当你体力回复与流失时，你摸一张牌。每回合限五次，当你失去牌后，你从牌堆或弃牌堆获得一张武器牌并回复一点体力",
            "moon_15_2":"天地乖离开辟之星",
            "moon_15_2_info":"天地乖离开辟之星，锁定技，回合结束阶段，若你已受伤，你对敌方所有角色造成三点雷电伤害",
            "moon_15_3":"天之锁",
            "moon_15_3_info":"天之锁，出牌阶段限一次，你可以弃置一张牌并指定一名角色，该角色在该回合无法打出手牌",
            "moon_15_4":"天之锁",
            "moon_15_4_info":"",
            "moon_15_5":"全知全能之星",
            "moon_15_5_info":"全知全能之星，结束阶段，你可以视为使用任意一张通常锦囊牌",
            "moon_15_6":"维摩那",
            "moon_15_6_info":"维摩那，你和其他角色的距离始终默认为1",
            "moon_15_7":"神性",
            "moon_15_7_info":"限定技，当你处于濒死状态发动，回复体力至上限进入潜行状态",
            "moon_16_1":"日轮啊，化作甲胄",
            "moon_16_1_info":"日轮啊，化作甲胄，游戏开始前，你获得∞点护甲，你的体力不会流失，体力上限不会被扣除，你不会被即死",
            "moon_16_2":"日轮啊，顺从死亡",
            "moon_16_2_info":"日轮啊，顺从死亡，出牌阶段，你可以选择一个目标，以消失所有护甲值为代价，对目标造成等同于你护甲值的伤害，之后你失去该技能和日轮啊，化作甲胄的效果",
            "moon_16_3":"无冠之武艺",
            "moon_16_3_info":"无冠之武艺，准备阶段，你可以弃置一张牌并选择一名角色，获得其所有技能，直到你首次受到伤害",
            "moon_16_4":"无冠之武艺",
            "moon_16_4_info":"",
            "moon_16_5":"贫者之见识",
            "moon_16_5_info":"贫者之见识，你可以将你的任意一张手牌当“无懈可击”使用",
            "moon_16_6":"梵天啊，诅咒我身",
            "moon_16_6_info":"梵天啊，诅咒我身，结束阶段，对一名其他角色造成2点火焰伤害",
            "moon_17_1":"境界にて",
            "moon_17_1_info":"境界にて，锁定技，延时锦囊不能以你为目标，你使用牌无距离限制，你不会被翻面，你的体力不会流失，你的体力上限不会下降，你不会被即死，当你受到大于你当前体力的伤害时，将此伤害改为一点，每当你造成伤害时，封印对方非锁定技直到其回合结束，并且有10%的概率将被伤害目标即死",
            "moon_17_1_1":"境界にて",
            "moon_17_1_1_info":"",
            "moon_17_2":"晚钟",
            "moon_17_2_info":"锁定技，你的杀有90%概率强制命中，有60%概率追加一点伤害，造成伤害后30%概率被伤害目标失去一点体力上限（效果可重复触发），当你使用杀后，你在该回合的出杀次数+1并摸一张牌，回合开始阶段，你获得一张杀，当你受到伤害时，你摸两张牌，并视为对伤害来源使用了一张杀",
            "moon_17_2_1":"晚钟",
            "moon_17_2_1_info":"",
            "moon_17_2_2":"晚钟",
            "moon_17_2_2_info":"",
            "moon_17_2_3":"晚钟",
            "moon_17_2_3_info":"",
            "moon_17_3":"战斗续行",
            "moon_17_3_info":"战斗续行，限定技，当你处于濒死状态发动，回复体力至上限进入潜行状态，重置技能“死告天使”",
            "moon_17_4":"信仰的加护",
            "moon_17_4_info":"信仰的加护，锁定技，当你受到伤害时，70%概率防止之并摸两张牌，70%概率回复等于受到的伤害的体力并获得等量护甲",
            "moon_17_4_1":"信仰的加护",
            "moon_17_4_1_info":"",
            "moon_17_5":"死告天使",
            "moon_17_5_info":"死告天使，出牌阶段对单个目标使用，造成∞点伤害并即死，之后失去该技能",
            "moon_17_2_4":"晚钟",
            "moon_17_2_4_info":"",
            "moon_17_2_5":"晚钟",
            "moon_17_2_5_info":"",
            "moon_17_1_2":"境界にて",
            "moon_17_1_2_info":"",
            "moon_17_1_3":"境界にて",
            "moon_17_1_3_info":"",
            "moon_18_1":"破坏神的振臂",
            "moon_18_1_info":"破坏神的振臂，其他角色于每回合的开始阶段有10%的概率即死",
            "moon_18_2":"千里眼",
            "moon_18_2_info":"千里眼，锁定技，你使用牌无距离限制，你的杀有60%概率强制命中",
            "moon_18_3":"天授的英雄",
            "moon_18_3_info":"天授的英雄，锁定技，结束阶段，你回复一点体力，并对所有敌人造成一点雷电伤害",
            "moon_18_4":"魔力放出•炎",
            "moon_18_4_info":"魔力放出•炎，锁定技，你防止即将受到的火焰伤害改为回复一点体力，你造成火焰伤害时可以回复一点体力，你造成的任何伤害有40%的概率追加一点火焰伤害，该效果可连续触发",
            "moon_18_4_1":"魔力放出•炎",
            "moon_18_4_1_info":"",
            "moon_18_5":"炎神的咆哮",
            "moon_18_5_info":"炎神的咆哮，锁定技，当你受到伤害时，对一名其他角色造成一点火焰伤害",
            "moon_18_4_2":"魔力放出•炎",
            "moon_18_4_2_info":"",
            "moon_16_1_1":"日轮啊，化作甲胄",
            "moon_16_1_1_info":"",
            "moon_16_1_2":"日轮啊，化作甲胄",
            "moon_16_1_2_info":"",
            "moon_19_1":"气息遮断",
            "moon_19_1_info":"气息遮断，你在你的回合开始后将武将牌翻至背面，场上一名其他角色的回合开始前，你将武将牌翻至正面，摸一张牌并进行一个额外回合。若如此做，当有角色受到伤害后，你可以将你的牌重置为上次发动气息遮断时的状态，若你的牌数因此而减少，你回复一点体力，你在翻面状态下防止受到伤害、体力流失、体力上限扣除、即死",
            "moon_19_1_1":"气息遮断",
            "moon_19_1_1_info":"",
            "moon_19_1_2":"气息遮断",
            "moon_19_1_2_info":"",
            "moon_19_1_3":"气息遮断",
            "moon_19_1_3_info":"",
            "moon_19_1_4":"气息遮断",
            "moon_19_1_4_info":"",
            "moon_19_2":"狂信",
            "moon_19_2_info":"锁定技，你使用牌无距离及数量限制，你使用的通常锦囊牌不能被无懈可击响应，你防止其他角色的体力回复，你不能成为其他角色的延时类锦囊的目标",
            "moon_19_3":"妄想心音",
            "moon_19_3_info":"妄想心音，出牌阶段对其他角色使用，该角色死亡，你将体力回复至上限",
            "moon_19_4":"空想电脑",
            "moon_19_4_info":"空想电脑，你将造成的伤害其目标须先流失一点体力，然后该伤害之来源会被视为被伤害目标",
            "moon_19_5":"妄想毒身",
            "moon_19_5_info":"妄想毒身，锁定技，每当你受到一次伤害，伤害来源流失全部体力",
            "moon_19_6":"梦想髓音",
            "moon_19_6_info":"梦想髓音，结束阶段，令一名其他角色进入混乱状态，然后回复一点体力",
            "moon_19_7":"狂想闪影",
            "moon_19_7_info":"狂想闪影，每当一名其他角色在你回合内失去最后一张手牌，你可以对其造成一点伤害",
            "moon_19_8":"冥想神经",
            "moon_19_8_info":"冥想神经，锁定技，每当其他角色受到伤害，其须将武将牌翻至背面",
            "moon_19_9":"断想体温",
            "moon_19_9_info":"断想体温，你受到的伤害至多为一",
            "moon_19_10":"幻想血统",
            "moon_19_10_info":"觉醒技，当你于游戏内第一次回合开始时，你获得技能：妄想心音、空想电脑、妄想毒身、梦想髓音、狂想闪影、冥想神经、断想体温",
            "moon_20_1":"魅惑的美声",
            "moon_20_1_info":"魅惑的美声，出牌阶段限一次，你可以指定一名男性角色，获得其全部手牌与技能",
            "moon_20_2":"貌美的公主",
            "moon_20_2_info":"貌美的公主，每当你成为其他角色的卡牌的目标时，你可以下降一点体力并让其流失一点体力后取消之。每当你于受伤，体力流失，体力上限扣除之前，你防止之，改为下降一点体力，如果你有手牌，则上升一点体力",
            "moon_20_3":"神的恩宠",
            "moon_20_3_info":"神的恩宠，开始阶段，你获得一点护甲并上升一点体力",
            "moon_20_4":"愿荣光存于百合王冠",
            "moon_20_4_info":"愿荣光存于百合王冠，锁定技，回合开始前，你从其他每个角色处获得一张手牌",
            "moon_21_1":"流电学",
            "moon_21_1_info":"流电学，锁定技，在你造成非雷电伤害之前，你令所有未连环的敌方角色连环，在你造成非雷电伤害之后，你选定一名目标使其受到一点雷电伤害，你防止受到的属性伤害，改为回复相应的体力，你不会被连环，当你受到伤害于体力流失后，你可以选择一名目标使其受到一点伤害",
            "moon_21_1_1":"流电学",
            "moon_21_1_1_info":"",
            "moon_21_1_2":"流电学",
            "moon_21_1_2_info":"",
            "moon_21_2":"天赋的睿智",
            "moon_21_2_info":"天赋的睿智，开始阶段，你可以选择一名角色，使其获得随机一个技能，当你受到伤害与体力流失后，你有80%的概率回复与伤害数相应的体力，你的杀有80%概率伤害+1",
            "moon_21_2_1":"天赋的睿智",
            "moon_21_2_1_info":"",
            "moon_21_2_2":"天赋的睿智",
            "moon_21_2_2_info":"",
            "moon_21_3":"星之开拓者",
            "moon_21_3_info":"星之开拓者，摸牌阶段结束后，你摸两张牌并上升一点体力，将其他所有角色连环",
            "moon_21_4":"人类神话•雷电降临",
            "moon_21_4_info":"人类神话•雷电降临，觉醒技，当你体力第一次发生变化时，回复体力至上限，并立刻开始你的回合，之后该技能效果发生变更，技能“流电学”的描述中将连环条件中的非雷电伤害解禁",
            "moon_21_4_1":"人类神话•雷电降临",
            "moon_21_4_1_info":"人类神话•雷电降临，出牌阶段限一次，对指定目标造成三点伤害（可触发流电学）",
            "moon_21_1_3":"流电学",
            "moon_21_1_3_info":"流电学，连环条件中雷电伤害解禁",
            "moon_21_1_4":"流电学",
            "moon_21_1_4_info":"",
            "moon_21_1_5":"流电学",
            "moon_21_1_5_info":"",
            "moon_15_8":"王怒",
            "moon_15_8_info":"当你受到伤害时，其他全部角色弃置所有牌，没有手牌则受到一点伤害，该过程不会触发技能",
            "moon_15_5_1":"全知全能之星",
            "moon_15_5_1_info":"",
            "moon_22_1":"空想具现化",
            "moon_22_1_info":"空想具现化，出牌阶段使用，你视为使用了一张合理的特殊类卡牌，除你以外的角色在造成伤害前，你视为使用了一张通常锦囊，回合开始时，你获得一张宝物牌，你可以装备任意张宝物牌",
            "moon_22_1_1":"空想具现化",
            "moon_22_1_1_info":"",
            "moon_22_1_2":"空想具现化",
            "moon_22_1_2_info":"",
            "moon_22_1_3":"空想具现化",
            "moon_22_1_3_info":"",
            "moon_xuming":"黑框眼镜",
            "moon_xuming_info":"锁定技，任何角色的开始阶段，你增加一点体力上限并回复一点体力，然后令一名随机角色失去一点体力上限。在你死亡之前，你防止之，并将一名随机角色当前的体力上限、体力、技能、手牌移动到你的武将牌上，该效果在第一次发动之后失效，你不会被即死",
            "moon_22_2":"魅惑之魔眼",
            "moon_22_2_info":"锁定技，每当一名其他角色对你造成伤害，你令该角色迷乱直到其回合结束。限定技，出牌阶段，你指定一名角色使其永久迷乱",
            "moon_22_2_1":"迷乱",
            "moon_22_2_1_info":"锁定技，你所造成的伤害均改为等值的体力回复，你所受到的体力回复均改为等值的体力流失，当你受到伤害时，你额外扣除一点体力上限，结束阶段，你流失一点体力",
            "moon_22_3":"真祖",
            "moon_22_3_info":"锁定技，若你受到的伤害大于等于五，则你的体力变为五点，并重置技能魅惑之魔眼，将其迷乱效果全部改为永久，此后你受到的伤害至多为一，你不会被即死。",
            "moon_22_3_1":"真祖",
            "moon_22_3_1_info":"你受到的伤害至多为1<br>你与其他角色计算距离始终为1<br>你免疫体力流失伤害",
            "moon_22_2_2":"魅惑之魔眼",
            "moon_22_2_2_info":"锁定技，每当一名其他角色对你造成伤害，你令该角色永久迷乱。限定技，出牌阶段，你指定一名角色使其永久迷乱",
            "moon_e5":"收藏家",
            "moon_e5_info":"",
            "moon_23_1":"啮碎死牙之兽",
            "moon_23_1_info":"啮碎死牙之兽，锁定技，在你受到伤害之后，伤害来源受到1+x点反伤（x等于你已损失的体力值）在你造成伤害时，被伤害角色的上、下家流失与伤害数值相同的体力（不包括你）你防止体力流失与体力上限扣除，你使用牌无距离限制",
            "moon_23_2":"精灵的狂骚",
            "moon_23_2_info":"精灵的狂骚，锁定技，你在每回合所受到的第一次伤害减一，你为除你以外的所有角色受到伤害时的伤害来源，其他角色死亡之前，你使其失去全部技能",
            "moon_23_3":"避矢的加护",
            "moon_23_3_info":"避矢的加护，锁定技，你防止受到超过最低致死攻击数值的伤害",
            "moon_23_4":"战斗续行",
            "moon_23_4_info":"战斗续行，限定技，濒死状态发动，回复体力至上限进入潜行状态，之后失去技能“啮碎死牙之兽”，获得技能“胆识”、“剜穿鏖杀之枪”",
            "moon_23_5":"胆识",
            "moon_23_5_info":"锁定技，你使用牌无数量限制，你不会受到不等于一的伤害，你将受到的属性伤害改为回复等数值的体力，你免疫体力流失与上限扣除，结束阶段，你可以选择一名敌方角色，若如此做，视为对其使用了一张“杀”",
            "moon_23_6":"剜穿鏖杀之枪",
            "moon_23_6_info":"剜穿鏖杀之枪，锁定技，你的杀强制命中，你于开始阶段获得一张“杀”，你造成伤害后回复体力至上限并对被伤害角色造成无限追加伤害，在你获得该技能后第一次进入濒死时，你失去该技能并重新获得技能“啮碎死牙之兽”，并将体力回复至上限进入潜行状态",
            "moon_24_1":"诸侯之乱",
            "moon_24_1_info":"〖诸侯之乱〗「锁定技」『效果一』：游戏开始前，你获得齐、楚、燕、韩、赵、魏六国的标记。『效果二』：你不会死亡，你在濒死阶段将体力回复至上限并将手牌补充至体力上限。『效果三』：其他角色在死亡后立即复活并将手牌补至上限。『效果四』：场上所有角色免疫体力上限扣除。『效果五』所有角色在其结束阶段须向可攻击的目标使用一张杀，否则其会受到一点来自于你的伤害",
            "moon_24_a":"横扫六合",
            "moon_24_a_info":"〖横扫六合〗『效果一』「锁定技」每当你击杀一名角色时，你按照韩、赵、魏、楚、燕、齐的顺序依次移除六国标记，上升一点体力上限，并获得不同效果。『韩』摸牌阶段多摸两张牌。『赵』回合结束阶段回复一点体力。『魏』造成的伤害+1。『楚』准备阶段视为使用了一张通常锦囊。『燕』回合结束后，摸一张牌并进行一个额外回合。『齐』其他角色的摸牌阶段后，你摸两张牌视为对其发起了【决斗】。当你累计击杀七次后，你获得标记『秦』。『秦』觉醒技，回合开始阶段，回复体力至上限，失去技能【诸侯之乱】获得技能【威震八荒】【帝业祖龙】。『效果二』你的杀可以指定任意名目标。『效果三』受到伤害后对伤害来源造成等量反伤",
            "_moon_24_a11":"横扫六合•韩",
            "_moon_24_a11_info":"摸牌阶段摸牌数加二",
            "_moon_24_a12":"横扫六合•赵",
            "_moon_24_a12_info":"结束阶段回复一点体力",
            "_moon_24_a13":"横扫六合•魏",
            "_moon_24_a13_info":"造成的伤害加一",
            "_moon_24_a14":"横扫六合•楚",
            "_moon_24_a14_info":"准备阶段，你可以视为使用任意一张普通锦囊牌",
            "_moon_24_a15":"横扫六合•燕",
            "_moon_24_a15_info":"锁定技，回合结束后，你摸一张牌进行一个额外的回合",
            "_moon_24_a16":"横扫六合•齐",
            "_moon_24_a16_info":"其他角色摸牌阶段结束后，你回复一点体力并摸两张牌，视为对其发起了【决斗】",
            "moon_24_2":"威震八荒",
            "moon_24_2_info":"〖威震八荒〗「锁定技」『一』当你受到伤害时，其他全部角色弃置所有牌，没有手牌则受到一点伤害。『二』在你造成非雷火伤害前，将敌方全部连横。『三』每回合第一次造成伤害后，从其他角色处各获得一张牌",
            "moon_24_3":"帝业祖龙",
            "moon_24_3_info":"〖帝业祖龙〗『一』你可以获得其他角色所使用的牌。『二』免疫体力流失与上限扣除。『三』防止即死，并将体力回复至上限。『四』受到伤害后回复一点体力",
            "moon_24_b":"天下兵戈",
            "moon_24_b_info":"〖天下兵戈〗「锁定技」你每击杀一名角色，可以获得一名随机武将的全部技能",
            "_moon_24_a17":"横扫六合•秦",
            "_moon_24_a17_info":"王者，御天下之尊也",
        },
    },
},files:{"character":["moon_24.jpg"],"card":["moon_xuming.jpg"],"skill":[]}})