game.import("extension",function(lib,game,ui,get,ai,_status){return {name:"新武将",content:function (config,pack){
    
},precontent:function (){
    
},help:{},config:{},package:{
    character:{
        character:{
            "漩涡长门":["male","shen",3,["tianzheng","tianyin","baoxing","lunhui"],["des:漩涡长门，漩涡一族后裔，忍界大战时的孤儿，后被自来也收为徒弟，早期与弥彦等人创立晓组织，六道佩恩的实际操控者，实力恐怖。先后杀了自来也、卡卡西等人，以一己之力毁了木叶，与鸣人一战，终被鸣人说服，发动轮回天生之术令死去的木叶忍者复活后死去。后来又被兜用秽土转生之术复活，最终被宇智波鼬的十拳剑封印"]],
            "南蛮王":["male","qun",1,["xiongqi","xiangfu","蛮王"],["des:七擒七纵之孟获"]],
            "姜伯约":["male","shu",4,["tiaoxin_jiangwei","guanxing_jiangwei"],["des:诸葛亮弟子"]],
            new:["male","qun",4,["liangji","jugong","chengmou"],["des:貂蝉的义父，详看百度百科"]],
            itachi:["male","shen",3,["yuedu","retianzhao","xuzuo"],["des:宇智波鼬，木叶村宇智波一族的天才忍者，7岁忍校毕业，13岁当上暗部队长，忍术高超，擅长手里剑。宇智波一族少数开了万花筒写轮眼的人，左眼月读，能瞬间让对手陷入鼬控制的幻术之中，包括时间、空间、质量，让其受到极重的精神攻击，属精神攻击类幻术。右眼天照，聚焦即发出能烧毁一切的黑色火焰，烧毁目标前永不熄灭。双眼须佐能乎，拥有极强的攻击与防御力。少年鼬是名双重间谍，为了村子，在宇智波一族叛变木叶前选择灭族，后逃离加入并暗中调查晓组织。后与其弟佐助决战而死，佐助因此开了万花筒写轮眼。第4次忍界大战被兜用秽土转生术复活，然后与鸣人相遇发动最强幻术“别天神”，摆脱控制，与兜一战，发动禁术“伊邪那美”，让兜陷入循环的幻术中。"]],
            "波风水门":["male","shen",3,["luoxuan","shanjie","refengyin"],["des:波风水门，四代目火影，鸣人的父亲，木叶村的英雄，天才忍者，外号“黄色闪光”，年纪轻轻便当上火影。自创忍术螺旋丸，凝聚查克拉无需结印即可发动。改良二代火影的“飞雷神”之术，只需在目标地留下术式，便能在术式之间瞬间移动或转移物体，速度极快，千里之外取人首级只在须臾之间，瞬间又遁迹千里之外，来无影去无踪，敌皆闻风丧胆，遇见可放弃任务，只管逃跑，曾在忍界大战以一己之力秒杀对方五十名上忍，名声由此大震。鸣人出生当晚，被宇智波带土掳走妻子，放出九尾狐，后发动禁术“尸鬼封尽”、“八卦封印”将九尾封印进鸣人体内后死去。第四次忍界大战中被大蛇丸切开“死神”腹部，释放出灵魂，然后用秽土转生术复活，后参与对抗宇智波带土和宇智波斑的战斗，发动短暂的仙人模式和九尾模式，帮助鸣人。。。"]],
            "漩涡鸣人":["male","shen",3,["fenshen","xianshu"],["des:漩涡鸣人，《火影忍者》系列的主角。火之国木叶忍村的忍者，四代目火影波风水门和漩涡玖辛奈之子，六道仙人次子阿修罗转世。刚出生时父母为保护村子而牺牲，并将强大的尾兽“九尾”封印于鸣人体内。成为孤儿的鸣人在孤独中长大，但在唯一认同他的老师海野伊鲁卡以及三代目火影鼓励下逐渐决心要成为火影，让所有人都认同他的存在。成为忍者后，同旗木卡卡西、宇智波佐助和春野樱组成第七班进行各种任务。 为实现理想，和守护伙伴们的羁绊，鸣人不断修炼，作为木叶“三忍”之一自来也的弟子，学会了父亲的忍术螺旋丸，后将之升级，加入风遁属性，练成威力强大的风遁手里剑，曾以此秒杀晓组织的高手角都；又练就仙术打败佩恩六道，拯救木叶；后又在众人帮助下练成“九尾模式”，移动速度惊人，尤如“金色闪光”再世，后先后与秽土转生的众高手、六道宇智波带土、六道宇智波斑、大筒木辉夜战斗，最后与包括九尾在内的伙伴们一同终结了战争，与佐助决斗，最终感化了佐助，为纷争不断的忍者世界带来和平，并实现自己成为火影和忍界英雄的梦想"]],
            "我爱罗":["male","shen",3,["shazang","juefang"],["des:我爱罗，《火影忍者》系列中的人物。风之国·砂隐村的第五代风影。擅长控制沙，沙子形成绝对防御和绝招沙暴大（送）葬，拥有攻防一体的实力。小时候由于体内封印着一尾守鹤而被村人恐惧，又因为至亲之人的背叛而一度变得冷酷无情、喜好杀戮，但在和漩涡鸣人一战后，由于鸣人的影响而逐渐摆脱心魔。之后我爱罗成为第五代风影，领导并守护着砂隐村，但一度被“晓”抽去了一尾守鹤，失去生命，最后被千代牺牲生命复活。第四次忍界大战中，我爱罗担任忍界联军联队长与第四部队统领，并得知绝对防御是来自母亲守护他的意志使然和父亲的真相，一度哽咽。曾联手其他四影对战宇智波斑，但均被打败。战争落幕后，我爱罗仍持续担任风影的职位，还和鸣人及木叶村等维持着友好的关系。"]],
            "佐助":["male","shen",3,["yandun","qianniao","rexuzuo"],["des:宇智波佐助，《火影忍者》男二号。火之国木叶隐村宇智波一族的天才忍者，六道仙人长子因陀罗的转世。 年幼时目睹宇智波一族被哥哥宇智波鼬所灭，从而走上复仇之路。在终结谷与漩涡鸣人大战一场后叛离村子并追随大蛇丸。三年后，佐助吸收了大蛇丸的力量并成功向鼬复仇，但在此之后却被宇智波带土告知了灭族的真相，万花筒写轮眼开眼，进而决定摧毁木叶。曾先后与迪达拉、八尾奇拉比对战，大闹五影会议后又与雷影、团藏对战，实力得到提升。后来，佐助与秽土转生的鼬重逢，合力打败兜，想法再次发生了变化，为了进一步了解忍者、家族、哥哥的过去，佐助与秽土转生的历代火影进行了对话，在听完其回答后决定继承鼬的意志守护木叶，并期望成为火影改变现有的忍者世界体制。 第四次忍界大战结束后，佐助因对于维护世界和平的道路选择和鸣人不同，而在终结之谷与鸣人进行了宿命之战，结果两人各断一条手臂。最终佐助被鸣人感动，认同了鸣人的道路，并重新成为木叶的一员。 此后佐助独自一人游历世界，继承鼬的意志，甘做一个无名忍者，在身后默默守护木叶及忍者世界。 "]],
            "带土":["male","shen",3,["xishou","reshenwei","xianyan"],["des:宇智波带土，《火影忍者》中中期的反派角色，面具男的真实身份。火之国木叶村的宇智波一族成员，四代火影的弟子，卡卡西的队友，擅长时空间忍术“神威”、宇智波禁术、阴阳遁术等。其送给卡卡西的左眼能远距离扭曲空间转移物体，自身右眼能转移自身，实现吸收物体、身体虚化。神无毗桥之战重伤濒死，将左眼和守护暗恋的女孩野原琳的愿望一同托付给于挚友旗木卡卡西。后在一族原首领宇智波斑的阴谋下，带土目睹了野原琳死亡后痛不欲生，写轮眼直接从双勾玉开启至万花筒写轮眼，否认世界，从此走上黑暗之路，成为“晓”的实际操纵者，曾在鸣人出生当天，放出九尾，袭击木叶村，并害死四代火影夫妇，后协助宇智波鼬的灭族行动，并和药师兜发动了第四次忍界大战，更成为世间第二位十尾人柱力。 在第四次忍界大战中与漩涡鸣人的战斗中被逐渐感化，想起并渴望重拾曾经保护同伴的梦想。后帮助第七班的成员与大筒木辉夜进行了异空间对决，在替鸣人和卡卡西挡下了辉夜的共杀灰骨后牺牲，但剩下的查克拉仍在最后的时刻帮助卡卡西发动完全体须佐能乎，帮助第七班他们战胜了大筒木辉夜。最终在将最后的写轮眼托付给卡卡西后，没有遗憾地和小琳前往了另一个世界。"]],
            "日向雏田":["female","shen",3,["baiyan","guazhang"],["des:日向雏田，日向一族宗家女忍者，鸣人的妻子，拥有一双远距离无死角透视之眼，能看穿人体经络穴位并施以攻击，取人芳心于千里之外，易如反掌。同时习得八卦掌，集攻击防御于一身。曾在佩恩袭击木叶村时舍命救鸣人，身受重创，鸣人由此爆走，一度失控，差点被九尾占据，幸得四代火影的查克拉苏醒挽救。"]],
            "卡卡西":["male","shen",3,["leique","fuzhi"],["des:木叶第一技师，佐助鸣人春野樱的老师，六代目火影，左眼的写轮眼来自队友宇智波带土“临死前”的赠予，据称卡卡西以此复制了上千种忍术，更熟练掌握了神威，另绝招雷切，能刺穿一切物体，曾切断过闪电，因此而得名。"]],
            "药师兜":["male","shen",3,["yizhi","xianfa","zhuansheng"],["des:《火影忍者》中的人物，颇具战斗智商。前期作为间谍卧底在木叶村，擅长医疗忍术。幼年时因受伤而失忆，被孤儿院院长药师野乃宇收留，但后来因为团藏要挟野乃宇，于是自愿的为野乃宇以及孤儿院去投靠团藏作为一个忍者活跃于木叶，从小就当间谍而游历各国，但团藏却安排兜与野乃宇自相残杀，自从误杀野乃宇后，兜就认为自己失去了生存意义，与此同时，大蛇丸找到了兜，邀请兜加入音隐村，自此之后便当了大蛇丸的得力助手。大蛇丸被十拳剑封印后，兜为了寻找真实的自己而去模仿大蛇丸的生存道路，移植获得了大蛇丸及其部下的能力，还靠自己在龙地洞修炼了仙人模式，并扬言利用他人来伪装自己，探索世界的真理。第四次忍界大战中，用秽土转生术复活了很多已死去的忍者，包括历代影、晓组织成员以及宇智波斑等高手，与忍者联军互怼。后在与佐助和鼬的战斗中陷入伊邪那美循环的幻术中。最后重拾自我，并前往战场救助佐助。战后被允许在木叶开设孤儿院，回到自己最向往的曾经的生活。"]],
            "迈特凯":["male","shen",5,["bamen","resizhan"],["des:木叶的苍蓝猛兽，擅长体术，绝招“八门遁甲”，曾开七门秒杀干杮鬼蛟，第四次忍界大战打开第八门死门，重创六道宇智波斑，濒死之际被鸣人用阴阳遁术救活"]],
            "大野木":["male","shen",3,["chendun","tiancheng"],["des:两天秤大野木，三代目土影，虽然是一个矮小的老头，却拥有恐怖的比血界限界更高层次的血界淘汰——尘遁•原界剥离之术，发动简单，但威力巨大得令人咋舌，能瞬间将一切物质分离成分子状态。超轻岩之术令他能减轻自身重量，在空中自由飞行，超重岩之术又能增加破坏力和接触到的物体包括人的压力。。。（另一个技能未想好，到时候再调整上限为3）"]],
        },
        translate:{
            "漩涡长门":"漩涡长门",
            "南蛮王":"南蛮王",
            "姜伯约":"姜伯约",
            new:"王允",
            itachi:"宇智波鼬",
            "波风水门":"波风水门",
            "漩涡鸣人":"漩涡鸣人",
            "我爱罗":"我爱罗",
            "佐助":"佐助",
            "带土":"带土",
            "日向雏田":"日向雏田",
            "卡卡西":"卡卡西",
            "药师兜":"药师兜",
            "迈特凯":"迈特凯",
            "大野木":"大野木",
        },
    },
    card:{
        card:{
        },
        translate:{
        },
        list:[],
    },
    skill:{
        skill:{
            "蛮王":{
                mod:{
                    maxHandcard:function (player,num){
            return num+=3-player.hp;
            
        },
                },
                init:function (player){
        if(lib.config.mode=='identity'&&player.isZhu){
            player.maxHp--;
            player.update();
        }
    },
            },
            baoxing:{
                audio:"ext:新武将:2",
                usable:1,
                skillAnimation:"epic",
                animationStr:"地爆天星",
                animationColor:"fire",
                enable:"phaseUse",
                viewAs:{
                    name:"nanman",
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{},"vanishtag":[],"_uncheck":[],"suit":"diamond","number":1,"name":"zhuque","nature":"fire","cardid":"6424189367","clone":{"name":"zhuque","suit":"diamond","number":1,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"cardid":"89735961516","_transitionEnded":true,"timeout":11821},"original":"h","timeout":6826},{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{},"vanishtag":[],"_uncheck":[],"suit":"diamond","number":1,"name":"zhuge","cardid":"6452450319","clone":{"name":"zhuge","suit":"diamond","number":1,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":6906},"original":"h","timeout":6827},{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{},"vanishtag":[],"_uncheck":[],"suit":"diamond","number":8,"name":"shan","cardid":"2136282393","original":"h","clone":{"name":"shan","suit":"diamond","number":8,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":6907},"timeout":6828}],
                },
                filterCard:function (card,player){
        if(ui.selected.cards.length){
            return get.suit(card)==get.suit(ui.selected.cards[0]);
        }
        var cards=player.get('h');
        for(var i=0;i<cards.length;i++){
            if(card!=cards[i]){
                if(get.suit(card)==get.suit(cards[i])) return true;
            }
        }
        return false;
    },
                selectCard:3,
                check:function (card){
        return 6-ai.get.value(card);
    },
                ai:{
                    basic:{
                        order:10,
                        useful:1,
                        value:5,
                    },
                    wuxie:function (target,card,player,viewer){
            if(ai.get.attitude(viewer,target)>0&&target.num('h','shan')){
                if(!target.num('h')||target.hp==1||Math.random()<0.7) return 0;
            }
        },
                    result:{
                        target:function (player,target){
                var num=0;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i].ai.shown==0) num++;
                }
                if(num>1) return 0;
                var nh=target.num('h');
                if(get.mode()=='identity'){
                    if(target.isZhu&&nh<=2&&target.hp<=1) return -100;
                }
                if(nh==0) return -2;
                if(nh==1) return -1.7
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:1,
                        multitarget:1,
                        multineg:1,
                        respondSha:1,
                    },
                },
            },
            xiangfu:{
                skillAnimation:true,
                audio:"ext:新武将:1",
                unique:true,
                trigger:{
                    player:"phaseBegin",
                },
                filter:function (event,player){
        return player.maxHp>=7;
    },
                forced:true,
                priority:3,
                content:function (){
        player.die();
        
        game.createTrigger('phaseBegin','yinghun',player,trigger);
    },
                ai:{
                    threaten:function (player,target){
            if(target.hp==1) return 2;
            return 0.5;
        },
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                var hasfriend=false;
                for(var i=0;i<game.players.length;i++){
                    if(game.players[i]!=target&&ai.get.attitude(game.players[i],target)>=0){
                        hasfriend=true;break;
                    }
                }
                if(!hasfriend) return;
                if(get.tag(card,'damage')==1&&target.hp==2&&!target.isTurnedOver()&&
                _status.currentPhase!=target&&get.distance(_status.currentPhase,target,'absolute')<=3) return [0.5,1];
            },
                    },
                },
            },
            xiongqi:{
                audio:"ext:新武将:2",
                unique:true,
                enable:"chooseToUse",
                mark:true,
                skillAnimation:true,
                animationStr:"雄起",
                animationColor:"fire",
                init:function (player){
        player.storage.niepan=false;
    },
                filter:function (event,player){
        if(player.storage.niepan) return false;
        if(event.type=='dying'){
            if(player!=event.dying) return false;
            return true;
        }
        return false;
    },
                content:function (){
        'step 0'
        player.gainMaxHp(1)
        player.discard(player.get('j'));
        player.hp=Math.min(9,player.maxHp);  
        player.draw(1);
        'step 1'
        
        if(player.isLinked()) player.link();
        'step 2'
        if(player.isTurnedOver()) player.turnOver();
    },
                ai:{
                    order:1,
                    skillTagFilter:function (player){
            if(player.storage.niepan) return false;
            if(player.hp>0) return false;
        },
                    save:true,
                    result:{
                        player:function (player){
                if(player.hp==0) return 10;
                if(player.hp<=2&&player.num('he')<=1) return 10;
                return 0;
            },
                    },
                    threaten:function (player,target){
            if(!target.storage.niepan) return 0.6;
        },
                },
                intro:{
                    content:"limited",
                },
            },
            "guanxing_jiangwei":{
                audio:"ext:新武将:2",
                audioname:["jiangwei"],
                trigger:{
                    player:"damageEnd",
                },
                frequent:true,
                content:function (){
        "step 0"
        if(player.isUnderControl()){
            game.modeSwapPlayer(player);
        }
        var num=Math.min(4,game.countPlayer());
        if(player.hasSkill('yizhi')&&player.hasSkill('guanxing')){
            num=4;
        }
        var cards=get.cards(num);
        event.cards=cards;
        var switchToAuto=function(){
            _status.imchoosing=false;
            if(event.dialog) event.dialog.close();
            if(event.control) event.control.close();
            var top=[];
            var judges=player.node.judges.childNodes;
            var stopped=false;
            if(!player.countCards('h','wuxie')){
                for(var i=0;i<judges.length;i++){
                    var judge=get.judge(judges[i]);
                    cards.sort(function(a,b){
                        return judge(b)-judge(a);
                    });
                    if(judge(cards[0])<0){
                        stopped=true;break;
                    }
                    else{
                        top.unshift(cards.shift());
                    }
                }
            }
            var bottom;
            if(!stopped){
                cards.sort(function(a,b){
                    return get.value(b,player)-get.value(a,player);
                });
               
           
            }
            bottom=cards;
            for(var i=0;i<top.length;i++){
                ui.cardPile.insertBefore(top[i],ui.cardPile.firstChild);
            }
            for(i=0;i<bottom.length;i++){
                ui.cardPile.appendChild(bottom[i]);
            }
            player.popup(get.cnNumber(top.length)+'上'+get.cnNumber(bottom.length)+'下');
            game.log(player,'将'+get.cnNumber(top.length)+'张牌置于牌堆顶');
            game.delay(2);
        };
        var chooseButton=function(online,player,cards){
            var event=_status.event;
            player=player||event.player;
            cards=cards||event.cards;
            event.top=[];
            event.bottom=[];
            event.status=true;
            event.dialog=ui.create.dialog('按顺序选择置于牌堆顶的牌（先选择的在上）',cards);
            for(var i=0;i<event.dialog.buttons.length;i++){
                event.dialog.buttons[i].classList.add('pointerdiv');
            }
            event.switchToAuto=function(){
                event._result='ai';
                event.dialog.close();
                event.control.close();
                _status.imchoosing=false;
            },
            event.control=ui.create.control('ok','pileTop','pileBottom',function(link){
                var event=_status.event;
                if(link=='ok'){
                    if(online){
                        event._result={
                            top:[],
                            bottom:[]
                        }
                        for(var i=0;i<event.top.length;i++){
                            event._result.top.push(event.top[i].link);
                        }
                        for(var i=0;i<event.bottom.length;i++){
                            event._result.bottom.push(event.bottom[i].link);
                        }
                    }
                    else{
                        var i;
                        for(i=0;i<event.top.length;i++){
                            ui.cardPile.insertBefore(event.top[i].link,ui.cardPile.firstChild);
                        }
                        for(i=0;i<event.bottom.length;i++){
                            ui.cardPile.appendChild(event.bottom[i].link);
                        }
                        for(i=0;i<event.dialog.buttons.length;i++){
                            if(event.dialog.buttons[i].classList.contains('glow')==false&&
                                event.dialog.buttons[i].classList.contains('target')==false)
                            ui.cardPile.appendChild(event.dialog.buttons[i].link);
                        }
                        player.popup(get.cnNumber(event.top.length)+'上'+get.cnNumber(event.cards.length-event.top.length)+'下');
                        game.log(player,'将'+get.cnNumber(event.top.length)+'张牌置于牌堆顶');
                    }
                    event.dialog.close();
                    event.control.close();
                    game.resume();
                    _status.imchoosing=false;
                }
                else if(link=='pileTop'){
                    event.status=true;
                    event.dialog.content.childNodes[0].innerHTML='按顺序选择置于牌堆顶的牌';
                }
                else{
                    event.status=false;
                    event.dialog.content.childNodes[0].innerHTML='按顺序选择置于牌堆底的牌';
                }
              
               
              
                
                
                
            })
            for(var i=0;i<event.dialog.buttons.length;i++){
                event.dialog.buttons[i].classList.add('selectable');
            }
            event.custom.replace.button=function(link){
                var event=_status.event;
                if(link.classList.contains('target')){
                    link.classList.remove('target');
                    event.top.remove(link);
                }
                else if(link.classList.contains('glow')){
                    link.classList.remove('glow');
                    event.bottom.remove(link);
                }
                else if(event.status){
                    link.classList.add('target');
                    event.top.unshift(link);
                }
                else{
                    link.classList.add('glow');
                    event.bottom.push(link);
                }
            }
            event.custom.replace.window=function(){
                for(var i=0;i<_status.event.dialog.buttons.length;i++){
                    _status.event.dialog.buttons[i].classList.remove('target');
                    _status.event.dialog.buttons[i].classList.remove('glow');
                    _status.event.top.length=0;
                    _status.event.bottom.length=0;
                }
            }
            game.pause();
            game.countChoose();
        };
        event.switchToAuto=switchToAuto;

        if(event.isMine()){
            chooseButton();
            event.finish();
        }
        else if(event.isOnline()){
            event.player.send(chooseButton,true,event.player,event.cards);
            event.player.wait();
            game.pause();
        }
        else{
            event.switchToAuto();
            event.finish();
        }
      
        
          player.draw();         
        
        "step 1"
        if(event.result=='ai'||!event.result){
            event.switchToAuto();
         
        }
        else{
            var top=event.result.top||[];
            var bottom=event.result.bottom||[];
            for(var i=0;i<top.length;i++){
                ui.cardPile.insertBefore(top[i],ui.cardPile.firstChild);
            }
            for(i=0;i<bottom.length;i++){
                ui.cardPile.appendChild(bottom[i]);
            }
            for(i=0;i<event.cards.length;i++){
                if(!top.contains(event.cards[i])&&!bottom.contains(event.cards[i])){
                    ui.cardPile.appendChild(event.cards[i]);
                }
            }
            player.popup(get.cnNumber(top.length)+'上'+get.cnNumber(event.cards.length-top.length)+'下');
            game.log(player,'将'+get.cnNumber(top.length)+'张牌置于牌堆顶');
            game.delay(2);
             
            
        }
          
           
    },
                ai:{
                    threaten:1.2,
                },
            },
            "tiaoxin_jiangwei":{
                audio:"ext:新武将:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return target.canUse({name:'sha'},player)&&target.countCards('he');
    },
                content:function (){
        "step 0"
        target.chooseToUse({name:'sha'},player,-1,'挑衅：对'+get.translation(player)+'使用一张杀，或令其弃置你的一张牌').set('targetRequired',true);
        "step 1"
        if(result.bool==false&&target.countCards('he')>0){
            player.discardPlayerCard(target,'he',true);
        }
        else{
            event.finish();
        }
    },
                ai:{
                    order:4,
                    expose:0.2,
                    result:{
                        target:-1,
                        player:function (player,target){
                if(target.countCards('h')==0) return 0;
                if(target.countCards('h')==1) return -0.1;
                if(player.hp<=2) return -2;
                if(player.countCards('h','shan')==0) return -1;
                return -0.5;
            },
                    },
                    threaten:1.1,
                },
                audioname:["jiangwei","sp_jiangwei","xiahouba"],
            },
            retianzhao:{
                enable:"phaseUse",
                audio:"ext:新武将:2",
                filterCard:function (card){
        return card.name=='sha'&&!card.nature;
    },
                filter:function (event,player){
        return player.countCards('h','sha')>0
    },
                unique:true,
                viewAs:{
                    name:"sha",
                    nature:"fire",
                    suit:"club",
                    number:4,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{},"vanishtag":[],"_uncheck":[],"suit":"club","number":4,"name":"sha","cardid":"5258356269","_transform":"translateX(224px)","clone":{"name":"sha","suit":"club","number":4,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":1213},"timeout":1191,"original":"h"}],
                },
                prompt:"发动天照，你使用的杀可视为火杀",
                ai:{
                    expose:0.5,
                    threaten:1.5,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    order:function (){
            if(_status.event.player.hasSkillTag('presha',true,null,true)) return 10;
            return 3;
        },
                    result:{
                        target:function (player,target){
                if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                    if(get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3;
                    }
                }
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                        natureDamage:function (card){
                if(card.nature) return 1;
            },
                        fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                        thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                        poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                    },
                },
            },
            lunhui:{
                audio:"ext:新武将:2",
                unique:true,
                enable:"phaseUse",
                mark:true,
                skillAnimation:"epic",
                animationStr:"轮回天生",
                animationColor:"fire",
                init:function (player){
        player.storage.lunhui=false;
    },
                intro:{
                    content:"limited",
                },
                filter:function (event,player){
           return game.dead.length>0;
    },
                content:function (){                
        "step 0" 
        player.storage.lunhui=true; 
        event.current=player.next;                
                 var list=[];
                 for(var i=0;i<game.dead.length;i++){
                     list.push(game.dead[i].name);
                 }                 player.chooseButton(ui.create.dialog('选择1名角色复活',[list,'character']),function(button){
                 for(var i=0;i<game.dead.length&&game.dead[i].name!=button.link;i++);
                     return ai.get.attitude(_status.event.player,game.dead[i]);
                 }); 
                "step 1"
                 player.unmarkSkill('lunhui')               
                 if(result.bool){
                     for(var i=0;i<game.dead.length&&game.dead[i].name!=result.buttons[0].link;i++);
                     var dead=game.dead[i];
                     player.logSkill('lunhui',dead);
                     dead.revive(dead.maxHp);
                     dead.draw(dead.maxHp);
                     player.turnOver();                     
                     player.removeSkill('lunhui')   
     }
     },
                direct:true,
                notarget:true,
                selectCard:2,
                filterCard:function (card) {
        if (card.name == 'tao' ) return true;
        return false;
    },
                position:"h",
                discard:false,
                prompt:"请选择两张桃",
                ai:{
                    expose:0.5,
                },
            },
            tianyin:{
                audio:"ext:新武将:2",
                skillAnimation:"epic",
                animationStr:"万象天引",
                animationColor:"fire",
                usable:1,
                trigger:{
                    player:"phaseEnd",
                },
                check:function (event,player){
        if(player.isTurnedOver()) return true;
        var num=0;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i].num('he')&&game.players[i]!=player&&
                ai.get.attitude(player,game.players[i])<=0){
                num++;
            }
            if(game.players[i].num('j')&&game.players[i]!=player&&
                ai.get.attitude(player,game.players[i])>0){
                num++;
            }
            if(num>=2) return true;
        }
        return false;
    },
                content:function (){
    "step 0"
    var targets=game.players.slice(0);
    targets.remove(player);
    targets.sort(lib.sort.seat);
    event.targets=targets;
    event.num=0;
    "step 1"
    if(num<event.targets.length){
        var hej=event.targets[num].get('hej')
        if(hej.length){
            var card=hej.randomGet();
            player.gain(card,event.targets[num]);
            if(get.position(card)=='h'){
                event.targets[num].$give(1,player);
            }
            else{
                event.targets[num].$give(card,player);
            }
        }
        event.num++;
        event.redo();
    }
    "step 2"
    player.turnOver();
      },
                ai:{
                    threaten:function (player,target){
            if(target.hp==1) return 1.5;
            return 1;
        },
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(player.hasSkill('jueqing')) return [1,-2];
                    if(target.hp==1) return;
                    if(target.isTurnedOver()) return [0,-2];
                    var num=0;
                    for(var i=0;i<game.players.length;i++){
                        if(game.players[i].num('he')&&game.players[i]!=player&&
                            ai.get.attitude(player,game.players[i])>0){
                            num++;
                        }
                        if(game.players[i].num('j')&&game.players[i]!=player&&
                            ai.get.attitude(player,game.players[i])>0){
                            num++;
                        }
                        if(num>2) return [0,1];
                        if(num==2) return [0.5,1];
                    }
                }
            },
                    },
                },
            },
            yuedu:{
                audio:"ext:新武将:3",
                usable:1,
                enable:"phaseUse",
                filterTarget:function (card,player,target){
        return player!=target&&target.countCards('h')>0;
    },
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(target);
        "step 1"
        if(result.bool){
            target.turnOver();
            player.storage.fenxun2=target;
            player.addTempSkill('fenxun2','phaseAfter');         
            target.addTempSkill('fengyin','phaseAfter');      
            target.addTempSkill('yijue2','phaseAfter');
            event.finish();
        }
    },
                ai:{
                    result:{
                        target:function (player,target){
                var hs=player.getCards('h');
                if(hs.length<3) return 0;
                var bool=false;
                for(var i=0;i<hs.length;i++){
                    if(hs[i].number>=9&&get.value(hs[i])<7){
                        bool=true;
                        break;
                    }
                }
                if(!bool) return 0;              
                if(player.canUse('sha',target)&&(player.countCards('h','sha')||player.countCards('he',{color:'red'}))){
                    return -2;
                }
                return -0.5;
            },
                    },
                    order:9,
                },
            },
            xuzuo:{
                audio:"ext:新武将:2",
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
        if(event.nature&&player.countCards('h')) return true;
        if(!event.nature&&!player.countCards('h')) return true;
        return false;
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
                mod:{
                    maxHandcard:function (player,num){
            return num+1;
        },
                },
                srlose:true,
                mark:true,
                ai:{
                    nofire:function (player){
            return player.countCards('h')>0;
        },
                    nothunder:function (player){
            return player.countCards('h')>0;
        },
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'natureDamage')&&target.countCards('h')>0) return 0;
                if(card.name=='tiesuo'&&target.countCards('h')>0)    return [0,0];
                if(!get.tag(card,'natureDamage')&&!target.countCards('h')) return [0,0];
            },
                    },
                },
                intro:{
                    content:function (storage,player){
            var str='';
            if(player.countCards('h')){
                str+='防止属性伤害';
            }
            else{
                str+='防止非属性伤害';
            }
            return str;
        },
                },
            },
            jugong:{
                audio:"ext:新武将:2",
                trigger:{
                    global:"damageEnd",
                },
                usable:1,
                frequent:true,
                locked:false,
                notemp:true,
                init:function (player){
        player.storage.jugong=[];
    },
                filter:function (event,player){
        return event.card&&(event.card.name=='sha'||event.card.name=='juedou')&&event.notLink()                
 &&_status.currentPhase!=player;
   
    },
                content:function (){
        "step 0"
        player.draw();
        "step 1"
        if(player.countCards('h')){
            player.chooseCard('将'+get.cnNumber(1)+'张手牌置于武将牌上作为“功”',1,true);
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.cards&&result.cards.length){
            player.lose(result.cards,ui.special);
            player.storage.jugong=player.storage.jugong.concat(result.cards);
            player.syncStorage('jugong');
            player.markSkill('jugong');
            game.log(player,'将',result.cards,'置于武将牌上作为“功”');
        }
    },
                intro:{
                    content:"cards",
                },
                group:"jugong_1",
                subSkill:{
                    "1":{
                        trigger:{
                            player:"damageBegin",
                        },
                        filter:function (event,player){        
                            return player.storage.jugong.length>1;
    },
                        content:function (){
    'step 0'  
      player.chooseCardButton('移去两张“功”',2,player.storage.jugong,true);
                'step 1'
                 if(event.directresult||result.bool){
            player.logSkill('jugong');
            var links=event.directresult||result.links;
            for(var i=0;i<links.length;i++){
                player.storage.jugong.remove(links[i]);
            }
            player.syncStorage('jugong');
            if(!player.storage.jugong.length){
                player.unmarkSkill('jugong');
            }
            else{
               player.markSkill('jugong');
            }
            player.$throw(links);
            game.log(player,'被移去了',links);
            for(var i=0;i<links.length;i++){
                ui.discardPile.appendChild(links[i]);}
            }
    'step 2'
    trigger.untrigger();
      trigger.finish();
       
    
},
                        sub:true,
                    },
                },
                ai:{
                    maixie:true,
                    "maixie_hp":true,
                    threaten:0.8,
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(player.hasSkillTag('jueqing',false,target)) return [1,-2];
                    if(!target.hasFriend()) return;
                    if(target.hp>=4) return [0.5,get.tag(card,'damage')*2];
                    if(!target.hasSkill('paiyi')&&target.hp>1) return [0.5,get.tag(card,'damage')*1.5];
                    if(target.hp==3) return [0.5,get.tag(card,'damage')*1];
                    if(target.hp==2) return [1,get.tag(card,'damage')*0.5];
                }
            },
                    },
                },
            },
            liangji:{
                audio:"ext:新武将:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return target!=player;
    },
                content:function (){
        'step 0'
        player.chooseCard('h','连计：将1张牌置于'+get.translation(target)+'的武将牌上',true).set('ai',function(card){
            if(get.attitude(_status.event.player,_status.event.getParent().player)>0){
                return 7-get.value(card);
            }
            return -get.value(card);
        });
        'step 1'
        if(result.bool){
            player.$give(result.cards,target);
            player.lose(result.cards,ui.special);
            target.storage.liangji_1=result.cards;
            target.storage.liangji_1_source=target;
            target.syncStorage('liangji_1');
            target.addSkill('liangji_1');
        }
    },
                ai:{
                    order:1,
                    result:{
                        target:function (player,target){
                if(get.attitude(player,target)>0){
                    return Math.sqrt(target.countCards('he'));
                }
                return 0;
            },
                        player:1,
                    },
                },
                subSkill:{
                    "1":{
                        trigger:{
                            player:"phaseDrawBegin",
                        },
                        forced:true,
                        mark:true,
                        intro:{
                            content:"cards",
                        },
                        content:function (){
                'step 0'
                var cards=player.storage.liangji_1;
                if(cards){
                    player.gain(cards,'gain2');
                   }                  
                  player.storage.liangji_1=0;                                            
             
                'step 1'            
            if(player.sex=='male')player.addTempSkill('wushuang');                                  
            if(player.sex=='female')player.addTempSkill('lijian');
                player.removeSkill('liangji_1');
              
            
            
            },
                        sub:true,
                    },
                },
            },
            chengmou:{
                audio:"ext:新武将:2",
                trigger:{
                    player:"phaseDrawBegin",
                },
                frequent:true,
                filter:function (event,player){        
                            return player.storage.jugong.length>0;
    },
                content:function (){
       'step 0'
       if(player.storage.jugong.length>2)player.loseHp();
           'step 1'
       var cards=player.storage.jugong;
       
       if(cards){                    
       player.gain(cards,'gain2');                    
             }                             
       player.storage.jugong=[];
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      
    },
            },
            tianzheng:{
                audio:"ext:新武将:2",
                group:["tianzheng_more","tianzheng_less"],
                subSkill:{
                    more:{
                        audio:["tianzheng",2],
                        trigger:{
                            source:"damageBegin",
                        },
                        direct:true,
                        filter:function (event,player){
                if(!player.num('h',{color:'red'})) return false;
                return event.player.hp>=player.hp&&player!=event.player;
            },
                        content:function (){
                'step 0'
                var goon=(ai.get.attitude(player,trigger.player)<0);
                var next=player.chooseToDiscard(get.prompt('天征：是否弃置一张红色手牌令伤害＋1？',trigger.player),{color:'red'});
                next.set('ai',function(card){
                    if(_status.event.goon){
                        return 8-ai.get.value(card);
                    }
                    return 0;
                });
                next.set('goon',goon);
                next.logSkill=['tianzheng',trigger.player];
                'step 1'
                if(result.bool){
                    trigger.num++;
                }
            },
                        sub:true,
                    },
                    less:{
                        audio:["tianzheng",2],
                        trigger:{
                            player:"damageBegin",
                        },
                        filter:function (event,player){
                if(!player.num('h',{color:'black'})) return false;
                return event.source&&event.source.hp>=player.hp&&player!=event.source;
            },
                        direct:true,
                        content:function (){
                "step 0"
                var next=player.chooseToDiscard('天征：是否弃置一张黑色手牌令伤害-1？',{color:'black'});
                next.set('ai',function(card){
                    var player=_status.event.player;
                    if(player.hp==1||_status.event.getTrigger().num>1){
                        return 9-ai.get.value(card);
                    }
                    if(player.hp==2){
                        return 8-ai.get.value(card);
                    }
                    return 7-ai.get.value(card);
                });
                next.logSkill='tianzheng';
                "step 1"
                if(result.bool){
                    game.delay();
                    trigger.num--;
                }
            },
                        sub:true,
                    },
                },
                ai:{
                    expose:0.2,
                    threaten:1.5,
                },
            },
            baiyan:{
                audio:"ext:新武将:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        if(player==target) return false;
        return (target.countCards('h')||target.isUnseen(2));
    },
                content:function (){
        "step 0"
        
         player.chooseCardButton(target,target.getCards('h')).set('filterButton',function(button){
            return get.suit(button.link)=='heart';
        });                                                                   
        "step 1"                   
        if(result.bool){                           
        event.card=result.links[0];                       
        player.gain(event.card,target);
        target.$give(event.card,player);               
        }                                                
                                 
    },
                selectTarget:1,
                ai:{
                    threaten:1.5,
                    result:{
                        target:function (player,target){
                return -target.countCards('h');
            },
                    },
                    order:10,
                    expose:0.4,
                },
            },
            zhangshu:{
                audio:"ext:新武将:1",
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        if(player==_status.currentPhase) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original&&event.cards[i].original!='j') return true;
        }
        return false;
    },
                content:function (){
        player.draw();
    },
            },
            shanjie:{
                audio:"ext:新武将:2",
                trigger:{
                    player:"phaseUse",
                },
                logTarget:"target",
                mod:{
                    globalTo:function (from,to,distance){
            return distance+1;
        },
                    targetInRange:function (card,player,target){
            if(card.number){
                if(get.distance(player,target)<=card.number) return true;
            }
        },
                },
            },
            luoxuan:{
                audio:"ext:新武将:2",
                enable:"phaseUse",
                usable:1,
                chooseButton:{
                    dialog:function (){
            var list=['taoyuan','wugu','juedou','huogong','jiedao','tiesuo','guohe','shunshou','wuzhong','wanjian','nanman'];
            for(var i=0;i<list.length;i++){
                list[i]=['锦囊','',list[i]];
            }                       
    return ui.create.dialog([list,'vcard']);                                        
        },
                    check:function (button){
            var player=_status.event.player;
            var recover=0,lose=1,players=game.filterPlayer();
            for(var i=0;i<players.length;i++){
                if(!players[i].isOut()){
                    if(players[i].hp<players[i].maxHp){
                        if(get.attitude(player,players[i])>0){
                            if(players[i].hp<2){
                                lose--;
                                recover+=0.5;
                            }
                            lose--;
                            recover++;
                        }
                        else if(get.attitude(player,players[i])<0){
                            if(players[i].hp<2){
                                lose++;
                                recover-=0.5;
                            }
                            lose++;
                            recover--;
                        }
                    }
                    else{
                        if(get.attitude(player,players[i])>0){
                            lose--;
                        }
                        else if(get.attitude(player,players[i])<0){
                            lose++;
                        }
                    }
                }
            }
            if(lose>recover&&lose>0) return (button.link[2]=='nanman')?1:-1;
            if(lose<recover&&recover>0) return (button.link[2]=='taoyuan')?1:-1;
            return (button.link[2]=='wuzhong')?1:-1;
        },
                    backup:function (links,player){                   
        return {
                filterCard:true,   
                filterCard:{
                  type:"equip",
                },           
                selectCard:1,                   
                position:'he',               
                popname:true,
                viewAs:{name:links[0][2]},
            }                          
        },
                    prompt:function (links,player){           
           
            return '选择任意一张装备牌当作'+get.translation(links[0][2])+'使用';                 
        },
                },
                ai:{
                    order:8,
                    expose:0.8,
                    result:{
                        player:function (player){
                var num=0;
                var cards=player.getCards('he');                                  
                if(card.name=='bagua'&&card.name=='renwang') return 0         
                for(var i=0;i<cards.length;i++){
                    num+=Math.max(0,get.value(cards[i],player,'raw'));
                }
                num/=cards.length;
                num*=Math.min(cards.length,player.hp);
                return 12-num;
            },
                    },
                    threaten:1.5,
                },
            },
            yandun:{
                audio:"ext:新武将:3",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.countCards('h')>0;
    },
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(target);
        "step 1"
        if(result.bool){                       
           player.viewHandcards(target);                  
           event.target.damage("fire");      
        }
        else{
            player.draw();
        }
    },
                ai:{
                    order:function (name,player){
            var cards=player.getCards('h');
            if(player.countCards('h','sha')==0){
                return 1;
            }
            for(var i=0;i<cards.length;i++){
                if(cards[i].name!='sha'&&cards[i].number>11&&get.value(cards[i])<7){
                    return 9;
                }
            }
            return get.order({name:'sha'})-1;
        },
                    result:{
                        player:function (player){
                if(player.countCards('h','sha')>0) return 0;
                var num=player.countCards('h');
                if(num>player.hp) return 0;
                if(num==1) return -2;
                if(num==2) return -1;
                return -0.7;
            },
                        target:function (player,target){
                var num=target.countCards('h');
                if(num==1) return -1;
                if(num==2) return -0.7;
                return -0.5
            },
                    },
                    threaten:1.3,
                },
            },
            rexuzuo:{
                audio:"ext:新武将:2",
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
        if(event.nature&&player.countCards('h')) return true;
        if(!event.nature&&!player.countCards('h')) return true;
        return false;
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
                mod:{
                    maxHandcard:function (player,num){
            return num+1;
        },
                },
                srlose:true,
                mark:true,
                ai:{
                    nofire:function (player){
            return player.countCards('h')>0;
        },
                    nothunder:function (player){
            return player.countCards('h')>0;
        },
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'natureDamage')&&target.countCards('h')>0) return 0;
                if(card.name=='tiesuo'&&target.countCards('h')>0)    return [0,0];
                if(!get.tag(card,'natureDamage')&&!target.countCards('h')) return [0,0];
            },
                    },
                },
                intro:{
                    content:function (storage,player){
            var str='';
            if(player.countCards('h')){
                str+='防止属性伤害';
            }
            else{
                str+='防止非属性伤害';
            }
            return str;
        },
                },
            },
            qianniao:{
                enable:"phaseUse",
                audio:"ext:新武将:2",
                filterCard:function (card){
        return card.name=='sha'&&!card.nature;
    },
                filter:function (event,player){
        return player.countCards('h','sha')>0
    },
                unique:true,
                viewAs:{
                    name:"sha",
                    nature:"thunder",
                    suit:"club",
                    number:9,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{},"vanishtag":[],"_uncheck":[],"suit":"club","number":9,"name":"sha","cardid":"502041124","clone":{"name":"sha","suit":"club","number":9,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":6919},"original":"h","_transform":"translateX(0px)","timeout":6898}],
                },
                prompt:"发动千鸟，你使用的杀可附带雷属性",
                ai:{
                    expose:0.5,
                    threaten:1.5,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    order:function (){
            if(_status.event.player.hasSkillTag('presha',true,null,true)) return 10;
            return 3;
        },
                    result:{
                        target:function (player,target){
                if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                    if(get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3;
                    }
                }
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                        natureDamage:function (card){
                if(card.nature) return 1;
            },
                        fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                        thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                        poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                    },
                },
            },
            xianshu:{
                audio:"ext:新武将:2",
                srlose:true,
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        if(player.countCards('h')) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){       
        player.draw(player.hp);
        player.recover();
    },
                ai:{
                    threaten:0.8,
                    effect:{
                        target:function (card,player,target){
                if(target.countCards('h')==1&&card.name=='guohe') return 0.5;
                if(target.isTurnedOver()&&target.countCards('h')==1&&(card.name=='guohe'||card.name=='shunshou')) return -5;
            },
                    },
                    noh:true,
                },
            },
            shazang:{
                mod:{
                    globalFrom:function (from,to,distance){
            if(from.hp==1||from.num('h')==1)return distance-Infinity;
        },
                    selectTarget:function (card,player,range){ 
            if(player.hp==1||player.num('h')==1){
if(range[1]==-1) return;
if(card.name=='sha'||card.name=='juedou'||card.name=='shunshou'||card.name=='guohe') range[1]+=7;}
},
                },
                audio:"ext:新武将:2",
                ai:{
                    maixie:true,
                    expose:0.5,
                    threaten:1.5,
                },
            },
            juefang:{
                audio:"ext:新武将:2",
                group:["juefang_less","juefang_more"],
                subSkill:{
                    less:{
                        audio:"ext:新武将:1",
                        trigger:{
                            target:"useCardToBefore",
                        },
                        forced:true,
                        filter:function (event,player){
        return event.card.name=='sha';
    },
                        content:function (){
        "step 0"
        var eff=get.effect(player,trigger.card,trigger.player,trigger.player);
        trigger.player.chooseToDiscard('绝防：弃置一张基本牌，否则此牌对'+get.translation(player)+'无效',function(card){
            return get.type(card)=='basic';
        }).set('ai',function(card){
            if(_status.event.eff>0){
                return 10-get.value(card);
            }
            return 0;
        }).set('eff',eff);
        "step 1"
        if(result.bool==false){
            trigger.finish();
            trigger.untrigger();
        }
    },
                        sub:true,
                    },
                    more:{
                        audio:"ext:新武将:1",
                        trigger:{
                            player:"damageBefore",
                        },
                        forced:true,
                        priority:15,
                        check:function (event,player){
        if(player==event.player) return true;
        return false;
    },
                        filter:function (event,player){
        return get.type(event.card,'trick')=='trick';
    },
                        content:function (){
        trigger.untrigger();
        trigger.finish();
    },
                        sub:true,
                    },
                    ai:{
                        order:10,
                        maixie:true,
                        notrick:true,
                        effect:{
                            target:function (card,player,target,current){
                if(card.name=='sha'&&get.attitude(player,target)<0){
                    if(_status.event.name=='juefang') return;
                    
                    
                    
                    
                    var bs=player.getCards('h',{type:'basic'});
                    if(bs.length<2) return 0;
                    
                    if(bs.length<=3&&player.countCards('h','sha')<=1){
                        for(var i=0;i<bs.length;i++){
                            if(bs[i].name!='sha'&&get.value(bs[i])<7){
                                return [1,0,1,-0.5];
                            }
                        }
                        return 0;
                    }
                    return [1,0,1,-0.5];
                }
            },
                        },
                        sub:true,
                    },
                },
            },
            reshenwei:{
                audio:"ext:新武将:2",
                enable:"chooseToUse",
                filterCard:{
                    type:"equip",
                },
                position:"he",
                viewAs:{
                    name:"wuxie",
                    suit:"diamond",
                    number:5,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{},"vanishtag":[],"_uncheck":[],"suit":"diamond","number":5,"name":"muniu","cardid":"1767543274","clone":{"name":"muniu","suit":"diamond","number":5,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":415},"timeout":382,"original":"h"}],
                },
                filter:function (event,player){
        return player.countCards('he',{type:'equip'})>0;
    },
                viewAsFilter:function (player){
        return player.countCards('he',{type:'equip'})>0;
    },
                prompt:"将一张装备区内的牌当无懈可击使用（神威右眼转移自身虚化）",
                check:function (card){return 8-get.equipValue(card)},
                threaten:1.2,
                group:"reshenwei_move",
                subSkill:{
                    move:{
                        trigger:{
                            player:"turnOverEnd",
                        },
                        direct:true,
                        audio:2,
                        filter:function (event,player){
                return !player.isTurnedOver()&&player.canMoveCard();
            },
                        content:function (){
                "step 0"
                player.chooseToDiscard('he',get.prompt('reshenwei'),'弃置一张牌并移动场上的一张牌（神威左眼远距扭曲空间）',lib.filter.cardDiscardable).set('ai',function(card){
                    if(!_status.event.check) return 0;
                    return 7-get.value(card);
                }).set('check',player.canMoveCard(true)).set('logSkill','reshenwei');
                "step 1"
                if(result.bool){
                    player.moveCard(true);
                }
                else{
                    event.finish();
                }
            },
                        sub:true,
                    },
                },
                ai:{
                    basic:{
                        useful:[6,4],
                        value:[6,4],
                    },
                    result:{
                        player:1,
                    },
                    expose:0.2,
                },
            },
            xishou:{
                audio:"ext:新武将:2",
                trigger:{
                    player:"phaseEnd",
                },
                filter:function (event,player){
        return player.num('he')>0;
    },
                content:function (){
 'step 0'
 player.chooseToDiscard(1,'he',true)
    player.chooseTarget('请选择一名目标，然后获得其所有牌',get.prompt('xishou'),function(card,player,target){
        return target!=player&&target.num('he')>0;
    }).set("ai",function(target){
            return get.damageEffect(target,player,player);
        
    });
    'step 1'
      if(result.bool){            
        for(var i=0;i<result.targets.length;i++){
           player.logSkill('xishou',result.targets);            
           player.gainPlayerCard(999,result.targets[i],'he',true)            
    };
      };
    'step 2'
    player.turnOver()
      },
                ai:{
                    order:5,
                    result:{
                        player:function (player){
                if(player.classList.contains('turnedover')) return 10;
                return 0;
            },
                        target:function (player,target){
                if(target.countCards('h')>target.hp) return target.hp-target.countCards('h');
                return 0
            },
                    },
                    threaten:0.5,
                    effect:{
                        target:function (card){
                if(card.name=='guiyoujie') return [0,2];
            },
                    },
                },
            },
            refengyin:{
                audio:"ext:新武将:2",
                unique:true,
                mark:true,
                direct:true,
                skillAnimation:"epic",
                animationStr:"尸鬼封尽",
                animationColor:"fire",
                trigger:{
                    player:"phaseEnd",
                },
                filter:function (event,player){
        return player.hp>0;
    },
                init:function (player){
        player.storage.refengyin=false;
    },
                intro:{
                    content:"limited",
                },
                content:function (){
         "step 0"          
         player.storage.refengyin=true; 
         player.chooseTarget('请选择一名目标，弃置令其技能失效',get.prompt('refengyin'),function(card,player,target){
            return target!=player;
        }).set("ai",function(target){
                return get.damageEffect(target,player,player);
            
        });
        'step 1'        
         player.unmarkSkill('refengyin')          
          if(result.bool){           
            for(var i=0;i<result.targets.length;i++){
                player.logSkill('refengyin',result.targets);            
                result.targets[i].clearSkills();                                   
                player.loseHp(player.hp);
                player.removeSkill('refengyin');                                                         
        };
          };
 
    },
                ai:{
                    threaten:0.3,
                    expose:0.6,
                    result:{
                        target:function (player,target){
                return -target.hp;                              
            },
                    },
                    order:2,
                },
            },
            guazhang:{
                audio:"ext:新武将:2",
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        
        if(player==_status.currentPhase) return false;        
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){
        var num=0;
        for(var i=0;i<trigger.cards.length;i++){
            if(trigger.cards[i].original=='h') num+=1;
        }
        player.draw(num);
    },
                ai:{
                    noe:true,
                    reverseEquip:true,
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='equip') return [1,3];
            },
                    },
                },
            },
            leique:{
                enable:"phaseUse",
                audio:"ext:新武将:2",
                filterCard:function (card){
        return card.name=='sha'&&!card.nature;
    },
                filter:function (event,player){
        return player.countCards('h','sha')>0
    },
                unique:true,
                viewAs:{
                    name:"sha",
                    nature:"thunder",
                    number:11,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{},"vanishtag":[],"_uncheck":[],"suit":"heart","number":11,"name":"sha","cardid":"2543617317","original":"h","clone":{"name":"sha","suit":"heart","number":11,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":7129},"_transform":"translateX(0px)","timeout":7104}],
                    suit:"heart",
                },
                prompt:"发动雷切，你使用的杀无视防具，并附带雷属性",
                ai:{
                    unequip:true,
                    skillTagFilter:function (player,tag,arg){
            if(arg&&arg.name=='sha') return true;
            return false;
        },
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    order:function (){
            if(_status.event.player.hasSkillTag('presha',true,null,true)) return 10;
            return 3;
        },
                    result:{
                        target:function (player,target){
                if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                    if(get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3;
                    }
                }
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                        natureDamage:function (card){
                if(card.nature) return 1;
            },
                        fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                        thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                        poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                    },
                },
            },
            yizhi:{
                audio:"ext:新武将:2",
                trigger:{
                    player:["damageBegin"],
                },
                forced:true,
                priority:20,
                unique:true,
                content:function (){


   "step 0"              

        var skills=[]; 

        for(var i in lib.character){ 

            for(var j=0;j<lib.character[i][3].length;j++){

   var info=lib.skill[lib.character[i][3][j]];

                if(info&&(info.gainable||!info.unique)){

                    skills.add(lib.character[i][3][j]); 

                }

            } 

        }

        var link=skills.randomGet();                    

        player.addSkill(link);                    

        player.mark(link,{

            name:get.translation(link),

            content:lib.translate[link+'_info']

        });

        game.log(player,'获得技能','【'+get.translation(link)+'】');        

    },
                ai:{
                    threaten:1.8,
                },
            },
            xianfa:{
                audio:"ext:新武将:2",
                srlose:true,
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        if(player.countCards('h')) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){       
        player.draw();
        player.recover();
    },
                ai:{
                    threaten:0.8,
                    effect:{
                        target:function (card,player,target){
                if(target.countCards('h')==1&&card.name=='guohe') return 0.5;
                if(target.isTurnedOver()&&target.countCards('h')==1&&(card.name=='guohe'||card.name=='shunshou')) return -5;
            },
                    },
                    noh:true,
                },
            },
            zhuansheng:{
                audio:"ext:新武将:2",
                unique:true,
                usable:1,
                skillAnimation:"epic",
                animationStr:"秽土转生",
                animationColor:"fire",
                enable:"phaseUse",
                filter:function (event,player){
           return game.dead.length>0;                          
    },
                content:function (){                
        "step 0"         
        event.current=player.next;                
                 var list=[];
                 for(var i=0;i<game.dead.length;i++){
                     list.push(game.dead[i].name);
                 }                 player.chooseButton(ui.create.dialog('选择1名已阵亡的角色复活',[list,'character']),function(button){
                 for(var i=0;i<game.dead.length&&game.dead[i].name!=button.link;i++);
                     return ai.get.attitude(_status.event.player,game.dead[i]);
                 }); 
                "step 1"                             
                 if(result.bool){
                     for(var i=0;i<game.dead.length&&game.dead[i].name!=result.buttons[0].link;i++);
                     var dead=game.dead[i];
                     player.logSkill('zhuansheng',dead);
                     dead.revive(2);
                     dead.draw(2);                   
                     player.loseMaxHp();                                                                
     }
     },
                direct:true,
                notarget:true,
                selectCard:1,
                filterCard:function (card) {
        if (card.name == 'tao' ) return true;
        return false;
    },
                position:"h",
                discard:false,
                prompt:"请选择一张桃",
                ai:{
                    expose:0.5,
                },
            },
            fenshen:{
                audio:"ext:新武将:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return target!=player&&target.countCards('h')>0;
    },
                selectTarget:[1,3],
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                multitarget:true,
                multiline:true,
                content:function (){
        player.chooseToCompare(targets).callback=lib.skill.fenshen.callback;
    },
                init:function (player){
        player.storage.fenshen=0;
    },
                intro:{
                    name:"分身",
                    content:"mark",
                },
                chat:["万年吊车尾","木叶的灾星","别浪费查克拉了","黄头小儿","雏田是你的，佐助是我的","九尾狐狸","口遁对我没用","你是不可能当上火影的","我从未见过有如此厚顔无耻之人！"],
                callback:function (){
'step 0'
event.num1=event.card1.number;
event.num2=event.card2.number;

'step 1'
                
if(result.bool){
    if(event.num1<player.storage.fenshen){
        event.num1+=player.storage.fenshen;
    }
    else{
        player.getStat().skill.fenshen--;
    }
}
'step 2'
if(event.num1>event.num2){
    target.chooseToDiscard('he','弃置一张牌并受到一点火焰伤害，或令'+get.translation(player)+'摸两张牌并失去一点体力').set('ai',function(card){
   if(ai.get.attitude(target,player)>0) return -ai.get.value(card);
        return 6-ai.get.value(card);
    });
}
else{   
    target.chat(lib.skill.fenshen.chat[player.storage.fenshen]);
    game.delay();
    player.storage.fenshen++;
    player.markSkill('fenshen');
    if(player.storage.fenshen>=9){
        player.die();
    }
    else{
        player.chooseToDiscard('he','弃置一张牌令目标角色受到一点火焰伤害，或摸两张牌并失去一点体力').set('ai',function(){return -1;});
        }
      }
 'step 3'
 if(!result.bool){   
     player.draw(2);  
     player.loseHp();
}
        else{       
         event.target.damage(); 
        }
    },
                ai:{
                    order:7,
                    result:{
                        target:function (player,target){
                var num=game.countPlayer(function(current){
                    return get.attitude(player,current)<0&&current!=player&&current.countCards('h');
                });
                if(num>3) num=3;
                
                var hs=player.getCards('h');
                for(var i=0;i<hs.length;i++){
                    if(get.value(hs[i])<=6){
                        switch(hs[i].number){
                            case 13:return -1;
                            case 12:if(player.storage.fenshen+num<=8) return -1;break;
                            case 11:if(player.storage.fenshen+num<=7) return -1;break;
                            default:if(hs[i].number>5&&player.storage.fenshen+num<=8) return -1;
                        }
                    }
                }
                return 0;
            },
                    },
                },
            },
            xianyan:{
                audio:"ext:新武将:3",
                srlose:true,
                trigger:{
                    player:"dieBegin",
                },
                direct:true,
                skillAnimation:"epic",
                animationStr:"让它帮你看清未来",
                animationColor:"fire",
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('xianyan'),function(card,player,target){
            return player!=target;
        }).ai=function(target){
            var num=get.attitude(player,target);
            if(num>0){
                if(target.isDamaged()) return 2;
                return 1;
            }
            return 0;
        }
        "step 1"
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('xianyan',target);
            var n=[1,2].randomGet();
            if(n==1){target.addSkill("reshenwei");
            target.recover();
                    };
            if(n==2){target.addSkill("xishou");            
            target.recover();
                    };
        }
    },
                ai:{
                    expose:0.5,
                },
            },
            "横剑":{
                enable:"phaseUse",
                filterCard:{
                    name:"sha",
                },
                selectCard:2,
                check:function (card){
        var num=0;
        var player=_status.event.player;
        var players=game.filterPlayer();
        for(var i=0;i<players.length;i++){
            if(lib.filter.targetEnabled({name:'sha'},player,players[i])&&
            get.effect(players[i],{name:'sha'},player)>0){
                num++;
                if(num>1) return 8-get.value(card);
            }
        }
        return 0;
    },
                viewAs:{
                    name:"sha",
                },
                selectTarget:[1,Infinity],
                filterTarget:function (card,player,target){
        return lib.filter.targetEnabled({name:'sha'},player,target);
    },
                ai:{
                    order:function (){
            return get.order({name:'sha'})+0.1;
        },
                    effect:{
                        player:function (card,player){
                if(_status.currentPhase!=player) return;
                if(card.name=='sha'&&player.countCards('h','sha')<2&&!player.needsToDiscard()){
                    var num=0;
                    var player=_status.event.player;
                    var players=game.filterPlayer();
                    for(var i=0;i<players.length;i++){
                        if(lib.filter.targetEnabled({name:'sha'},player,players[i])&&
                        get.attitude(player,players[i])<0){
                            num++;
                            if(num>1) return 'zeroplayertarget';
                        }
                    }
                }
            },
                    },
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    result:{
                        target:function (player,target){
                if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                    if(get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3;
                    }
                }
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                        natureDamage:function (card){
                if(card.nature) return 1;
            },
                        fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                        thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                        poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                    },
                },
                group:"luanjian2",
            },
            bamen:{
                trigger:{
                    player:["phaseUseBegin","changeHp","changeMaxHp"],
                },
                forced:true,
                popup:false,
                unique:true,
                derivation:["mashu","paoxiao","fuqi","anjian"],
                content:function (){
        player.removeAdditionalSkill('bamen');
        var list=[];         
        if(player.hp<=4){
            list.push('mashu');
        }  
        if(player.hp<=3||player.maxHp<=1){
            list.push('paoxiao');
        }
        if(player.hp<=2||player.maxHp<=1){
            list.push('fuqi');
        }
        if(player.hp<=1||player.maxHp<=1){
            list.push('anjian');
        }
        if(list.length){
            player.addAdditionalSkill('bamen',list);
        }
    },
                ai:{
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(!target.hasFriend()) return;
                    if(target.hp>=4) return [0,1];
                }
                if(get.tag(card,'recover')&&player.hp>=player.maxHp-1) return [0,0];
            },
                    },
                },
            },
            fuzhi:{
                audio:"ext:新武将:3",
                trigger:{
                    player:["phaseBefore","phaseEnd"],
                    global:"gameDrawAfter",
                },
                direct:true,
                content:function (){
        "step 0"
        if(player.countCards('he')){
            player.chooseTarget({
                prompt:get.prompt('fuzhi'),                                                             
                filterTarget:function(card,player,target){
                    if(target==player) return false;                    
                    var name=target.name.indexOf('unknown')==0?target.name2:target.name;
                    if(name==player.storage.fuzhi) return false;
                    var info=lib.character[name];
                    if(info){
                        var skills=info[3];
                        for(var j=0;j<skills.length;j++){
                            if(lib.translate[skills[j]+'_info']&&lib.skill[skills[j]]&&
                                !lib.skill[skills[j]].unique&&!player.hasSkill(skills[j])){
                                return true;
                            }
                        }
                    }
                    return false;
                },
                ai1:function(card){
                    if(player.additionalSkills.fuzhi&&player.additionalSkills.fuzhi.length>0) return 0;
                    return 7-get.value(card);
                },
                ai2:function(target){
                    if(target.isMin()) return 0;
                    return 6-target.maxHp;
                }
            });
        }
        else{
            event.finish();
        }
        "step 1"
        if(result.bool){
            player.unmark(player.storage.fuzhi+'_charactermark');
            player.logSkill('fuzhi',result.targets);
            var name=result.targets[0].name;
            if(name.indexOf('unknown')==0){
                name=result.targets[0].name2;
            }
            var list=[];
            var skills=lib.character[name][3];
            for(var j=0;j<skills.length;j++){
                if(lib.translate[skills[j]+'_info']&&lib.skill[skills[j]]&&
                    !lib.skill[skills[j]].unique&&!player.hasSkill(skills[j])){
                    list.push(skills[j]);
                }
            }
            player.addAdditionalSkill('fuzhi',list);
            player.markCharacter(name,null,true,true);
            game.addVideo('markCharacter',player,{
                name:'写轮眼•复制',
                content:'',
                id:'fuzhi',
                target:name
            });
            player.storage.fuzhi=name;
        }
    },
                ai:{
                    threaten:1.5,
                },
            },
            resizhan:{
                audio:"ext:新武将:2",
                trigger:{
                    player:"phaseUseBefore",
                },
                unique:true,
                mark:true,
                skillAnimation:"epic",
                animationStr:"燃烧吧，青春！",
                animationColor:"fire",
                init:function (player){
        player.storage.resizhan=false;
    },
                intro:{
                    content:"limited",
                },
                check:function (){return 1;},
                content:function (){
        'step 0'      
        player.storage.resizhan=true;    
        player.unmark();      
        event.cards=get.cards(8);  
        'step 1'   
        player.gain(event.cards);
        player.loseMaxHp(player.maxHp-1);
        player.removeSkill('resizhan');             
    },
                ai:{
                    order:1,
                    threaten:2,
                    expose:0.8,
                },
            },
            tiancheng:{
                audio:"ext:新武将:2",
                group:["tiancheng_more","tiancheng_less"],
                subSkill:{
                    more:{
                        audio:"ext:新武将:2",
                        trigger:{
                            player:"compare",
                        },
                        filter:function (event,player){
        return event.getParent().name=='chendun'&&!event.iwhile&&event.num1<=event.num2;
    },
                        content:function (){   
               'step 0'
event.num1=event.card1.number;
event.num2=event.card2.number;
                'step 1'
           if(event.num1<=event.num2)               
               event.num1+=player.maxHp; 
    },
                        sub:true,
                    },
                    less:{
                        audio:"ext:新武将:2",
                        trigger:{
                            player:"compare",
                        },
                        filter:function (event,player){
        return event.getParent().name=='chendun'&&!event.iwhile&&event.num1>event.num2;
    },
                        content:function (){
             'step 0'
event.num1=event.card1.number;
event.num2=event.card2.number; 
              'step 1'                  
       if(event.num1>event.num2)               
               event.num1-=player.maxHp;                   
    },
                        sub:true,
                    },
                },
            },
            chendun:{
                audio:"ext:新武将:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.countCards('h')>0;
    },
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(target);
        "step 1"
        if(result.bool){  
            target.loseMaxHp();
            target.draw(2);                                                   
        }
        else{
            event.target.damage();      
        }
    },
                ai:{
                    order:function (name,player){
            var cards=player.getCards('h');
            if(player.countCards('h','sha')==0){
                return 1;
            }
            for(var i=0;i<cards.length;i++){
                if(cards[i].name!='sha'&&cards[i].number>11&&get.value(cards[i])<7){
                    return 9;
                }
            }
            return get.order({name:'sha'})-1;
        },
                    result:{
                        player:function (player){
                if(player.countCards('h','sha')>0) return 0;
                var num=player.countCards('h');
                if(num>player.hp) return 0;
                if(num==1) return -2;
                if(num==2) return -1;
                return -0.7;
            },
                        target:function (player,target){
                var num=target.countCards('h');
                if(num==1) return -1;
                if(num==2) return -0.7;
                return -0.5
            },
                    },
                    threaten:1.3,
                },
            },
            rechendun:{
                audio:"ext:新武将:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.countCards('h')>0;
    },
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                content:function (){     
        player.chooseToCompare(target).callback=lib.skill.chendun.callback;
    },
                callback:function (){              
        'step 0'
event.num1=event.card1.number;
event.num2=event.card2.number;
if(player.hasSkill('tiancheng')&&event.num1>event.num2||event.num1<=event.num2){
    player.chooseBool('是否发动【天秤】？');
}

'step 1'
  player.logSkill('tiancheng');      
        if(result.bool){ 
           if(event.num1>event.num2)               
               event.num1-=player.maxHp;   
           if(event.num1<=event.num2)               
               event.num1+=player.maxHp;            
        }  
     else{
            event.num1=event.card1.number;
            event.num2=event.card2.number;
        }
       'step 2'  
       
       if(event.num1>event.num2){
           event.target.loseMaxHp();            
           event.target.draw(2);   
      }
        else{
            event.target.damage();                   
       }
    },
                ai:{
                    order:function (name,player){
            var cards=player.getCards('h');
            if(player.countCards('h','sha')==0){
                return 1;
            }
            for(var i=0;i<cards.length;i++){
                if(cards[i].name!='sha'&&cards[i].number>11&&get.value(cards[i])<7){
                    return 9;
                }
            }
            return get.order({name:'sha'})-1;
        },
                    result:{
                        player:function (player){
                if(player.countCards('h','sha')>0) return 0;
                var num=player.countCards('h');
                if(num>player.hp) return 0;
                if(num==1) return -2;
                if(num==2) return -1;
                return -0.7;
            },
                        target:function (player,target){
                var num=target.countCards('h');
                if(num==1) return -1;
                if(num==2) return -0.7;
                return -0.5
            },
                    },
                    threaten:3,
                },
            },
        },
        translate:{
            "蛮王":"蛮王",
            "蛮王_info":"锁定技，你的手牌上限为3，你当主公时不增加体力上限。",
            baoxing:"爆星",
            "baoxing_info":"出牌阶段限一次，你可将三张相同花色的手牌当[南蛮入侵]使用",
            xiangfu:"降服",
            "xiangfu_info":"觉醒技，回合开始阶段，若你的体力上限为7，你立即死亡。",
            xiongqi:"雄起",
            "xiongqi_info":"非限定技，当你处于濒死状态时，你可以丢弃你判定区里的牌，并重置你的武将牌，然后摸1张牌且体力回至体力上限，然后加一体力上限。",
            "guanxing_jiangwei":"继志",
            "guanxing_jiangwei_info":"每当你受到一次伤害后，你可以观看牌堆顶的4张牌，并将其以任意顺序置于牌堆项或牌堆底，然后你摸一张牌。",
            "tiaoxin_jiangwei":"挑衅",
            "tiaoxin_jiangwei_info":"出牌阶段，你可以指定一名使用【杀】能攻击到你的角色，该角色需对你使用一张【杀】，若该角色不如此做，你弃掉他的一张牌，每回合限一次。",
            retianzhao:"天照",
            "retianzhao_info":"出牌阶段你可将普通杀当火杀使用",
            lunhui:"轮回",
            "lunhui_info":"限定技，出牌阶段你可弃置两张[桃]并选择一名已阵亡角色，令其复活，其体力回复至X，并摸X张的牌（X为该角色的体力上限），然后你将你的武将牌翻面",
            tianyin:"天引",
            "tianyin_info":"回合结束阶段限一次，你可以随机获得每名角色区域内的一张牌，然后你将你的武将牌翻面",
            yuedu:"月读",
            "yuedu_info":"出牌阶段限一次，你可选择一名角色进行拼点，若你赢，则该角色翻面，并且直到回合结束，你与该角色距离为1，其非锁定技失效，不能使用或打出牌。",
            xuzuo:"须佐",
            "xuzuo_info":"锁定技，你的手牌上限+1，当你有手牌时，防止受到属性伤害，无手牌时防止受到非属性伤害。",
            jugong:"居功",
            "jugong_info":"回合外每名角色的回合限一次，每当场上有角色因受到【杀】或【决斗】造成的伤害，你可以摸一张牌并且将一张手牌置于你的武将牌上，称之为“功”。在你即将受到伤害时，你可以弃置两张“功”，防止此伤害。",
            liangji:"环计",
            "liangji_info":"出牌阶段限一次，你可以选择一名其他角色并将一张手牌置于其武将牌上。目标角色于摸牌阶段开始时，获得此牌。若其为男性角色，则获得技能【无双】，若其为女性角色，则获得技能【离间】，直到回合结束。",
            chengmou:"逞谋",
            "chengmou_info":"摸牌阶段开始时，若你有“功”牌，你获得之，若你所获得的“功”牌多于两张，你须失去一点体力。",
            tianzheng:"天征",
            "tianzheng_info":"当你即将受到伤害，若伤害来源体力比你高，你可弃置一张黑色手牌令伤害-1，当你即将造成伤害，若对方体力值比你高，你可弃置一张红色手牌令此伤害+1",
            baiyan:"白眼",
            "baiyan_info":"出牌阶段限一次，你可以观看一名角色的手牌，然后你可以获得其中一张红桃手牌",
            zhangshu:"掌术",
            "zhangshu_info":"你的回合外，每当你使用、打出、失去或被弃置一张牌时，你立即摸一张牌。",
            shanjie:"闪捷",
            "shanjie_info":"锁定技，你的防御距离始终+1。回合内你使用的牌可选择距离不大于此牌点数的目标",
            luoxuan:"螺旋",
            "luoxuan_info":"出牌阶段，你可以将任意一张装备牌当做任意一张普通锦囊牌使用，每阶段限一次。",
            yandun:"炎遁",
            "yandun_info":"出牌阶段限一次，你可与一名有手牌的角色进行拼点，若你赢，你观看其手牌并对目标角色造成一点火焰伤害。若你没赢，你可以摸一张牌（这招既可能破鼬的须佐能乎，又可能会被鼬防止，手足羁绊，千丝万缕） ",
            rexuzuo:"须佐",
            "rexuzuo_info":"锁定技，你的手牌上限+1，当你有手牌时，防止受到属性伤害，无手牌时防止受到非属性伤害。",
            qianniao:"千鸟",
            "qianniao_info":"出牌阶段，你使用的普通杀可附带雷属性",
            xianshu:"仙术",
            "xianshu_info":"当你失去最后的手牌时，你可以摸牌补至你当前体力的张数，然后回复一点体力。",
            shazang:"沙葬",
            "shazang_info":"（沙暴大葬）当你使用的【杀】【决斗】【过河拆桥】【顺手牵羊】起码满足以下两个条件之一时：1、为最后一张手牌；2、此时你的体力值为1（一尾守鹤）。你使用的这几类牌可无视距离，并且你可以为这张牌指定至多七名目标角色。",
            juefang:"绝防",
            "juefang_info":"锁定技，当其他玩家使用【杀】指定你为目标时，需额外弃掉一张基本牌，否则该牌对你无效。你防止受到锦囊牌造成的伤害",
            reshenwei:"神威",
            "reshenwei_info":"你可以将任意一张装备牌当【无懈可击】使用（右眼虚化）；当你从背面翻至正面时，你可以弃置一张牌，然后移动场上的一张牌（左眼远距离扭曲空间转移物体）。（四代火影波风水门以装备牌发动锦囊，而宇智波带土以装备牌无懈之，冥冥之中形成克制）",
            xishou:"吸收",
            "xishou_info":"回合结束阶段限一次，你可以弃置一张牌并将你的武将牌翻面，若如此做，你指定一名角色，获得其所有牌。",
            refengyin:"封印",
            "refengyin_info":"限定技，回合结束阶段你可令任意一名角色永久失去当前的所有技能，然后你进入濒死状态。",
            guazhang:"卦掌",
            "guazhang_info":"回合外每当你因使用、打出或被弃置等方式失去一张手牌时，你立即摸一张牌（类似鸣人的仙术）",
            leique:"雷切",
            "leique_info":"出牌阶段，你可以将一张普通【杀】当雷【杀】使用，你使用的雷【杀】可无视目标角色的防具",
            yizhi:"移植",
            "yizhi_info":"锁定技，每当受到伤害时，你随机获得未加入本局游戏的武将的一个技能（主公技、觉醒技除外）。",
            xianfa:"仙法",
            "xianfa_info":"当你失去最后的手牌时，你可以摸一张牌，然后回复一点体力。",
            zhuansheng:"转生",
            "zhuansheng_info":"出牌阶段限一次，你可弃置一张【桃】并选择一名已阵亡角色，令其复活，其体力回复至2，并摸两张的牌，然后你失去一点体力上限",
            fenshen:"分身",
            "fenshen_info":"出牌阶段限一次，你可以用一张手牌与至多三名角色同时拼点，然后依次结算拼点结果，没赢的角色选择一项：1.弃置一张牌并受到你造成的一点伤害；2.令你摸两张牌，然后你失去一点体力。若拼点没赢的角色是你，你可选择摸两张牌并失去一点体力或弃置一张牌并对目标造成一点伤害，并且你获得一个“影分身”标记（表示你发动的影分身已阵亡，若你有9个或以上的影分身标记时，你因耗尽九尾的查克拉而立即死亡）",
            xianyan:"献眼",
            "xianyan_info":"当你死亡时，可令一名其他角色随机获得你的除此技能外的另一项其他技能，然后该角色回复一点体力。",
            "横剑":"横剑",
            "横剑_info":"出牌阶段，你可以将两张杀当杀使用，此杀无视距离，可以指定任意名目标且有50%的机率伤害+1",
            bamen:"八门",
            "bamen_info":"锁定技，出牌阶段开始时，若你的体力值为4或更少，你视为拥有技能“马术”（朝孔雀）；若你的体力值为3或更少，你视为拥有技能“咆哮”（昼虎，虎哮山林）；若你的体力值为2或更少；你视为拥有技能“伏骑”（夕象，骑象伏击无人挡）；若你的体力值为1，你视为拥有技能“暗箭”（夜凯，暗夜放箭凯旋归）",
            fuzhi:"复制",
            "fuzhi_info":"游戏开始所有角色摸牌后、准备阶段开始前和结束阶段，你可以选择一名存活角色，获得其所有技能，直到下一次更改（主公技、限定技、觉醒技、部分能引起冲突（比如时机冲突）的技能除外，还有回合结束选择的角色与回合开始前选的一致时会失败，原因未知）",
            resizhan:"死战",
            "resizhan_info":"（八门遁甲之死门）限定技，出牌阶段开始前，你可以摸8张牌，然后你的体力上限调整至1",
            tiancheng:"天秤",
            "tiancheng_info":"当你发动“尘遁”拼点的牌亮出后，若点数小于X，你可令点数+X（超重岩之术）；若点数大于X，你可令点数－X（超轻岩之术），（X为你的体力上限）   （注：该技能未弄好）",
            chendun:"尘遁",
            "chendun_info":"出牌阶段限一次，你可与一名有手牌的角色进行拼点，若你赢，目标角色失去一点体力上限，并摸两张牌。若你没赢，目标角色受到一点伤害（注：该技能后续可能会改进修改）",
            rechendun:"尘遁！",
            "rechendun_info":"出牌阶段限一次，你可与一名有手牌的角色进行拼点，若你赢，目标角色失去一点体力上限，并摸两张牌。若你没赢，目标角色受到一点伤害",
        },
    },
},files:{"character":["大野木.jpg"],"card":[],"skill":[]}}})