game.import("extension",{name:"千秋万载",content:function (config,pack){
    
},precontent:function (){
    
},help:{"千秋万载":"<ul type=\"circle\"><li>一统江山的前传</li><li>暂由苍雪代替孤城更新</li><li>反馈bug已经各种拓展问题请加群</li>【拓展说明】<br/><br/><li>[本次更新]本次2017.3.24.更新了当涂掌事,折冲将军,英姿雄发,烈焰燃天,舞动生花等武将,千秋万载正式完结！,体验本拓展请关闭兼容模式不然部分代码失效，将会影响体验</li><li>群号：无名杀拓展交流群 113606756 </ul>"},config:{},package:{
    character:{
        character:{
            qqwz玉蟾仙子:["female","qun",6,["qqwz_舞月","qqwz_离月"],["des:东汉大学校花,全名\"玛丽莲·貂蝉\",女神中的女神,引无数大佬为其疯狂.与吕布,董卓,关羽,都传出过绯闻"]],
            qqwz斩将攫石:["male","qun",7,["qqwz_魔将"],["des:东汉大学保安队副队长,经常借故敲诈勒索学生,某天晚上眼瞎敲诈到醉酒的关羽头上,被撒酒疯的二爷乱刀砍死"]],
            qqwz幻惑众心:["male","qun",6,["qqwz_惑心"],["des:三大传奇魔术师之一，原在东吴居民小区安家，曾多次拉拢和蛊惑当地住户，某天江东派出所小霸王孙策带队拆迁，其蛊惑当地民众造反后被小霸王揍到生活不能自理而死"]],
            qqwz雷鸣天启:["male","qun",7,["qqwz_雷鸣","qqwz_天道","qqwz_苍天已死"],["zhu","des:自称网瘾治疗专家,人称\"张叫兽\",独创一套电击洗脑驱除网瘾疗法,骗了不少被电傻的小学生家长的血汗钱"]],
            qqwz专擅朝政:["male","qun",9,["qqwz_酗酒","qqwz_色欲","qqwz_掌权","qqwz_暴凌"],["zhu","des:东汉大学教导主人,极具政治野心,不折手段图谋篡夺校长宝座.脸厚心黑贪财好色,传言包养了多位小蜜"]],
            qqwz经达权变:["male","qun",7,["qqwz_绝命","qqwz_危局","qqwz_暗幕"],["des:原在京城经营害虫放治公司,为垄断城内灭鼠行业多次使用老鼠药毒翻竞争对手,从而获得外号\"毒士\""]],
            qqwz汉末龙裔:["male","qun",7,["qqwz_皇令","qqwz_定数"],["zhu","des:东汉大学少年班学生，深得学姐们喜爱的小正太,传言是校长的私生子,所以经常被不怀好意者骚扰"]],
            qqwz身陷囹圄:["male","qun",7,["qqwz_谋诛"],["des:汉献帝老丈人，东汉大学班主任之一曾因为曹土豪非法贪污设施而大打出手，后因其下岗"]],
            qqwz月下琵琶:["female","qun",7,["qqwz_离歌","qqwz_月琴","qqwz_长恨"],["des:东汉大学教授蔡邕女儿,博学多才且精通乐器,校园文艺晚会明星女神.毕业在曹氏企业入职,深得曹土豪看重."]],
            qqwz妙笔为龙:["male","qun",7,["qqwz_万化","qqwz_归魂","qqwz_仙道"],["des:三大传奇魔术师之一,精通各种幻术和逃脱术,多次以神乎其技的魔术戏耍各方大佬,长期位于黑道悬赏榜前列."]],
            qqwz登极至尊:["male","qun",8,["qqwz_谋篡","qqwz_妄尊"],["zhu","des:袁绍表弟,比表哥更加狂妄和自大的袁二代,曾妄图去曹操手中抢地盘,当晚就被打得生活不能自理."]],
            qqwz西凉猛狮:["male","qun",8,["qqwz_狮枪"],["zhu","des:东汉大学毕业生，由于无事可做在塞外巷子当起了混混，曾随着老爹和大叔韩遂一起去东汉大学闹事"]],
            qqwz真龙之意:["male","qun",7,["qqwz_升龙","qqwz_飞燕","qqwz_排兵"],["des:东汉大学毕业生，曾是白马小王子公孙瓒的手下之一，后因其小王子和袁氏抢地盘失败，而跳槽的刘氏企业家门下"]],
            qqwz斜倚凤榻:["female","qun",7,["qqwz_蝎心","qqwz_乱政"],[]],
            qqwz豪贵名门:["male","qun",8,["qqwz_箭阵","qqwz_名门"],["zhu","des:出身名门贵族的高干子弟,原北方最大地下势力的统治者,为人刚腹自用且鼠目寸光,后被新贵曹土豪击败取代之"]],
            qqwz披坚持锐:["male","qun",8,["qqwz_虎狼"],["des:颜良:原是袁绍手下小弟,老大扑街后,和基友颜良在大学城附近开流动烧烤店,经常以次充好坑坏了不少好学生的肚子;文丑:和好基友颜良一起早开黑心烧烤坑学生钱,某天让出来吃夜宵的关羽狂拉了3天,被暴走的二爷掀翻了摊子痛殴"]],
            qqwz驭魂千机:["female","qun",8,["qqwz_傀儡","qqwz_驭魂"],["des:奴家一切仰仗将军了，介绍什么的没必要看了"]],
            qqwz不鏖遗民:["male","qun",7,["qqwz_舍粮","qqwz_渡世","qqwz_顺道"],[]],
            qqwz陷阵克敌:["male","qun",8,["qqwz_将酒","qqwz_破敌"],["des:东汉大学保安队小头目，吕布的忠诚小弟，曾多次冲锋陷阵捣毁其他高校的宿舍，多次帮助吕布当板擦"]],
            qqwz拿刀动杖:["male","qun",7,["qqwz_篱下","qqwz_散财"],[]],
            qqwz坐也思君:["female","qun",6,["qqwz_计筹","qqwz_星蝶"],[]],
            qqwz一战而就:["male","qun",7,["qqwz_策定","qqwz_殉道"],["des:东汉大学保安队首席狗头军师，严重癌症晚期，层曾为吕布出谋划策，后因为对女人的审美二跳槽到曹土豪手下"]],
            qqwz威仪雍容:["male","qun",7,["qqwz_繁华","qqwz_汉室"],["zhu"]],
            qqwz孤注一掷:["female","qun",6,["qqwz_威视","qqwz_牵连"],[]],
            qqwz烈火焚城:["male","qun",7,["qqwz_抵命","qqwz_毒谋","qqwz_火牢","qqwz_火刑","qqwz_破计","qqwz_诛族"],[]],
            qqwz监军谋国:["male","qun",7,["qqwz_缓图","qqwz_鸿鹄"],[]],
            qqwz眉颦笑浅:["female","qun",7,["qqwz_隔墙","qqwz_投曹"],[]],
            qqwz独饮醉卧:["male","qun",8,["qqwz_罪业"],["zhu"]],
            qqwz目语额瞬:["male","qun",7,["qqwz_推卸","qqwz_谗言"],[]],
            qqwz祸乱朝纲:["male","qun",7,["qqwz_乱国"],[]],
            qqwz夜袭许昌:["male","qun",7,["qqwz_并起"],[]],
            qqwz师表海内:["male","qun",6,["qqwz_让梨","qqwz_儒门"],[]],
            qqwz计权合变:["male","qun",6,["qqwz_秉忠","qqwz_孤援"],[]],
            qqwz淯水香魂:["female","qun",6,["qqwz_妖艳","qqwz_醉魂"],[]],
            qqwz善战无前:["male","qun",9,["qqwz_战神","qqwz_无前"],[]],
            qqwz威震塞外:["male","qun",8,["qqwz_进击","qqwz_白马"],["zhu","des:混血贵族小王子，东汉大学诸多校草的公敌，靠着英俊外表和首先白马帮小弟霸占教学楼，后与袁氏企业抢地盘而失败落幕"]],
            qqwz吴王光耀:["male","wu",8,["qqwz_英雄","qqwz_急援","qqwz_权衡"],["zhu"]],
            qqwz披星踏浪:["male","wu",7,["qqwz_踏浪"],[]],
            qqwz赤壁破曹:["male","wu",7,["qqwz_雄发","qqwz_揣测"],[]],
            qqwz望君早归:["female","wu",6,["qqwz_焦凤","qqwz_流年"],[]],
            qqwz魅影剑舞:["female","wu",7,["qqwz_鸳鸯","qqwz_影剑"],[]],
            qqwz矫情之花:["female","wu",6,["qqwz_绿荫","qqwz_花落"],[]],
            qqwz豪饮鲸吞:["male","wu",7,["qqwz_铁壁","qqwz_冷血","qqwz_奋命"],["forbidai"]],
            qqwz笃烈之士:["male","wu",8,["qqwz_烈士","qqwz_酣战"],[]],
            qqwz魂佑江东:["male","wu",5,["qqwz_睥睨","qqwz_魂佑"],["zhu"]],
            qqwz策马扬鞭:["male","wu",7,["qqwz_转日","qqwz_军霸2","qqwz_卧虎"],["zhu"]],
            qqwz缔造联盟:["male","wu",6,["qqwz_联盟","qqwz_人杰","qqwz_施财"],[]],
            qqwz辅国安邦:["male","wu",6,["qqwz_明谏","qqwz_修政"],[]],
            qqwz并蒂芙蓉:["female","wu",7,["qqwz_芙蓉","qqwz_沉鱼"],[]],
            qqwz东兴大捷:["male","wu",7,["qqwz_狂傲","qqwz_杀令","qqwz_举国"],[]],
            qqwz才猷蕴借:["male","wu",6,["qqwz_合纵","qqwz_连横","qqwz_料敌"],[]],
            qqwz杀身成仁:["male","wu",10,["qqwz_致死","qqwz_引敌"],[]],
            qqwz药坛圣手:["male","qun",5,["qqwz_医心","qqwz_去病"],[]],
            qqwz神行太保:["male","wu",7,["qqwz_冷兵","qqwz_迅疾"],[]],
            qqwz刹那芳华:["female","wu",6,["qqwz_年华","qqwz_朝露"],[]],
            qqwz溺酒残戮:["male","wu",8,["qqwz_残戮","qqwz_血仇","qqwz_丧命"],["zhu"]],
            qqwz豪情烈胆:["male","wu",7,["qqwz_凌风","qqwz_御风"],[]],
            qqwz德隆望重:["female","wu",5,["qqwz_携手","qqwz_招亲"],[]],
            qqwz胆略器用:["male","wu",7,["qqwz_镇军"],[]],
            qqwz缘后雅志:["female","wu",6,["qqwz_定心","qqwz_魂忆"],[]],
            qqwz醉酒提矛:["male","wu",8,["qqwz_佳酿","qqwz_烈火"],[]],
            qqwz旋击敌寇:["male","wu",8,["qqwz_弓彰","qqwz_直入"],[]],
            qqwz伏路断道:["male","wu",7,["qqwz_毒箭","qqwz_缴械","qqwz_亡箭","qqwz_擒拿"],[]],
            qqwz倚虎弄权:["female","wu",7,["qqwz_矜持","qqwz_毁誉"],[]],
            qqwz狂直之士:["male","wu",7,["qqwz_耿直","qqwz_妙玄"],[]],
            qqwz傲世轻物:["male","wu",6,["qqwz_诱饵"],[]],
            qqwz赞国经纶:["male","wu",6,["qqwz_秉正","qqwz_慎重"],[]],
            qqwz安国将军:["male","wu",8,["qqwz_安邦"],[]],
            qqwz临阵献策:["male","wu",7,["qqwz_阵邀","qqwz_相助"],[]],
            qqwz志善好学:["male","wu",8,["qqwz_善学","qqwz_鸿宴","qqwz_王召"],["zhu"]],
            qqwz少年才俊:["male","wu",7,["qqwz_善民"],[]],
            qqwz饕餮盛宴:["male","wu",6,["qqwz_奢豪","qqwz_罪责"],[]],
            qqwz当涂掌事:["male","wu",10,["qqwz_伺机","qqwz_白衣"],[]],
            qqwz折冲将军:["male","wu",8,["qqwz_锦帆","qqwz_合围"],[]],
            qqwz英姿雄发:["male","wu",9,["qqwz_霸业","qqwz_控局","qqwz_谋策"],[]],
            qqwz骁勇虎将:["male","wu",8,["qqwz_牺牲","qqwz_诈曹"],[]],
            qqwz烈焰燃天:["male","wu",8,["qqwz_赤焰","qqwz_雅逊"],[]],
            qqwz舞动生花:["female","wu",7,["qqwz_妙心","qqwz_娇啸"],[]],
        },
        translate:{
            qqwz玉蟾仙子:"玉蟾仙子",
            qqwz斩将攫石:"斩将攫石",
            qqwz幻惑众心:"幻惑众心",
            qqwz雷鸣天启:"雷鸣天启",
            qqwz专擅朝政:"专擅朝政",
            qqwz经达权变:"经达权变",
            qqwz汉末龙裔:"汉末龙裔",
            qqwz身陷囹圄:"身陷囹圄",
            qqwz月下琵琶:"月下琵琶",
            qqwz妙笔为龙:"妙笔为龙",
            qqwz登极至尊:"登极至尊",
            qqwz西凉猛狮:"西凉猛狮",
            qqwz真龙之意:"真龙之意",
            qqwz斜倚凤榻:"斜倚凤榻",
            qqwz豪贵名门:"豪贵名门",
            qqwz披坚持锐:"披坚持锐",
            qqwz驭魂千机:"驭魂千机",
            qqwz不鏖遗民:"不鏖遗民",
            qqwz陷阵克敌:"陷阵克敌",
            qqwz拿刀动杖:"拿刀动杖",
            qqwz坐也思君:"坐也思君",
            qqwz一战而就:"一战而就",
            qqwz威仪雍容:"威仪雍容",
            qqwz孤注一掷:"孤注一掷",
            qqwz烈火焚城:"烈火焚城",
            qqwz监军谋国:"监军谋国",
            qqwz眉颦笑浅:"眉颦笑浅",
            qqwz独饮醉卧:"独饮醉卧",
            qqwz目语额瞬:"目语额瞬",
            qqwz祸乱朝纲:"祸乱朝纲",
            qqwz夜袭许昌:"夜袭许昌",
            qqwz师表海内:"师表海内",
            qqwz计权合变:"计权合变",
            qqwz淯水香魂:"淯水香魂",
            qqwz善战无前:"善战无前",
            qqwz威震塞外:"威震塞外",
            qqwz吴王光耀:"吴王光耀",
            qqwz披星踏浪:"披星踏浪",
            qqwz赤壁破曹:"赤壁破曹",
            qqwz望君早归:"望君早归",
            qqwz魅影剑舞:"魅影剑舞",
            qqwz矫情之花:"矫情之花",
            qqwz豪饮鲸吞:"豪饮鲸吞",
            qqwz笃烈之士:"笃烈之士",
            qqwz魂佑江东:"魂佑江东",
            qqwz策马扬鞭:"策马扬鞭",
            qqwz缔造联盟:"缔造联盟",
            qqwz辅国安邦:"辅国安邦",
            qqwz并蒂芙蓉:"并蒂芙蓉",
            qqwz东兴大捷:"东兴大捷",
            qqwz才猷蕴借:"才猷蕴借",
            qqwz杀身成仁:"杀身成仁",
            qqwz药坛圣手:"药坛圣手",
            qqwz神行太保:"神行太保",
            qqwz刹那芳华:"刹那芳华",
            qqwz溺酒残戮:"溺酒残戮",
            qqwz豪情烈胆:"豪情烈胆",
            qqwz德隆望重:"德隆望重",
            qqwz胆略器用:"胆略器用",
            qqwz缘后雅志:"缘后雅志",
            qqwz醉酒提矛:"醉酒提矛",
            qqwz旋击敌寇:"旋击敌寇",
            qqwz伏路断道:"伏路断道",
            qqwz倚虎弄权:"倚虎弄权",
            qqwz狂直之士:"狂直之士",
            qqwz傲世轻物:"傲世轻物",
            qqwz赞国经纶:"赞国经纶",
            qqwz安国将军:"安国将军",
            qqwz临阵献策:"临阵献策",
            qqwz志善好学:"志善好学",
            qqwz少年才俊:"少年才俊",
            qqwz饕餮盛宴:"饕餮盛宴",
            qqwz当涂掌事:"当涂掌事",
            qqwz折冲将军:"折冲将军",
            qqwz英姿雄发:"英姿雄发",
            qqwz骁勇虎将:"骁勇虎将",
            qqwz烈焰燃天:"烈焰燃天",
            qqwz舞动生花:"舞动生花",
        },
    },
    card:{
        card:{
        },
        translate:{
        },
        list:[],
    },
    skill:{
        skill:{
            qqwz_舞月:{
                audio:["qqwz舞月",2],
                trigger:{
                    player:"phaseEnd",
                },
                frequent:true,
                content:function (){
         'step 0'
        var card=get.cardPile(function(card){
            return get.type(card)=='trick';
        });
        event.card=card;
        'step 1'
        if(event.card){
             player.gain(game.createCard(event.card),'gain2');
            player.gain(game.createCard(event.card),'gain2');
        }
    },
            },
            qqwz_离月:{
                audio:["qqwz离月",2],
                enable:"phaseUse",
                usable:3,
                filter:function (event,player){
        var num=0;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i]!=player) num++
        }
        return (num>1)
    },
                check:function (card){return 10-ai.get.value(card)},
                filterCard:true,
                position:"he",
                filterTarget:function (card,player,target){
        if(player==target) return false;
        if(ui.selected.targets.length==1){
            return target.canUse({name:'juedou'},ui.selected.targets[0]);
        }
        return true;
    },
                targetprompt:["先出杀","后出杀"],
                selectTarget:2,
                multitarget:true,
                content:function (){
        targets[1].useCard({name:'juedou'},targets[0],'noai').animate=false;
        game.delay(0.5);
        player.draw();
        player.recover();
    },
                ai:{
                    order:8,
                    result:{
                        target:function (player,target){
                if(ui.selected.targets.length==0){
                    return -3;
                }
                else{
                    return ai.get.effect(target,{name:'juedou'},ui.selected.targets[0],target);
                }
            },
                    },
                    expose:0.4,
                    threaten:3,
                },
            },
            qqwz_魔将:{
                audio:["qqwz魔将",2],
                group:"qqwz_魔将2",
                trigger:{
                    player:"damageEnd",
                },
                content:function (){
         "step 0"
         if(!trigger.source.hasSkill('fengyin')){
            trigger.source.addTempSkill('fengyin','phaseAfter');
        }
        "step 1"
       player.recover();
       trigger.source.loseMaxHp();
},
            },
            qqwz_魔将2:{
                audio:["qqwz魔将",2],
                trigger:{
                    source:"damageBefore",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player&&Math.random()<=0.2;
},
                content:function (){
trigger.player.die(); 
},
            },
            qqwz_惑心:{
                enable:"phaseUse",
                audio:["qqwz惑心",2],
                filter:function (event,player){
        return player.num('h')>0
    },
                chooseButton:{
                    dialog:function (){
            var list=['sha','shan','tao','jiu','tianxianjiu','huosha','leisha','fengyinzhidan'];
            for(var i=0;i<list.length;i++){
                list[i]=['basic','',list[i]];
            }
            var list2=['taoyuan','wugu','juedou','huogong','jiedao','tiesuo','guohe','shunshou','wuzhong','wanjian','nanman','zengbin','jingleishan','chiyuxi','huoshaolianying'];
            for(var i=0;i<list2.length;i++){
                list2[i]=['trick','',list2[i]];
            }
            var dialog=ui.create.dialog();
            dialog.addText('蛊惑·基本牌');
            dialog.add([list,'vcard']);
            dialog.addText('蛊惑·锦囊牌');
            dialog.add([list2,'vcard']);
            return dialog;
        },
                    filter:function (button,player){
            return lib.filter.filterCard({name:button.link[2]},player,_status.event.getParent());
        },
                    check:function (button){
            var player=_status.event.player;
            if(Math.random()<0.5){
                var hcard=player.get('h',function(card){
                    return get.suit(card)=='heart';
                });
                for(var i=0;i<hcard.length;i++){
                    if(lib.filter.filterCard(hcard[i])) return button.link[2]==hcard[i].name?1:0;
                }
                return button.link[2]=='sha'?3:0;
            }
            else{
                var rate=Math.random();
                if(player.num('h','sha')&&rate<0.6){
                    return button.link[2]=='sha'?1:0;
                }
                if(player.hp<player.maxHp){
                    if(sgs.isWeak(player)&&player.num('h',{name:'tao',suit:'heart'})) return button.link[2]=='tao'?5:0;
                    if(player.num('h','tao')&&rate<0.6) return button.link[2]=='tao'?2:0;
                }
                if(player.num('h','jiu')&&rate<0.4){
                    return button.link[2]=='jiu'?3:0;
                }
                if(player.num('h','taoyuan')&&rate<0.8){
                    return button.link[2]=='taoyuan'?9:0;
                }
                if(player.num('h','wugu')&&rate<0.8){
                    return button.link[2]=='wugu'?3:0;
                }
                if(player.num('h','juedou')&&rate<0.4){
                    return button.link[2]=='juedou'?5:0;
                }
                if(player.num('h','huogong')&&rate<0.8){
                    return button.link[2]=='huogong'?1:0;
                }
                if(player.num('h','jiedao')&&rate<0.3){
                    return button.link[2]=='jiedao'?8:0;
                }
                if(player.num('h','tiesuo')&&rate<0.2){
                    return button.link[2]=='tiesuo'?7:0;
                }
                if(player.num('h','guohe')&&rate<0.4){
                    return button.link[2]=='guohe'?7.6:0;
                }
                if(player.num('h','shunshou')&&rate<0.4){
                    return button.link[2]=='shunshou'?7.5:0;
                }
                if(player.num('h','wuzhong')&&rate<0.8){
                    return button.link[2]=='wuzhong'?7.2:0;
                }
                if(player.num('h','wanjian')&&rate<0.5){
                    return button.link[2]=='wanjian'?9:0;
                }
                if(player.num('h','nanman')&&rate<0.2){
                    return button.link[2]=='nanman'?9:0;
                }
                return button.link[2]=='sha'?1:0;
            }
        },
                    backup:function (links,player){
            return {
                filterCard:true,
                selectCard:1,
                audio:["qqwz惑心",2],
                popname:true,
                ai1:function(card){
                    if(Math.random()<0.7) return card.name==links[0][2];
                    return 4-ai.get.value(card);
                },
                viewAs:{name:links[0][2]},
                onuse:function(result,player){
                    var card=result.cards[0];
                    player.storage.qqwz_惑心=card.copy();
                    card.name='qqwz_惑心';
                    card.suit=null;
                    card.number=null;
                }
            }
        },
                    prompt:function (links,player){
            return '将一张手牌当'+get.translation(links[0][2])+'使用';
        },
                },
                ai:{
                    order:10,
                    result:{
                        player:1,
                    },
                    threaten:1.5,
                },
                group:["qqwz_惑心_begin","qqwz_惑心_ing","qqwz_惑心_end","qqwz_惑心_sha","qqwz_惑心_save","qqwz_惑心_wuxie","qqwz_惑心_respond","qqwz_惑心2"],
                subSkill:{
                    begin:{
                        trigger:{
                            player:"useCardBegin",
                        },
                        popup:false,
                        forced:true,
                        filter:function (event){
                return event.skill=='qqwz_惑心_backup'||event.skill=='qqwz_惑心_sha'||event.skill=='qqwz_惑心_save'||event.skill=='qqwz_惑心_wuxie';
            },
                        content:function (){
                trigger.animate=false;
                var card=trigger.card;
                var event=_status.event;
                var targets=trigger.targets;
                if(card.name=='wuxie'&&event.getParent().source){
                    var lining=event.getParent().sourcex||event.getParent().source2||event.getParent().source;
                    if(lining==player&&event.getParent().sourcex2){
                        lining=event.getParent().sourcex2;
                    }
                    if(Array.isArray(lining)&&event.getTrigger().name=='jiedao'){
                        player.line(lining[0],'green');
                    }
                    else{
                        player.line(lining,'green');
                    }
                }
                else{
                    var config={};
                    if(card.nature=='fire'||
                        (card.classList&&card.classList.contains('fire'))){
                        config.color='fire';
                    }
                    else if(card.nature=='thunder'||
                        (card.classList&&card.classList.contains('thunder'))){
                        config.color='thunder';
                    }
                    if(get.info(card).multitarget&&targets.length>1&&!get.info(card).multiline){
                        player.line2(targets,config);
                    }
                    else{
                        player.line(targets,config);
                    }
                }
            },
                    },
                    ing:{
                        trigger:{
                            player:["useCard"],
                        },
                        filter:function (event){
                return event.skill=='qqwz_惑心_backup'||event.skill=='qqwz_惑心_sha'||event.skill=='qqwz_惑心_save'||event.skill=='qqwz_惑心_wuxie';
            },
                        popup:false,
                        forced:true,
                        content:function (){
                'step 0'
                var cardx=player.storage.qqwz_惑心;
                var card=game.createCard(cardx.name,cardx.suit,cardx.number);
                var node1=player.$throw(card);
                node1.classList.add('infohidden');
                node1.classList.add('infoflip');
                ui.refresh(node1);
                event.node1=node1;
                event.targets=game.players.slice(0);
                event.targets.remove(player);
                event.targets.sort(lib.sort.seat);
                event.check=false;
                event.惑心card=card;
                event.nobelieve=[];
                'step 1'
                if(event.targets.length){
                    var target=event.targets.shift();
                    event.target=target;
                    event.target.chooseBool('惑心:'+get.translation(player)+'声称这张牌是'+get.translation(trigger.card.name)+',是否质疑?').ai=function(){
                        if(sgs.isFriend(event.target,player)){
                            if(sgs.isWeak(event.target)&&Math.random()<0.9) return false;
                            if(sgs.getKnownCard(player,event.target,trigger.card.name)>0) return false;
                            if(ai.get.value(trigger.card)>6) return false;
                            if(sgs.isWeak(player)) return false;
                            if(Math.random()<0.3) return true;
                            return false;
                        }
                        else{
                            if(sgs.isWeak(event.target)) return false;
                            if(sgs.getKnownCard(player,event.target,trigger.card.name)>0) return false;
                            if(ai.get.value(trigger.card)>6) return true;
                            if(sgs.isWeak(player)&&Math.random()<0.7) return true;
                            if(Math.random()<0.15) return true;
                            return false;
                        }
                        return false;
                    };
                }
                else{
                    event.goto(3);
                }
                'step 2'
                if(result.bool){
                    event.check=true;
                    event.target.popup('质疑!');
                    game.log(event.target,'质疑');
                    event.nobelieve=event.nobelieve.concat(event.target);
                }
                else{
                    event.target.popup('不质疑!');
                    game.log(event.target,'不质疑');
                }
                game.delay(1);
                event.goto(1);
                'step 3'
                if(event.check){
                    node1=event.node1;
                    setTimeout(function(){
                        node1.style.transition='all ease-in 0.2s';
                        node1.style.transform='perspective(600px) rotateY(90deg) translateX(52px)';
                        var onEnd=function(){
                            node1.classList.remove('infohidden');
                            node1.style.transition='all 0s';
                            ui.refresh(node1);
                            node1.style.transform='perspective(600px) rotateY(-90deg) translateX(52px)';
                            ui.refresh(node1);
                            node1.style.transition='';
                            ui.refresh(node1);
                            node1.style.transform='';
                            node1.removeEventListener('webkitTransitionEnd',onEnd);
                        }
                        node1.addEventListener('webkitTransitionEnd',onEnd);
                    },200);
                    ui.refresh(node1);
                    game.delay();
                    if(trigger.card.name==event.惑心card.name){
                        event.check=true;
                        if(get.suit(event.惑心card)!='heart'){
                            trigger.untrigger();
                            trigger.finish();
                            player.stat[player.stat.length-1].card[trigger.card.name]--;
                        }    
                    }
                    else{
                        event.check=false;
                        trigger.untrigger();
                        trigger.finish();
                        player.stat[player.stat.length-1].card[trigger.card.name]--;
                    }
                }
                else{
                    event.finish();
                }
                'setp 4'
                if(event.nobelieve&&event.nobelieve.length){
                    if(event.check){
                        for(var i=0;i<event.nobelieve.length;i++){
                            event.nobelieve[i].loseHp(2);
                            player.draw();
                        }
                    }
                    else{
                        for(var i=0;i<event.nobelieve.length;i++){
                            event.nobelieve[i].loseMaxHp(1);
                            player.recover();
                        }
                    }
                }
            },
                    },
                    end:{
                        trigger:{
                            player:"useCardEnd",
                        },
                        priority:-1,
                        popup:false,
                        forced:true,
                        filter:function (event){
                return event.skill=='qqwz_惑心_backup'||event.skill=='qqwz_惑心_sha'||event.skill=='qqwz_惑心_shan'||event.skill=='qqwz_惑心_save'||event.skill=='qqwz_惑心_wuxie';
            },
                        content:function (){
                if(trigger.skill=='qqwz_惑心_backup') ui.clear();
                var cardx=player.storage.qqwz_惑心;
                trigger.card=game.createCard(cardx.name,cardx.suit,cardx.number);
            },
                    },
                    sha:{
                        enable:["chooseToUse"],
                        audio:["qqwz惑心",2],
                        filter:function (event,player){
                return event.parent.name!='phaseUse'&&player.num('h');
            },
                        filterCard:true,
                        selectCard:1,
                        check:function (card){
                var player=_status.event.player;
                if(player.num('h','sha')){
                    if(card.name=='sha'){
                        if(get.suit(card)=='sha') return 8;
                        if(Math.random()<0.8) return 1;
                        return 0;
                    }
                }
                if(Math.random()<0.6) return 4-ai.get.value(card);
                return 0;    
            },
                        viewAs:{
                            name:"sha",
                        },
                        onuse:function (result,player){
                var card=result.cards[0];
                player.storage.qqwz_惑心=card.copy();
                card.name='qqwz_惑心';
                card.suit=null;
                card.number=null;
            },
                        ai:{
                            basic:{
                                useful:[5,1],
                                value:[5,1],
                            },
                            order:function (){
                    if(_status.event.player.hasSkillTag('presha',true,null,true)) return 10;
                    return 3;
                },
                            result:{
                                target:function (player,target){
                        if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                            if(ai.get.attitude(player,target)>0){
                                return -6;
                            }
                            else{
                                return -3;
                            }
                        }
                        return -1.5;
                    },
                            },
                            tag:{
                                respond:1,
                                respondShan:1,
                                damage:function (card){
                        if(card.nature=='poison') return;
                        return 1;
                    },
                                natureDamage:function (card){
                        if(card.nature) return 1;
                    },
                                fireDamage:function (card,nature){
                        if(card.nature=='fire') return 1;
                    },
                                thunderDamage:function (card,nature){
                        if(card.nature=='thunder') return 1;
                    },
                                poisonDamage:function (card,nature){
                        if(card.nature=='poison') return 1;
                    },
                            },
                        },
                    },
                    save:{
                        enable:"chooseToUse",
                        audio:["qqwz惑心",2],
                        filter:function (event,player){
                return event.parent.name!='phaseUse'&&player.num('h')>0;
            },
                        filterCard:true,
                        selectCard:1,
                        viewAs:{
                            name:"tao",
                            suit:"heart",
                            number:12,
                        },
                        check:function (card,event){
                var player=_status.event.player;
                if(player.num('h','tao')){
                    if(card.name=='tao'){
                        if(get.suit(card)=='heart') return 8;
                        if(Math.random()<0.6) return 1;
                        return 0;
                    }
                }
                if(Math.random()<0.6) return 4-ai.get.value(card);
                return 0;
            },
                        onuse:function (result,player){
                var card=result.cards[0];
                player.storage.qqwz_惑心=card.copy();
                card.name='qqwz_惑心';
                card.suit=null;
                card.number=null;
            },
                        ai:{
                            skillTagFilter:function (player){
                    return player.num('h')>0;
                },
                            save:true,
                            basic:{
                                order:function (card,player){
                        if(player.hasSkillTag('pretao')) return 5;
                        return 2;
                    },
                                useful:[8,6.5],
                                value:[8,6.5],
                            },
                            result:{
                                target:function (player,target){
                        // if(player==target&&player.hp<=0) return 2;
                        var nd=player.needsToDiscard();
                        var keep=false;
                        if(nd<=0){
                            keep=true;
                        }
                        else if(nd==1&&target.hp>=2&&target.num('h','tao')<=1){
                            keep=true;
                        }
                        var mode=get.mode();
                        if(target.hp>=2&&keep&&target.hasFriend()){
                            if(target.hp>2||nd==0) return 0;
                            if(target.hp==2){
                                if(game.hasPlayer(function(current){
                                    if(target!=current&&ai.get.attitude(target,current)>=3){
                                        if(current.hp<=1) return true;
                                        if((mode=='identity'||mode=='versus'||mode=='chess')&&current.identity=='zhu'&&current.hp<=2) return true;
                                    }
                                })){
                                    return 0;
                                }
                            }
                        }
                        if(target.hp<0&&target!=player&&target.identity!='zhu') return 0;
                        var att=ai.get.attitude(player,target);
                        if(att<3&&att>=0&&player!=target) return 0;
                        var tri=_status.event.getTrigger();
                        if(mode=='identity'&&player.identity=='fan'&&target.identity=='fan'){
                            if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='fan'&&tri.source!=target){
                                var num=game.countPlayer(function(current){
                                    if(current.identity=='fan'){
                                        return current.num('h','tao');
                                    }
                                });
                                if(num>1&&player==target) return 2;
                                return 0;
                            }
                        }
                        if(mode=='identity'&&player.identity=='zhu'&&target.identity=='nei'){
                            if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='zhong'){
                                return 0;
                            }
                        }
                        if(mode=='stone'&&target.isMin()&&
                        player!=target&&tri&&tri.name=='dying'&&player.side==target.side&&
                        tri.source!=target.getEnemy()){
                            return 0;
                        }
                        return 2;
                    },
                            },
                            tag:{
                                recover:1,
                                save:1,
                            },
                        },
                    },
                    wuxie:{
                        enable:"chooseToUse",
                        audio:["qqwz惑心",2],
                        filter:function (event,player){
                return event.parent.name!='phaseUse'&&player.num('h');
            },
                        filterCard:true,
                        selectCard:1,
                        check:function (card,event){
                var player=_status.event.player;
                if(player.num('h','wuxie')){
                    if(card.name=='wuxie'){
                        if(get.suit(card)=='heart') return 8;
                        if(Math.random()<0.6) return 1;
                        return 0;
                    }
                }
                if(Math.random()<0.6) return 4-ai.get.value(card);
                return 0;
            },
                        viewAs:{
                            name:"wuxie",
                            suit:"spade",
                            number:8,
                        },
                        viewAsFilter:function (player){
                return player.num('h')>0;
            },
                        onuse:function (result,player){
                var card=result.cards[0];
                player.storage.qqwz_惑心=card.copy();
                card.name='qqwz_惑心';
                card.suit=null;
                card.number=null;
            },
                        ai:{
                            basic:{
                                useful:[6,4],
                                value:[6,4],
                            },
                            result:{
                                player:1,
                            },
                            expose:0.2,
                        },
                    },
                    respond:{
                        trigger:{
                            player:"chooseToRespondBegin",
                        },
                        filter:function (event,player){
                if(event.responded) return false;
                return player.num('h');
            },
                        direct:true,
                        content:function (){
                'step 0'
                if(trigger.filterCard({name:'sha'})) event.惑心name='sha';
                else event.惑心name='shan';
                player.chooseCard('需要打出一张'+get.translation(event.惑心name)+','+get.prompt('qqwz_惑心')).ai=function(card){
                    if(player.num('h',event.惑心name)){
                        if(card.name==event.惑心name){
                            if(get.suit(card)=='sha') return 8;
                            if(Math.random()<0.8) return 1;
                            return 0;
                        }
                    }
                    if(Math.random()<0.6) return 4-ai.get.value(card);
                    return 0;
                };
                'step 1'
                if(result.bool){
                    player.logSkill('qqwz_惑心');
                    game.log(player,'声称打出的牌是'+get.translation(event.惑心name));
                    var card=result.cards[0];
                    player.lose(card,ui.special);
                    var node1=player.$throw(card);
                    node1.classList.add('infohidden');
                    node1.classList.add('infoflip');
                    ui.refresh(node1);
                    event.node1=node1;
                    event.targets=game.players.slice(0);
                    event.targets.remove(player);
                    event.targets.sort(lib.sort.seat);
                    event.check=false;
                    event.惑心card=card;
                    event.nobelieve=[];
                }
                else{
                    event.finish();
                }
                'step 2'
                if(event.targets.length){
                    var target=event.targets.shift();
                    event.target=target;
                    event.target.chooseBool('惑心:'+get.translation(player)+'声称这张牌是'+get.translation(trigger.name)+',是否质疑?').ai=function(){
                        if(sgs.isFriend(event.target,player)){
                            if(sgs.isWeak(event.target)&&Math.random()<0.9) return false;
                            if(sgs.getKnownCard(player,event.target,trigger.name)>0) return false;
                            if(ai.get.value(game.createCard(trigger.name),event.target,'raw')>6) return false;
                            if(sgs.isWeak(player)) return false;
                            if(Math.random()<0.3) return true;
                            return false;
                        }
                        else{
                            if(sgs.isWeak(event.target)) return false;
                            if(sgs.getKnownCard(player,event.target,trigger.name)<=0) return true;
                            if(ai.get.value(game.createCard(trigger.name),event.target,'raw')>6) return true;
                            if(sgs.isWeak(player)&&Math.random()<0.7) return true;
                            if(Math.random()<0.15) return true;
                            return false;
                        }
                        return false;
                    };
                }
                else{
                    event.goto(4);
                }
                'step 3'
                if(result.bool){
                    event.check=true;
                    event.target.popup('质疑!');
                    game.log(event.target,'质疑');
                    event.nobelieve=event.nobelieve.concat(event.target);
                }
                else{
                    event.target.popup('不质疑!');
                    game.log(event.target,'不质疑');
                }
                game.delay(1);
                event.goto(2);
                'step 4'
                if(event.check){
                    node1=event.node1;
                    setTimeout(function(){
                        node1.style.transition='all ease-in 0.2s';
                        node1.style.transform='perspective(600px) rotateY(90deg) translateX(52px)';
                        var onEnd=function(){
                            node1.classList.remove('infohidden');
                            node1.style.transition='all 0s';
                            ui.refresh(node1);
                            node1.style.transform='perspective(600px) rotateY(-90deg) translateX(52px)';
                            ui.refresh(node1);
                            node1.style.transition='';
                            ui.refresh(node1);
                            node1.style.transform='';
                            node1.removeEventListener('webkitTransitionEnd',onEnd);
                        }
                        node1.addEventListener('webkitTransitionEnd',onEnd);
                    },200);
                    ui.refresh(node1);
                    game.delay();
                    if(trigger.filterCard({name:event.惑心card.name})){
                        event.check=true;
                        if(get.suit(event.惑心card)=='heart'){
                            trigger.untrigger();
                            trigger.responded=true;
                            trigger.animate=false;
                            trigger.result={
                                bool:true,
                                card:{name:event.惑心name},
                                cards:[event.惑心card],
                            };
                            event.checkreal=true;
                        }
                        else{
                            trigger.untrigger();
                        }
                        
                    }
                    else{
                        event.check=false;
                        trigger.untrigger();
                    }
                }
                else{
                    game.log('无人质疑,蛊惑成功');
                    trigger.untrigger();
                    trigger.responded=true;
                    trigger.animate=false;
                    trigger.result={
                        bool:true,
                        card:{name:event.惑心name},
                        cards:[event.惑心card],
                    };
                    event.finish();
                }
                'step 5'
                if(event.nobelieve&&event.nobelieve.length){
                    if(event.check){
                        game.log('有人质疑,蛊惑成功');
                        for(var i=0;i<event.nobelieve.length;i++){
                            event.nobelieve[i].loseHp(2);
                            player.draw();
                        }
                    }
                    else{
                        game.log('有人质疑,蛊惑失败');
                        for(var i=0;i<event.nobelieve.length;i++){
                            event.nobelieve[i].loseMaxHp(1);
                            player.recover();
                        }
                    }
                }
                'step 6'
                if(!event.checkreal) trigger.trigger('chooseToRespondBegin');
            },
                    },
                },
            },
            qqwz_惑心2:{
                audio:["qqwz惑心",2],
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        if(player.num('h')) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){
        player.draw();
    },
                ai:{
                    threaten:0.8,
                    effect:{
                        target:function (card){
                if(card.name=='guohe'||card.name=='liuxinghuoyu') return 0.5;
            },
                    },
                    noh:true,
                    skillTagFilter:function (player,tag){
            if(tag=='noh'){
                if(player.num('h')!=1) return false;
            }
        },
                },
            },
            qqwz_雷鸣:{
                audio:["qqwz雷鸣",2],
                trigger:{
                    player:"respond",
                },
                filter:function (event,player){
        return event.card.name=='shan';
    },
                direct:true,
                content:function (){
        "step 0";
        player.chooseTarget(get.prompt('qqwz_雷鸣')).ai=function(target){
            return ai.get.damageEffect(target,_status.event.player,_status.event.player,'thunder');
        };
        "step 1"
       if(result.bool){
            player.logSkill('qqwz_雷鸣',result.targets);
            var target=result.targets[0];
            event.target=target;
            target.judge(function(card){
                if(target.hp==target.maxHp){
                    if(get.color(card)=='red') return -1;
                }
                if(get.color(card)=='red') return 1;
                return 0;
            });
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.color){
            if(result.color=='red'){
                event.target.damage(2,'thunder');
                player.recover(2);
            }
            else{
                event.target.damage(4,'thunder');
                player.draw(3);
            }
        }
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'respondShan')){
                    var hastarget=game.hasPlayer(function(current){
                        return ai.get.attitude(target,current)<0;
                    });
                    var be=target.num('e',{color:'black'});
                    if(target.num('h','shan')&&be){
                        if(!target.hasSkill('qqwz_天道')) return 0;
                        return [0,hastarget?target.num('he')/2:0];
                    }
                    if(target.num('h','shan')&&target.num('h')>2){
                        if(!target.hasSkill('qqwz_天道')) return 0;
                        return [0,hastarget?target.num('h')/4:0];
                    }
                    if(target.num('h')>3||(be&&target.num('h')>=2)){
                        return [0,0];
                    }
                    if(target.num('h')==0){
                        return [1.5,0];
                    }
                    if(target.num('h')==1&&!be){
                        return [1.2,0];
                    }
                    if(!target.hasSkill('qqwz_天道')) return [1,0.05];
                    return [1,Math.min(0.5,(target.num('h')+be)/4)];
                }
            },
                    },
                },
            },
            qqwz_天道:{
                audio:["qqwz天道",2],
                trigger:{
                    global:"judge",
                },
                filter:function (event,player){
        return player.num('he')>0;
    },
                direct:true,
                content:function (){
        "step 0"
        player.chooseCard(get.translation(trigger.player)+'的'+(trigger.judgestr||'')+'判定为'+
        get.translation(trigger.player.judging[0])+'，'+get.prompt('qqwz_天道'),'he',function(card){
            return get.color(card);
        }).set('ai',function(card){
            var trigger=_status.event.getTrigger();
            var player=_status.event.player;
            var judging=_status.event.judging;
            var result=trigger.judge(card)-trigger.judge(judging);
            var attitude=ai.get.attitude(player,trigger.player);
            if(attitude==0||result==0) return 0;
            if(attitude>0){
                return result;
            }
            else{
                return -result;
            }
        }).set('judging',trigger.player.judging[0]);
        "step 1"
        if(result.bool){
            player.respond(result.cards,'highlight');
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            player.logSkill('qqwz_天道');
            player.$gain2(trigger.player.judging[0]);
            player.gain(trigger.player.judging[0]);
            trigger.player.judging[0]=result.cards[0];
            if(!get.owner(result.cards[0],'judge')){
                trigger.position.appendChild(result.cards[0]);
            }
            game.log(trigger.player,'的判定牌改为',result.cards[0]);
        }
        "step 3"
        game.delay(2);
    },
                ai:{
                    tag:{
                        rejudge:1,
                    },
                },
            },
            qqwz_苍天已死:{
                audio:["qqwz苍天已死",2],
                group:["qqwz_苍天已死2","qqwz_苍天已死3"],
                trigger:{
                    player:["phaseBefore"],
                },
                content:function (){
        var list=["shandian"];
        player.gain(game.createCard(list.randomGet()));
        player.$draw();
        player.gain(game.createCard(list.randomGet()));      
        player.$draw();
    },
            },
            qqwz_苍天已死2:{
                audio:["qqwz苍天已死",2],
                trigger:{
                    player:"phaseEnd",
                },
                content:function (){
        var list=["shan"];
        player.gain(game.createCard(list.randomGet()));
        player.$draw();
        player.gain(game.createCard(list.randomGet()));      
        player.$draw();
    },
            },
            qqwz_苍天已死3:{
                audio:["qqwz苍天已死",2],
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                unique:true,
                filter:function (event){
        return event.nature=='thunder';
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        player.draw();
    },
                ai:{
                    effect:{
                        target:function (card){
                if(get.tag(card,'fireDamage')){
                    return [0,2];
                }
            },
                    },
                },
            },
            qqwz_虎狼:{
                audio:["qqwz虎狼",2],
                trigger:{
                    player:"phaseDrawBefore",
                },
                check:function (event,player){
        if(player.num('h')>player.hp) return true;
        if(player.num('h')>3) return true;
        return false;
    },
                content:function (){
        "step 0"
        player.draw(3);
        player.judge(ui.special);
        "step 1"
        player.gain(result.card);
        player.$gain2(result.card);
        player.addTempSkill('qqwz_虎狼2','phaseAfter');
        player.storage.qqwz_虎狼=get.color(result.card);
        trigger.untrigger();
        trigger.finish();
    },
            },
            qqwz_虎狼2:{
                audio:["qqwz虎狼",2],
                group:["qqwz_虎狼3","qqwz_虎狼4"],
                enable:"phaseUse",
                viewAs:{
                    name:"juedou",
                    suit:"heart",
                    number:"1",
                },
                filterCard:function (card,player){
        return get.color(card)!=player.storage.qqwz_虎狼;
    },
                check:function (card){
        return 6-ai.get.value(card);
    },
                content:function (){
        player.draw();
        player.recover();
    },
                ai:{
                    basic:{
                        order:10,
                        useful:1,
                        value:4.5,
                    },
                    result:{
                        target:-1.5,
                        player:function (player,target){
                if(ai.get.damageEffect(target,player,target)>0&&ai.get.attitude(player,target)>0&&ai.get.attitude(target,player)>0){
                    return 0;
                }
                var hs1=target.get('h','sha');
                var hs2=player.get('h','sha');
                if(hs1.length>hs2.length+1){
                    return -2;
                }
                var hsx=target.get('h');
                if(hsx.length>2&&hs2.length==0&&hsx[0].number<6){
                    return -2;
                }
                if(hsx.length>3&&hs2.length==0){
                    return -2;
                }
                if(hs1.length>hs2.length&&(!hs2.length||hs1[0].number>hs2[0].number)){
                    return -2;
                }
                return -0.5;
            },
                    },
                    tag:{
                        respond:2,
                        respondSha:2,
                        damage:1,
                    },
                },
            },
            qqwz_虎狼3:{
                trigger:{
                    player:"useCardAfter",
                },
                forced:true,
                filter:function (event,player){
    return event.card&&event.card.name=='juedou';
},
                content:function (){
        player.useCard(trigger.card,trigger.targets,false)._triggered=null;
        player.useCard(trigger.card,trigger.targets,false)._triggered=null;
},
            },
            qqwz_虎狼4:{
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
        return event.card&&(event.card.name=='juedou');
    },
                forced:true,
                content:function (){
        trigger.num+=2;
    },
            },
            qqwz_箭阵:{
                audio:["qqwz箭阵",2],
                group:"qqwz_箭阵2",
                enable:"phaseUse",
                viewAs:{
                    name:"wanjian",
                },
                filterCard:function (card,player){
        if(ui.selected.cards.length){
            return get.suit(card)!=get.suit(ui.selected.cards[0]);
        }
        var cards=player.get('h');
        for(var i=0;i<cards.length;i++){
            if(card!=cards[i]){
                if(get.suit(card)!=get.suit(cards[i])) return true;
            }
        }
        return false;
    },
                selectCard:2,
                complexCard:true,
                check:function (card){
        return 6-ai.get.value(card);
    },
                ai:{
                    basic:{
                        order:10,
                        useful:1,
                        value:5,
                    },
                    wuxie:function (target,card,player,viewer){
            if(ai.get.attitude(viewer,target)>0&&target.num('h','shan')){
                if(!target.num('h')||target.hp==1||Math.random()<0.7) return 0;
            }
        },
                    result:{
                        target:function (player,target){
                if(player.hasUnknown(2)) return 0;
                var nh=target.num('h');
                if(get.mode()=='identity'){
                    if(target.isZhu&&nh<=2&&target.hp<=1) return -100;
                }
                if(nh==0) return -2;
                if(nh==1) return -1.7
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:1,
                        multitarget:1,
                        multineg:1,
                    },
                },
            },
            qqwz_箭阵2:{
                audio:["qqwz箭阵",2],
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
        return event.card&&(event.card.name=='wanjian');
    },
                forced:true,
                content:function (){
        trigger.num+=2;
        player.draw(2);
    },
            },
            qqwz_名门:{
                audio:["qqwz名门",2],
                trigger:{
                    player:"phaseDiscardBefore",
                },
                forced:true,
                content:function (){
    trigger.untrigger();
    trigger.finish();
     player.draw(2);
     player.recover(2);
},
                mod:{
                    targetEnabled:function (card,player,target,now){
            if(card.name=='lebu') return false;
        },
                },
            },
            qqwz_酗酒:{
                audio:["qqwz酗酒",2],
                group:"qqwz_酗酒2",
                enable:"chooseToUse",
                filterCard:function (card){
        return get.suit(card)=='spade';
    },
                viewAs:{
                    name:"jiu",
                    suit:"spade",
                    number:2,
                },
                viewAsFilter:function (player){
        if(!player.num('h',{suit:'spade'})) return false;
    },
                prompt:"将一张黑桃手牌当酒使用",
                check:function (card){
        if(_status.event.type=='dying') return 1;
        return 4-ai.get.value(card);
    },
                ai:{
                    skillTagFilter:function (player){
            return player.num('h',{suit:'spade'})>0&&player.hp<=0;
        },
                    threaten:1.5,
                    save:true,
                    basic:{
                        useful:function (card,i){
                if(_status.event.player.hp>1){
                    if(i==0) return 5;
                    return 1;
                }
                if(i==0) return 7.3;
                return 3;
            },
                        value:function (card,player){
                if(player.hp>1){
                    if(i==0) return 5;
                    return 1;
                }
                if(i==0) return 7.3;
                return 3;
            },
                    },
                    order:function (){
            return lib.card.sha.ai.order+0.2;
        },
                    result:{
                        target:function (player,target){
                if(target&&target.hp<=0) return 2;
                if(lib.config.mode=='stone'&&!player.isMin()){
                    if(player.getActCount()+1>=player.actcount) return 0;
                }
                var shas=player.get('h','sha');
                if(shas.length>1&&player.getCardUsable('sha')>1){
                    return 0;
                }
                var card;
                if(shas.length){
                    for(var i=0;i<shas.length;i++){
                        if(lib.filter.filterCard(shas[i],target)){
                            card=shas[i];break;
                        }
                    }
                }
                else if(player.hasSha()&&player.needsToDiscard()){
                    if(player.num('h','hufu')!=1){
                        card={name:'sha'};
                    }
                }
                if(card){
                    if(game.hasPlayer(function(current){
                        return (ai.get.attitude(target,current)<0&&
                            target.canUse(card,current,true,true)&&
                            !current.num('e','baiyin')&&
                            ai.get.effect(current,card,target)>0);
                    })){
                        return 1;
                    }
                }
                return 0;
            },
                    },
                    tag:{
                        save:1,
                    },
                },
            },
            qqwz_酗酒2:{
                audio:["qqwz酗酒",2],
                trigger:{
                    player:"phaseDrawBegin",
                },
                frequent:true,
                content:function (){
        trigger.num+=3;
    },
                ai:{
                    threaten:1.3,
                },
            },
            qqwz_色欲:{
                audio:["qqwz色欲",2],
                trigger:{
                    source:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
        return event.player.sex=='female';
    },
                content:function (){
      trigger.player.loseHp();
      trigger.player.loseMaxHp();
      trigger.player.turnOver();
      player.draw(2);
    },
            },
            qqwz_掌权:{
                audio:["qqwz掌权",2],
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                check:function (){
        return false;
    },
                filter:function (event,player){
        return !player.isLowestHp();
    },
                content:function (){
        "step 0"
        player.chooseControl('回复体力并摸牌','增加上限并摸牌',function(event,player){
            if(player.hp==player.maxHp) return '回复体力并摸牌';
            if(player.hp<player.maxHp-1||player.hp<=2) return '增加上限并摸牌';
            return 'qqwz_掌权_hp';
        });
        "step 1"
        if(result.control=='回复体力并摸牌'){
            player.recover(2);
            player.draw();
        }
        else{
            player.gainMaxHp(2);
            player.draw();
        }
    },
                ai:{
                    threaten:0.5,
                },
            },
            qqwz_暴凌:{
                audio:["qqwz暴凌",2],
                trigger:{
                    source:"damageBegin",
                },
                forced:true,
                content:function (){
         trigger.num+=player.hp;
},
            },
            qqwz_绝命:{
                locked:true,
                group:"qqwz_绝命2",
                global:"qqwz_绝命3",
            },
            qqwz_绝命2:{
                audio:["qqwz绝命",2],
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                content:function (){
var card=get.cards(10)
var c=[]
player.showCards(card)
if(Math.random()<=1){
for(var i=0;i<card.length;i++){
if(get.color(card[i])=='black') c.push(card[i])
}
player.gain(c)
}
else player.gain(card)
},
            },
            qqwz_危局:{
                audio:["qqwz危局",2],
                group:"qqwz_危局2",
                usable:1,
                unique:true,
                enable:"phaseUse",
                filter:function (event,player){
        return !player.storage.qqwz_危局;
    },
                init:function (player){
        player.storage.qqwz_危局=false;
    },
                mark:true,
                intro:{
                    content:"limited",
                },
                skillAnimation:"epic",
                animationColor:"thunder",
                filterTarget:function (card,player,target){
        return target!=player;
    },
                selectTarget:-1,
                multitarget:true,
                multiline:true,
                content:function (){
        "step 0"
        player.unmarkSkill('qqwz_危局')
        player.storage.qqwz_危局=false;
        event.current=player.next;
        "step 1"
        event.current.animate('target');
        event.current.chooseToUse('危局：使用一张杀或流失两点体力',{name:'sha'},function(card,player,target){
            if(player==target) return false;
            if(!player.canUse('sha',target)) return false;
            if(get.distance(player,target)<=1) return true;
            if(game.hasPlayer(function(current){
                return current!=player&&get.distance(player,current)<get.distance(player,target);
            })){
                return false;
            }
            return true;
        });
        "step 2"
        if(result.bool==false) event.current.loseHp(2);
        if(event.current.next!=player){
            event.current=event.current.next;
            game.delay(0.5);
            event.goto(1);
        }
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                if(lib.config.mode=='identity'&&game.zhu.isZhu&&player.identity=='fan'){
                    if(game.zhu.hp==1&&game.zhu.num('h')<=2) return 1;
                }
                var num=0;
                var players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    var att=ai.get.attitude(player,players[i]);
                    if(att>0) att=1;
                    if(att<0) att=-1;
                    if(players[i]!=player&&players[i].hp<=3){
                        if(players[i].num('h')==0) num+=att/players[i].hp;
                        else if(players[i].num('h')==1) num+=att/2/players[i].hp;
                        else if(players[i].num('h')==2) num+=att/4/players[i].hp;
                    }
                    if(players[i].hp==1) num+=att*1.5;
                }
                if(player.hp==1){
                    return -num;
                }
                if(player.hp==2){
                    return -game.players.length/4-num;
                }
                return -game.players.length/3-num;
            },
                    },
                },
            },
            qqwz_暗幕:{
                audio:["qqwz暗幕",2],
                group:"qqwz_暗幕2",
                trigger:{
                    global:"recoverBefore",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player&&Math.random()<=1;
},
                content:function (){
trigger.untrigger();
trigger.finish();
},
                mod:{
                    targetEnabled:function (card){
            if((get.type(card)=='trick'||get.type(card)=='delay')&&
                get.color(card)=='black') return false;
        },
                },
            },
            qqwz_危局2:{
                audio:["qqwz危局",2],
                trigger:{
                    player:"useCardAfter",
                },
                forced:true,
                filter:function (event,player){
return get.type(event.card)=='trick';
},
                content:function (){
player.useCard(trigger.card,trigger.targets,false)._triggered=null;
},
            },
            qqwz_绝命3:{
                mod:{
                    cardSavable:function (card,player){
            if(!_status.currentPhase) return;
            if(_status.currentPhase.get('s').contains('qqwz_绝命')&&_status.currentPhase!=player){
                if(card.name=='tao'&&_status.event.dying!=player) return false;
            }
        },
                },
            },
            qqwz_暗幕2:{
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'){
                return false;
            }
        },
                },
            },
            qqwz_万化:{
                unique:true,
                init:function (player){
        player.storage.qqwz_万化={
            list:[],
            owned:{},
            player:player,
        }
    },
                get:function (player,num){
        if(typeof num!='number') num=2;
        while(num--){
            var name=player.storage.qqwz_万化.list.randomRemove();
            var skills=lib.character[name][3].slice(0);
            for(var i=0;i<skills.length;i++){
                var info=lib.skill[skills[i]];
                if(info.unique&&!info.gainable){
                    skills.splice(i--,1);
                }
            }
            player.storage.qqwz_万化.owned[name]=skills;
            player.popup(name);
            game.log(player,'获得了一个化身');
        }
    },
                group:["qqwz_万化2","qqwz_万化3"],
                intro:{
                    content:function (storage,player){
            var str='';
            var slist=storage.owned;
            var list=[];
            for(var i in slist){
                list.push(i);
            }
            if(list.length){
                str+=get.translation(list[0]);
                for(var i=1;i<list.length;i++){
                    str+='、'+get.translation(list[i]);
                }
            }
            var skill=player.additionalSkills.qqwz_万化[0];
            if(skill){
                str+='<p>当前技能：'+get.translation(skill);
            }
            return str;
        },
                    mark:function (dialog,content,player){
            var slist=content.owned;
            var list=[];
            for(var i in slist){
                list.push(i);
            }
            if(list.length){
                dialog.addSmall([list,'character']);
            }
            var skill=player.additionalSkills.qqwz_万化[0];
            if(skill){
                dialog.add('<div><div class="skill">【'+get.translation(skill)+
                '】</div><div>'+lib.translate[skill+'_info']+'</div></div>');
            }
        },
                },
                mark:true,
            },
            qqwz_万化2:{
                audio:["qqwz万化",2],
                trigger:{
                    global:["gameStart","phaseBefore"],
                },
                forced:true,
                popup:false,
                priority:10,
                filter:function (event,player){
        return !player.storage.qqwz_万化inited;
    },
                content:function (){
        for(var i in lib.character){
            if(i.indexOf('stone_')==0) continue;
            var add=false;
            for(var j=0;j<lib.character[i][3].length;j++){
                var info=lib.skill[lib.character[i][3][j]];
                if(!info){
                    continue;
                }
                if(info.gainable||!info.unique){
                    add=true;break;
                }
            }
            if(add){
                player.storage.qqwz_万化.list.push(i);
            }
        }
        for(var i=0;i<game.players.length;i++){
            player.storage.qqwz_万化.list.remove([game.players[i].name]);
            player.storage.qqwz_万化.list.remove([game.players[i].name1]);
            player.storage.qqwz_万化.list.remove([game.players[i].name2]);
        }
        lib.skill.qqwz_万化.get(player,5);
        player.storage.qqwz_万化inited=true;
    },
            },
            qqwz_万化3:{
                audio:["qqwz万化",2],
                trigger:{
                    player:["phaseBegin","phaseEnd"],
                    global:"gameStart",
                },
                filter:function (event,player,name){
        if(name=='phaseBegin'&&game.phaseNumber==1) return false;
        return true;
    },
                priority:-9,
                forced:true,
                popup:false,
                content:function (){
        var slist=player.storage.qqwz_万化.owned;
        var list=[];
        for(var i in slist){
            list.push(i);
        }
        if(event.isMine()){
            event.dialog=ui.create.dialog('选择获得一项技能',[list,'character']);
            if(trigger.name=='game'){
                event.control=ui.create.control();
            }
            else{
                event.control=ui.create.control(['cancel2']);
            }
            event.clickControl=function(link){
                if(link!='cancel2'){
                    var currentname=event.dialog.querySelector('.selected.button').link;
                    var mark=player.marks.qqwz_万化;
                    if(trigger.name=='game'){
                        mark.hide();
                        // mark.style.transform='scale(0.8)';
                        mark.style.transition='all 0.3s';
                        setTimeout(function(){
                            mark.style.transition='all 0s';
                            ui.refresh(mark);
                            mark.setBackground(currentname,'character');
                            if(mark.firstChild){
                                mark.firstChild.remove();
                            }
                            setTimeout(function(){
                                mark.style.transition='';
                                mark.show();
                                // mark.style.transform='';
                            },50);
                        },500);
                    }
                    else{
                        if(mark.firstChild){
                            mark.firstChild.remove();
                        }
                        mark.setBackground(currentname,'character');
                    }
                    player.addAdditionalSkill('qqwz_万化',link);
                    player.logSkill('qqwz_万化2');
                    game.log(player,'获得技能','【'+get.translation(link)+'】');
                    player.popup(link);

                    for(var i=0;i<event.dialog.buttons.length;i++){
                        if(event.dialog.buttons[i].classList.contains('selected')){
                            var name=event.dialog.buttons[i].link;
                            player.sex=lib.character[name][0];
                            player.group=lib.character[name][1];
                            // player.node.identity.style.backgroundColor=get.translation(player.group+'Color');
                            break;
                        }
                    }

                    if(event.triggername=='phaseBegin'){
                        (function(){
                            var skills=[link];
                            var list=[];
                            game.expandSkills(skills);
                            var triggerevent=event._trigger;
                            var name='phaseBegin';
                            for(i=0;i<skills.length;i++){
                                var trigger=get.info(skills[i]).trigger;
                                if(trigger){
                                    var add=false;
                                    if(player==triggerevent.player&&trigger.player){
                                        if(typeof trigger.player=='string'){
                                            if(trigger.player==name) add=true;
                                        }
                                        else if(trigger.player.contains(name)) add=true;
                                    }
                                    if(trigger.global){
                                        if(typeof trigger.global=='string'){
                                            if(trigger.global==name) add=true;
                                        }
                                        else if(trigger.global.contains(name)) add=true;
                                    }
                                    if(add&&player.isOut()==false) list.push(skills[i]);
                                }
                            }
                            for(var i=0;i<list.length;i++){
                                game.createTrigger('phaseBegin',list[i],player,triggerevent);
                            }
                        }());
                    }
                }
                ui.auto.show();
                event.dialog.close();
                event.control.close();
                game.resume();
            };
            event.control.custom=event.clickControl;
            ui.auto.hide();
            game.pause();
            for(var i=0;i<event.dialog.buttons.length;i++){
                event.dialog.buttons[i].classList.add('selectable');
            }
            event.custom.replace.button=function(button){
                if(button.classList.contains('selected')){
                    button.classList.remove('selected');
                    if(trigger.name=='game'){
                        event.control.style.opacity=0;
                    }
                    else{
                        event.control.replace(['cancel2']);
                    }
                }
                else{
                    for(var i=0;i<event.dialog.buttons.length;i++){
                        event.dialog.buttons[i].classList.remove('selected');
                    }
                    button.classList.add('selected');
                    event.control.replace(slist[button.link]);
                    if(trigger.name=='game'&&getComputedStyle(event.control).opacity==0){
                        event.control.style.transition='opacity 0.5s';
                        ui.refresh(event.control);
                        event.control.style.opacity=1;
                        event.control.style.transition='';
                        ui.refresh(event.control);
                    }
                    else{
                        event.control.style.opacity=1;
                    }
                }
                event.control.custom=event.clickControl;
            }
            event.custom.replace.window=function(){
                for(var i=0;i<event.dialog.buttons.length;i++){
                    if(event.dialog.buttons[i].classList.contains('selected')){
                        event.dialog.buttons[i].classList.remove('selected');
                        if(trigger.name=='game'){
                            event.control.style.opacity=0;
                        }
                        else{
                            event.control.replace(['cancel2']);
                        }
                        event.control.custom=event.clickControl;
                        return;
                    }
                }
            }
        }
        else{
            event.finish();
        }
    },
            },
            qqwz_归魂:{
                audio:["qqwz归魂",2],
                unique:true,
                trigger:{
                    player:["damageEnd","loseHp","loseMaxHp","recoverEnd","gainMaxHpEnd"],
                },
                frequent:true,
                filter:function (event,player){
        return player.storage.qqwz_万化&&player.storage.qqwz_万化.list&&
            player.storage.qqwz_万化.list.length>0;
    },
                content:function (){
        for(var i=0;i<trigger.num;i++){
            lib.skill.qqwz_万化.get(player);
        }
    },
            },
            qqwz_仙道:{
                audio:["qqwz仙道",2],
                group:"qqwz_仙道2",
                unique:true,
                trigger:{
                    player:"phaseAfter",
                },
                direct:true,
                init:function (player){
        player.storage.qqwz_仙道=[];
        // player.storage.qqwz_仙道2=0;
    },
                intro:{
                    content:"characters",
                },
                content:function (){
        'step 0'
        // if(player.storage.qqwz_仙道2<1){
        //     player.storage.qqwz_仙道2++;
        //     event.finish();
        // }
        // else{
        //     player.storage.qqwz_仙道2=0;
        // }
        'step 1'
        player.logSkill('qqwz_仙道');
        var list=[];
        var list2=[];
        var players=game.players.concat(game.dead);
        for(var i=0;i<players.length;i++){
            list2.add(players[i].name);
            list2.add(players[i].name1);
            list2.add(players[i].name2);
        }
        for(var i in lib.character){
            if(player.storage.qqwz_仙道.contains(i)) continue;
            if(list2.contains(i)) continue;
            list.push(i);
        }
        var name=list.randomGet();
        player.storage.qqwz_仙道.push(name);
        player.markSkill('qqwz_仙道');
        var skills=lib.character[name][3];
        for(var i=0;i<skills.length;i++){
            player.addSkill(skills[i]);
        }
        event.dialog=ui.create.dialog('<div class="text center">'+get.translation(player)+'发动了【仙道】',[[name],'character']);
        game.delay(2);
        'step 2'
        event.dialog.close();
    },
            },
            qqwz_仙道2:{
                audio:["qqwz仙道",2],
                enable:["chooseToRespond","chooseToUse"],
                filterCard:function (card){
        return get.color(card)=='red';
    },
                position:"hej",
                viewAs:{
                    name:"tao",
                    suit:"diamond",
                    number:5,
                },
                viewAsFilter:function (player){
        if(!player.num('hej',{color:'red'})) return false;
    },
                prompt:"将一张红色牌当桃使用",
                check:function (card){return 4-ai.get.value(card)},
                ai:{
                    skillTagFilter:function (player){
            if(!player.num('hej',{color:'red'})) return false;
        },
                    respondSha:true,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                        order:function (card,player){
                if(player.hasSkillTag('pretao')) return 5;
                return 2;
            },
                    },
                    order:3,
                    result:{
                        target:function (player,target){
                if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                    if(ai.get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3.05+(sgs.getDefenseSha(target,player))/30;
                    }
                }
                return -1.55+(sgs.getDefenseSha(target,player))/30;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                        natureDamage:function (card){
                if(card.nature) return 1;
            },
                        fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                        thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                        poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                        recover:1,
                        save:1,
                    },
                },
            },
            qqwz_离歌:{
                audio:["qqwz离歌",2],
                trigger:{
                    global:"damageEnd",
                },
                filter:function (event,player){
        return (event.card&&event.source&&
            event.player.classList.contains('dead')==false&&player.num('he'));
    },
                direct:true,
                check:function (event,player){
        var att1=ai.get.attitude(player,event.player);
        var att2=ai.get.attitude(player,event.source);
        return att1>att2&&att1>=0;
    },
                content:function (){
        "step 0"
        player.draw(1);
        var next=player.chooseToDiscard('he',get.prompt('qqwz_离歌'));
        next.set('ai',ai.get.unuseful2);
        next.set('logSkill','qqwz_离歌');
        "step 1"
        if(result.bool){
            trigger.player.judge();
        }
        else{
            event.finish();
        }
        "step 2"
        switch(get.suit(result.card)){
            case 'heart':trigger.player.recover(2);break;
            case 'diamond':trigger.player.draw(3);break;
            case 'club':trigger.source.chooseToDiscard('he',5,true);break;
            case 'spade':trigger.source.loseHp(2);break;
        }
    },
                ai:{
                    expose:0.3,
                },
            },
            qqwz_月琴:{
                audio:["qqwz月琴",2],
                trigger:{
                    source:"damageEnd",
                },
                filter:function (event,player){
        return (event.card&&event.source&&
            event.player.classList.contains('dead')==false&&player.num('he'));
    },
                direct:true,
                check:function (event,player){
        var att1=ai.get.attitude(player,event.player);
        var att2=ai.get.attitude(player,event.source);
        return att1>att2&&att1>=0;
    },
                content:function (){
        "step 0"
        var next=player.chooseToDiscard('he',get.prompt('qqwz_月琴'));
        next.set('ai',ai.get.unuseful2);
        next.set('logSkill','qqwz_月琴');
        "step 1"
        if(result.bool){
            trigger.player.judge();
        }
        else{
            event.finish();
        }
        "step 2"
        switch(get.suit(result.card)){
            case 'heart':trigger.player.turnOver();break;
            case 'diamond':trigger.player.loseHp(1);break;
            case 'club':player.gainMaxHp(2);break;
            case 'spade':player.recover(2);break;
        }
    },
                ai:{
                    expose:0.3,
                },
            },
            qqwz_长恨:{
                audio:["qqwz长恨",2],
                trigger:{
                    player:"dieBegin",
                },
                forced:true,
                filter:function (event){
        return event.source!=undefined;
    },
                content:function (){
        trigger.source.clearSkills();
        trigger.source.die();
    },
                ai:{
                    threaten:function (player,target){
            if(target.hp==1) return 0.2;
            return 1.5;
        },
                    effect:{
                        target:function (card,player,target,current){
                if(!target.hasFriend()) return;
                if(target.hp<=1&&get.tag(card,'damage')) return [1,0,0,-2];
            },
                    },
                },
            },
            qqwz_谋诛:{
                audio:["qqwz谋诛",2],
                group:["qqwz_谋诛2","qqwz_谋诛3"],
                trigger:{
                    player:"shaBegin",
                },
                check:function (event,player){
        return ai.get.attitude(player,event.target)<0;
    },
                content:function (){
         player.draw(2);
        if(!trigger.target.hasSkill('fengyin')){
            trigger.target.addTempSkill('fengyin','phaseAfter');
        }
    },
                mod:{
                    cardUsable:function (card,player,num){
            if(card.name=='sha') return num+2;
        },
                },
            },
            qqwz_谋诛2:{
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
            if(event.player.get('h').length==0) return true;
    },
                forced:true,
                content:function (){
        trigger.num+=5;
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(target.get('h').length==0) return [1,-2];
            },
                    },
                },
            },
            qqwz_谋诛3:{
                trigger:{
                    player:"useCard",
                },
                forced:true,
                priority:10,
                content:function (){
                player.addTempSkill('unequip','useCardAfter');
            },
            },
            qqwz_皇令:{
                enable:"phaseUse",
                usable:1,
                audio:["qqwz皇令",2],
                filter:function (event,player){
        return player.num('h')>0;
    },
                filterCard:true,
                selectCard:-1,
                filterTarget:function (card,player,target){
        return player!=target;
    },
                discard:false,
                prepare:"give2",
                ai:{
                    order:1,
                    result:{
                        player:0,
                        target:function (player,target){
                if(player.num('h')>1){
                    return 1;
                }
                var players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(players[i].num('h')&&players[i]!=target&&players[i]!=player&&ai.get.attitude(player,players[i])<0){
                        break;
                    }
                }
                if(i==players.length){
                    return 1;
                }
                return -2/(target.num('h')+1);
            },
                    },
                },
                content:function (){
        "step 0"
        event.target1=targets[0];
        targets[0].gain(cards,player);
        var players=game.filterPlayer();
        for(var i=0;i<players.length;i++){
            if(players[i].num('h')&&players[i]!=event.target1&&players[i]!=player){
                break;
            }
        }
        if(i==players.length){
            event.finish();
        }
        "step 1"
        player.chooseTarget(true,'选择拼点目标',function(card,player,target){
            return target.num('h')&&target!=_status.event.target1&&target!=player;
        }).set('ai',function(target){
            var player=_status.event.player;
            var eff=ai.get.effect(target,{name:'sha'},_status.event.target1,player);
            var att=ai.get.attitude(player,target);
            if(att>0){
                return eff-10;
            }
            return eff;
        }).set('target1',event.target1);
        "step 2"
        if(result.targets.length){
            event.target2=result.targets[0];
            event.target1.line(event.target2);
            event.target1.chooseToCompare(event.target2);
        }
        else{
            event.finish();
        }
        "step 3"
        if(result.bool){
            event.target1.useCard({name:'sha'},event.target2);
            event.target2.die();
            player.draw(2);
        }
        else{
            event.target2.useCard({name:'sha'},event.target1);
            event.target1.die();
            player.draw(2);
        }
    },
            },
            qqwz_定数:{
                audio:["qqwz定数",2],
                group:["qqwz_定数2","qqwz_定数3","qqwz_定数4"],
                trigger:{
                    target:"shaBegin",
                },
                check:function (event,player){
        var cards=player.get('h');
        if(cards.length<=2){
            for(var i=0;i<cards.length;i++){
                if(cards[i].name=='shan'||cards[i].name=='tao') return false;
            }
        }
        return true;
    },
                content:function (){
        player.draw(2);
        trigger.untrigger();
        trigger.finish();
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(card.name=='sha') return [1,0.5];
            },
                    },
                },
            },
            qqwz_定数2:{
                audio:["qqwz定数",2],
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                priority:-500,
                content:function (){
if(trigger.num>1) trigger.num=1
},
            },
            qqwz_定数3:{
                audio:["qqwz定数",2],
                trigger:{
                    player:"phaseDiscardBefore",
                },
                forced:true,
                content:function (){
    trigger.untrigger();
    trigger.finish();
},
            },
            qqwz_定数4:{
                audio:["qqwz定数",2],
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                unique:true,
                filter:function (event){
return event.nature;
},
                content:function (){
trigger.untrigger();
trigger.finish();
player.draw(2);
},
            },
            qqwz_谋篡:{
                audio:["qqwz谋篡",2],
                trigger:{
                    global:"phaseBegin",
                },
                check:function (event,player){
        var att=ai.get.attitude(player,event.player);
        return !game.hasPlayer(function(current){
            return ai.get.attitude(player,current)<att;
        });
    },
                filter:function (event,player){
        return event.player!=player&&!player.storage.qqwz_谋篡;
    },
                content:function (){
        player.draw(2);
        player.gainMaxHp();
        player.chooseToUse({name:'juedou'},'谋篡：是否使用一张决斗？').logSkill='qqwz_谋篡';
    },
                ai:{
                    expose:0.2,
                },
                intro:{
                    content:"player",
                },
            },
            qqwz_妄尊:{
                audio:["qqwz妄尊",2],
                group:"qqwz_妄尊2",
                trigger:{
                    player:"phaseDrawBegin",
                },
                frequent:true,
                content:function (){
        trigger.num+=player.maxHp;
    },
            },
            qqwz_妄尊2:{
                audio:["qqwz妄尊",2],
                trigger:{
                    player:"phaseDiscardBefore",
                },
                forced:true,
                content:function (){
    trigger.untrigger();
    trigger.finish();
},
            },
            qqwz_狮枪:{
                audio:["qqwz狮枪",2],
                group:["qqwz_狮枪2","qqwz_狮枪3"],
                trigger:{
                    player:"shaBegin",
                },
                check:function (event,player){
        return ai.get.attitude(player,event.target)<0;
    },
                content:function (){
        player.draw(2);
        if(!trigger.target.hasSkill('fengyin')){
            trigger.target.addTempSkill('fengyin','phaseAfter');
        }
    },
                mod:{
                    globalFrom:function (from,to){
            if(from.hp>to.hp) return -Infinity;
        },
                },
            },
            qqwz_狮枪2:{
                audio:["qqwz狮枪",2],
                group:"qqwz_狮枪闪",
                trigger:{
                    source:"damageEnd",
                },
                priority:10,
                forced:true,
                content:function (){
        'step 0'
        player.recover();
        var card=get.cardPile(function(card){
            return get.type(card)=='basic';
        });
        event.card=card;
        'step 1'
        if(event.card){
             player.gain(game.createCard(event.card),'gain2');
        }
    },
            },
            qqwz_狮枪3:{
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
        return event.card&&(event.card.name=='sha'||event.card.name=='juedou');
    },
                forced:true,
                content:function (){
        trigger.num+=3;
    },
                mod:{
                    selectTarget:function (card,player,range){
           if(card.name=='sha') range[1]+=3;
    },
                },
            },
            qqwz_升龙:{
                group:["qqwz_升龙_sha","qqwz_升龙_shan","qqwz_升龙_du"],
                subSkill:{
                    sha:{
                        audio:["qqwz升龙",2],
                        enable:["chooseToUse","chooseToRespond"],
                        filterCard:{
                            name:"shan",
                        },
                        viewAs:{
                            name:"sha",
                            suit:"heart",
                            number:2,
                            cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"heart","number":8,"name":"shan","original":"h","_transform":"translateX(1072px)","_mouseentercreated":false,"clone":{"name":"shan","suit":"heart","number":8,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":6282},"timeout":6136}],
                        },
                        viewAsFilter:function (player){
                if(!player.num('h','shan')) return false;
            },
                        prompt:"将一张闪当杀使用或打出",
                        check:function (){return 1},
                        ai:{
                            effect:{
                                target:function (card,player,target,current){
                        if(get.tag(card,'respondSha')&&current<0) return 0.6
                    },
                            },
                            respondSha:true,
                            skillTagFilter:function (player){
                    if(!player.num('h','shan')) return false;
                },
                            order:3.1,
                            useful:-1,
                            value:-1,
                            basic:{
                                useful:[5,1],
                                value:[5,1],
                            },
                            result:{
                                target:function (player,target){
                        if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                            if(ai.get.attitude(player,target)>0){
                                return -6;
                            }
                            else{
                                return -3;
                            }
                        }
                        return -1.5;
                    },
                            },
                            tag:{
                                respond:1,
                                respondShan:1,
                                damage:function (card){
                        if(card.nature=='poison') return;
                        return 1;
                    },
                                natureDamage:function (card){
                        if(card.nature) return 1;
                    },
                                fireDamage:function (card,nature){
                        if(card.nature=='fire') return 1;
                    },
                                thunderDamage:function (card,nature){
                        if(card.nature=='thunder') return 1;
                    },
                                poisonDamage:function (card,nature){
                        if(card.nature=='poison') return 1;
                    },
                            },
                        },
                    },
                    shan:{
                        audio:["qqwz升龙",2],
                        enable:["chooseToRespond"],
                        filterCard:{
                            name:"sha",
                        },
                        viewAs:{
                            name:"shan",
                            suit:"spade",
                            number:4,
                        },
                        prompt:"将一张杀当闪打出",
                        check:function (){return 1},
                        viewAsFilter:function (player){
                if(!player.num('h','sha')) return false;
            },
                        ai:{
                            respondShan:true,
                            skillTagFilter:function (player){
                    if(!player.num('h','sha')) return false;
                },
                            effect:{
                                target:function (card,player,target,current){
                        if(get.tag(card,'respondShan')&&current<0) return 0.6
                    },
                            },
                            order:4,
                            useful:-1,
                            value:-1,
                            basic:{
                                useful:[7,2],
                                value:[7,2],
                            },
                        },
                    },
                    du:{
                        audio:["qqwz升龙",2],
                        enable:["phaseUse"],
                        filterCard:{
                            name:"du",
                        },
                        viewAs:{
                            name:"taoyuan",
                        },
                        prompt:"将一张毒当桃园结义使用或打出",
                        check:function (){return 1},
                        viewAsFilter:function (player){
                if(!player.num('h','du')) return false;
            },
                        ai:{
                            basic:{
                                order:9,
                                useful:[3,1],
                                value:0,
                            },
                            result:{
                                target:function (player,target){
                        return (target.hp<target.maxHp)?2:0;
                    },
                            },
                            tag:{
                                recover:0.5,
                                multitarget:1,
                            },
                        },
                    },
                },
            },
            qqwz_飞燕:{
                group:["qqwz_飞燕2","qqwz_飞燕3","qqwz_飞燕4"],
                ai:{
                    mingzhi:false,
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'respondShan')||get.tag(card,'respondSha')){
                    if(ai.get.attitude(target,player)<=0){
                        if(current>0) return;
                        if(target.num('h')==0) return 1.6;
                        if(target.num('h')==1) return 1.2;
                        if(target.num('h')==2) return [0.8,0.2,0,-0.2];
                        return [0.4,0.7,0,-0.7];
                    }
                }
            },
                    },
                },
            },
            qqwz_飞燕2:{
                audio:["qqwz飞燕",2],
                trigger:{
                    player:"shaBefore",
                },
                filter:function (event,player){
        if(event.skill!='qqwz_升龙_sha') return false;
        return event.target.num('h')>0;
    },
                logTarget:"target",
                content:function (){
        var card=trigger.target.get('h').randomGet();
        player.gain(card,trigger.targe);
        trigger.target.$giveAuto(card,player);
        game.delay();
    },
            },
            qqwz_飞燕3:{
                audio:["qqwz飞燕",2],
                trigger:{
                    player:"respond",
                },
                filter:function (event,player){
        if(event.skill!='qqwz_飞燕_shan'&&event.skill!='qqwz_飞燕_sha')return false;
        return event.source&&event.source.num('h')>0;
    },
                logTarget:"source",
                content:function (){
        var card=trigger.source.get('h').randomGet(2);
        player.gain(card,trigger.source,2);
        trigger.source.$giveAuto(card,player);
        game.delay();
    },
            },
            qqwz_飞燕4:{
                audio:["qqwz飞燕",2],
                trigger:{
                    player:"respond",
                },
                filter:function (event,player){
        return event.card.name=='shan'&&player.hasSha();
    },
                direct:true,
                content:function (){
        player.chooseToUse({name:'sha'},'飞燕：是否使用一张杀？').logSkill='qqwz_飞燕4';
    },
            },
            qqwz_排兵:{
                audio:["qqwz_排兵",2],
                trigger:{
                    player:["shaBegin","juedouBegin"],
                },
                direct:true,
                content:function (){
        'step 0'
        player.chooseControl('摸牌','加伤害','cancel2').set('prompt',get.prompt('qqwz_排兵'));
        'step 1'
        if(result.control&&result.control!='cancel2'){
            player.logSkill('qqwz_排兵');
            var nd=player.num('he');
            if(result.control=='摸牌'){
                player.draw(nd);
            }
            else{
                player.addTempSkill('qqwz_排兵2','useCardToAfter');
                player.storage.qqwz_排兵=nd;
            }
        }
    },
            },
            qqwz_排兵2:{
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
        return event.card&&(event.card.name=='sha'||event.card.name=='juedou');
    },
                forced:true,
                audio:["qqwz排兵",2],
                content:function (){
        if(typeof player.storage.qqwz_排兵=='number'){
            trigger.num+=player.storage.qqwz_排兵;
        }
    },
            },
            qqwz_傀儡:{
                audio:["qqwz傀儡",2],
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target;
    },
                filterCard:true,
                position:"he",
                content:function (){
        player.gain(target.get('hej'),target);
        target.$give(target.num('hej'),player);
        player.storage.qqwz_傀儡=target;
        target.die();
    },
                check:function (card){return 8-ai.get.value(card)},
                ai:{
                    order:10,
                    result:{
                        player:function (player){
                if(player.classList.contains('turnedover')) return 10;
                return 0;
            },
                        target:function (player,target){
                if(target.num('h')>target.hp) return target.hp-target.num('h');
                return 0;
            },
                    },
                    threaten:1.5,
                    effect:{
                        target:function (card){
                if(card.name=='guiyoujie') return [0,2];
            },
                    },
                },
            },
            qqwz_驭魂:{
                audio:["qqwz驭魂",2],
                trigger:{
                    player:"phaseEnd",
                },
                frequent:true,
                content:function (){
        player.draw(2);
        player.gainMaxHp();
        player.recover();
    },
            },
            qqwz_蝎心:{
                audio:["qqwz蝎心",2],
                trigger:{
                    global:"phaseUseBegin",
                },
                filter:function (event,player){
        return event.player!=player&&player.num('h')>0;
    },
                direct:true,
                content:function (){
        "step 0"   
        var next=player.chooseToDiscard(get.prompt('qqwz_蝎心',trigger.player));     
        next.set('logSkill',['qqwz_蝎心',trigger.player]);
        "step 1"
        if(result.bool){
            trigger.player.damage(2)._triggered=null;
            trigger.player.loseHp();
            trigger.player.addTempSkill('qqwz_蝎心2','phaseAfter');
        }
        else{
            event.finish();
        }
    },
                ai:{
                    threaten:2,
                    expose:0.3,
                },
            },
            qqwz_蝎心2:{
                trigger:{
                    player:"recoverBefore",
                },
                forced:true,
                content:function (){
trigger.untrigger();
trigger.finish();
},
            },
            qqwz_乱政:{
                trigger:{
                    source:"dieAfter",
                },
                forced:true,
                filter:function (event,player){
                return !player.hasSkill('qqwz_乱政2');
            },
                content:function (){
                player.addSkill('qqwz_乱政2');
            },
            },
            qqwz_乱政2:{
                audio:["qqwz乱政",2],
                trigger:{
                    global:"phaseAfter",
                },
                forced:true,
                priority:-50,
                content:function (){
                player.removeSkill('qqwz_乱政2');
                player.phase();
           player.draw(3);
            },
            },
            qqwz_狮枪闪:{
                mod:{
                    targetInRange:function (card,player,target,now){
            if(card.name=='sha') return true;
        },
                },
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                filter:function (event,player){
    return event.card&&event.card.name=='sha';
    },
                content:function (){
     trigger.directHit=true;
    },
            },
            qqwz_舍粮:{
                audio:["qqwz舍粮",2],
                group:["qqwz_舍粮2","qqwz_舍粮3"],
                trigger:{
                    player:["phaseEnd","phaseUseBegin"],
                },
                init:function (player){
        player.storage.qqwz_舍粮=[];
    },
                filter:function (event,player){
        return !player.storage.qqwz_舍粮||!player.storage.qqwz_舍粮.length;
    },
                intro:{
                    content:"cards",
                },
                content:function (){
        'step 0'
        player.draw(5);
        player.chooseCard(5,'he',true,'选择五张牌作为“粮”');
        'step 1'
        player.storage.qqwz_舍粮=result.cards;
        player.lose(result.cards,ui.special);
        player.syncStorage('qqwz_舍粮');
        player.markSkill('qqwz_舍粮');
    },
            },
            qqwz_渡世:{
                audio:["qqwz渡世",2],
                trigger:{
                    player:"damageEnd",
                    source:"damageEnd",
                },
                filter:function (event,player){
        return player.storage.qqwz_舍粮&&player.storage.qqwz_舍粮.length&&event.player.isAlive();
    },
                direct:true,
                content:function (){
        'step 0'
        trigger.player.chooseCardButton('选择获得一张“粮”',player.storage.qqwz_舍粮);
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_渡世');
            trigger.player.gain(result.links[0],'draw2','log');
            player.storage.qqwz_舍粮.remove(result.links[0]);
            player.syncStorage('qqwz_舍粮');
            if(player.storage.qqwz_舍粮.length==0){
                player.recover(99999);
                player.draw(3);
                player.unmarkSkill('qqwz_舍粮');
            }
            else{
                player.markSkill('qqwz_舍粮');
            }
        }
    },
            },
            qqwz_顺道:{
                enable:"phaseUse",
                audio:["qqwz顺道",2],
                filterTarget:true,
                filter:function (event,player){
        return player.storage.qqwz_舍粮.length>0;
    },
                content:function (){
        "step 0"
        player.chooseCardButton(player.storage.qqwz_舍粮,true);
        "step 1"
        var card=result.links[0];
        player.discard(card);
        player.storage.qqwz_舍粮.remove(card);
        if(!player.storage.qqwz_舍粮.length){
            player.unmarkSkill('qqwz_舍粮');
        }
        else{
            player.markSkill('qqwz_舍粮');
        }
        player.syncStorage('qqwz_舍粮');
        "step 2"
        target.draw(2);
    },
            },
            qqwz_舍粮2:{
                audio:["qqwz舍粮",2],
                trigger:{
                    player:"phaseUseBgein",
                },
                filter:function (event,player){
        return !player.storage.qqwz_舍粮||!player.storage.qqwz_舍粮.length;
    },
                intro:{
                    content:"cards",
                },
                content:function (){
        'step 0'
        player.draw(5);
        player.chooseCard(5,'he',true,'选择两张牌作为“粮”');
        'step 1'
        player.storage.qqwz_舍粮=result.cards;
        player.lose(result.cards,ui.special);
        player.syncStorage('qqwz_舍粮');
        player.markSkill('qqwz_舍粮');
    },
            },
            qqwz_舍粮3:{
                audio:["qqwz舍粮",2],
                trigger:{
                    player:"phaseDiscardBefore",
                },
                forced:true,
                content:function (){
    trigger.untrigger();
    trigger.finish();
},
            },
            qqwz_计筹:{
                audio:["qqwz计筹",2],
                trigger:{
                    player:"phaseUseBegin",
                },
                direct:true,
                filter:function (event,player){
        return player.num('he',{type:'equip'})!=1;
    },
                content:function (){
        'step 0'
        player.chooseToDiscard(get.prompt('qqwz_计筹'),[1,player.num('he',{type:'equip'})],'he',function(card){
            return get.type(card)=='equip';
        }).set('ai',function(card){
            if(card.name=='bagua') return 10;
            return 7-ai.get.value(card);
        });
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_计筹');
            event.cards=get.cards(5*result.cards.length);
            player.showCards(event.cards);
        }
        else{
            event.finish();
        }
        'step 2'
        var gained=[];
        for(var i=0;i<event.cards.length;i++){
            if(get.type(event.cards[i],'trick')=='trick'){
                gained.push(event.cards[i]);
            }
            else{
                ui.discardPile.appendChild(event.cards[i]);
            }
        }
        player.gain(gained,'gain2');
    },
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'){
                return false;
            }
        },
                },
                ai:{
                    threaten:1.5,
                },
            },
            qqwz_星蝶:{
                inherit:"bagua_skill",
                filter:function (event,player){
        if(!lib.skill.bagua_skill.filter(event,player)) return false;
        if(player.get('e','2')) return false;
        return true;
    },
                ai:{
                    effect:{
                        target:function (card,player,target){
                if(player==target&&get.subtype(card)=='equip2'){
                    if(ai.get.equipValue(card)<=7.5) return 0;
                }
                if(target.get('e','2')) return;
                return lib.skill.bagua_skill.ai.effect.target.apply(this,arguments);
            },
                    },
                },
                mod:{
                    maxHandcard:function (player,num){
            if(player.get('e','3')||player.get('e','4')) return;
            return num+=player.hp;
        },
                    targetInRange:function (card,player,target,now){
            if(player.get('e','5')) return;
            var type=get.type(card);
            if(type=='trick'||type=='delay') return true;
        },
                },
                trigger:{
                    player:"chooseToRespondBegin",
                },
                audio:["qqwz星蝶",2],
                group:"qqwz_星蝶2",
                check:function (event,player){
        if(ai.get.damageEffect(player,event.player,player)>=0) return false;
        return true;
    },
                content:function (){
        "step 0"
        player.judge('bagua',function(card){return (get.color(card)=='red')?1.5:-0.5});
        "step 1"
        if(result.judge>0){
            trigger.untrigger();
            trigger.responded=true;
            trigger.result={bool:true,card:{name:'shan'}}
        }
    },
            },
            qqwz_星蝶2:{
                audio:["qqwz星蝶",2],
                trigger:{
                    player:"useCard",
                },
                frequent:true,
                filter:function (event){
        return (get.type(event.card)=='trick'&&event.cards[0]&&event.cards[0]==event.card);
    },
                content:function (){
        'step 0'
        var card=get.cardPile(function(card){
            return get.type(card)=='trick';
        });
        event.card=card;
        'step 1'
        if(event.card){
            player.gain(game.createCard(event.card),'gain2');
        }
    },
                ai:{
                    threaten:1.4,
                },
            },
            qqwz_将酒:{
                mod:{
                    cardEnabled:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='qqwz_将酒') return false;
        },
                    cardUsable:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='qqwz_将酒') return false;
        },
                    cardRespondable:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='qqwz_将酒') return false;
        },
                    cardSavable:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='qqwz_将酒') return false;
        },
                },
                enable:["chooseToUse","chooseToRespond"],
                audio:["qqwz将酒",2],
                filter:function (event,player){
        return player.num('h','jiu')>0;
    },
                filterCard:{
                    name:"jiu",
                },
                viewAs:{
                    name:"juedou",
                },
                viewAsFilter:function (player){
        if(!player.num('h','jiu')) return false;
    },
                check:function (){return 1},
                ai:{
                    skillTagFilter:function (player){
            if(!player.num('h','jiu')) return false;
        },
                    respondSha:true,
                    order:4,
                    useful:-1,
                    value:-1,
                    basic:{
                        order:5,
                        useful:1,
                        value:4.5,
                    },
                    result:{
                        target:-1.5,
                        player:function (player,target){
                        if(ai.get.damageEffect(target,player,target)>0&&ai.get.attitude(player,target)>0&&ai.get.attitude(target,player)>0){
                            return 0;
                        }
                        var hs1=target.get('h','sha');
                        var hs2=player.get('h','sha');
                        if(hs1.length>hs2.length+1){
                            return -2;
                        }
                        var hsx=target.get('h');
                        if(hsx.length>2&&hs2.length==0&&hsx[0].number<6){
                            return -2;
                        }
                        if(hsx.length>3&&hs2.length==0){
                            return -2;
                        }
                        if(hs1.length>hs2.length&&(!hs2.length||hs1[0].number>hs2[0].number)){
                            return -2;
                        }
                        return -0.5;
                    },
                    },
                    tag:{
                        respond:2,
                        respondSha:2,
                        damage:1,
                    },
                },
            },
            qqwz_破敌:{
                audio:["qqwz破敌",2],
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.num('h')>0;
    },
                filter:function (event,player){
        return player.num('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(target);
        "step 1"
        if(result.bool){
            player.storage.qqwz_破敌=target;
            player.addTempSkill('qqwz_破敌2','phaseAfter');
            player.addTempSkill('qqwz_破敌4','phaseAfter');
        }
        else{
            player.addTempSkill('qqwz_破敌3','phaseAfter');
        }
    },
                ai:{
                    order:function (name,player){
            var cards=player.get('h');
            if(player.num('h','sha')==0){
                return 1;
            }
            for(var i=0;i<cards.length;i++){
                if(cards[i].name!='sha'&&cards[i].number>11&&ai.get.value(cards[i])<7){
                    return 9;
                }
            }
            return ai.get.order({name:'sha'})-1;
        },
                    result:{
                        player:function (player){
                if(player.num('h','sha')>0) return 0;
                var num=player.num('h');
                if(num>player.hp) return 0;
                if(num==1) return -2;
                if(num==2) return -1;
                return -0.7;
            },
                        target:function (player,target){
                var num=target.num('h');
                if(num==1) return -1;
                if(num==2) return -0.7;
                return -0.5
            },
                    },
                    threaten:1.3,
                },
            },
            qqwz_破敌2:{
                mod:{
                    targetInRange:function (card,player,target,now){
                    if(player.storage.qqwz_破敌==target) return true;
                },
                    cardUsable:function (card,player,num){
                    if(card.name=='sha') return Infinity;
                },
                },
                ai:{
                    unequip:true,
                },
            },
            qqwz_破敌3:{
                audio:["qqwz破敌",2],
                trigger:{
                    source:"damageEnd",
                },
                filter:function (event,player){
        return event.card&&event.card.name=='sha';
    },
                content:function (){
     trigger.player.die();          
    },
            },
            qqwz_破敌4:{
                mod:{
                    targetInRange:function (card,player,target,now){
            if(card.name=='sha') return true;
        },
                },
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                filter:function (event,player){
    return event.card&&event.card.name=='sha';
    },
                content:function (){
     trigger.directHit=true;
    },
                group:"qqwz_破敌5",
            },
            qqwz_破敌5:{
                audio:["qqwz破敌",2],
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
        return event.card&&(event.card.name=='sha')&&
        event.parent.name!='_lianhuan'&&event.parent.name!='_lianhuan2';
    },
                forced:true,
                content:function (){
        trigger.num+=2;
    },
            },
            qqwz_篱下:{
                audio:["qqwz篱下",2],
                trigger:{
                    global:"useCard",
                },
                forced:true,
                check:function (event,player){
        return ai.get.effect(player,event.card,event.player,player)>0;
    },
                filter:function (event,player){
        if(!event.targets) return false;
        if(event.player==player) return false;
        if(event.targets.contains(player)) return false;
        var type=get.type(event.card);
        if(type!='basic'&&type!='trick') return false;
        if(lib.filter.targetEnabled2(event.card,event.player,player)){
            for(var i=0;i<event.targets.length;i++){
                if(get.distance(event.targets[i],player)<=1) return true;
            }
        }
        return false;
    },
                content:function (){
        'step 0'
        game.delay(0.5);
        'step 1'
        trigger.targets.add(player);
        trigger.player.line(player,'green');
    },
            },
            qqwz_散财:{
                audio:["qqwz散财",2],
                trigger:{
                    source:"damageEnd",
                },
                filter:function (event,player){
        return _status.currentPhase==player&&event.player.isAlive()&&
        event.player.num('he')>0;
    },
                forced:true,
                content:function (){
        var num=0;
        if(trigger.player.num('h')) num+=2;
        if(trigger.player.num('e')) num+=2;
        if(num){
            player.gainPlayerCard(4,trigger.player,num,'he',true).set('filterButton',function(button){
                for(var i=0;i<ui.selected.buttons.length;i++){
                    if(get.position(button.link)==get.position(ui.selected.buttons[i].link)) return false;
                }
                return true;
            });
        }
    },
            },
            qqwz_策定:{
                enable:"phaseUse",
                usable:1,
                audio:["qqwz策定",2],
                position:"he",
                filterCard:function (card){
        return card.name=='sha'||get.type(card)=='equip'||get.type(card)=='basic';
    },
                filter:function (event,player){
        return player.num('h','sha')>0||player.num('he',{type:'equip'})>0||player.num('h',{type:'basic'})>0;
    },
                check:function (card){return 8-ai.get.value(card)},
                selectTarget:2,
                multitarget:true,
                discard:false,
                targetprompt:["得到牌","攻击目标"],
                prepare:"give",
                filterTarget:function (card,player,target){
        if(ui.selected.targets.length==0){
            return player!=target;
        }
        else{
            return lib.filter.filterTarget({name:'sha'},ui.selected.targets[0],target);
        }
    },
                content:function (){
        "step 0"
        targets[0].gain(cards,player);
        "step 1"
        targets[0].chooseControl('摸牌','出杀和决斗',function(){
            var player=_status.event.player;
            var target=_status.event.target;
            if(ai.get.effect(_status.event.target,{name:'sha'},player,player)>0){
                return 1;
            }
            return 0;
        }).set('target',targets[1]).set('prompt','对'+get.translation(targets[1])+'使用一张杀和一张决斗，或摸二张牌');
        "step 2"
        if(result.control=='摸牌'){
            targets[0].draw(2);
        }
        else{
            targets[0].useCard({name:'sha'},targets[1]);
            targets[0].useCard({name:'juedou'},targets[1]);
        }
    },
                ai:{
                    result:{
                        player:function (player){
                var players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(players[i]!=player&&ai.get.attitude(player,players[i])>1&&ai.get.attitude(players[i],player)>1){
                        return 1;
                    }
                }
                return 0;
            },
                        target:function (player,target){
                if(ui.selected.targets.length){
                    return -0.1;
                }
                return 1;
            },
                    },
                    order:8.5,
                    expose:0.2,
                },
            },
            qqwz_殉道:{
                audio:["qqwz殉道",2],
                trigger:{
                    player:"damageEnd",
                },
                forced:true,
                filter:function (event,player){
        return _status.currentPhase!=player;
    },
                content:function (){
        player.addTempSkill('qqwz_殉道2',['phaseAfter','phaseBefore']);
    },
            },
            qqwz_殉道2:{
                trigger:{
                    target:"useCardToBefore",
                },
                audio:["qqwz殉道",2],
                group:["qqwz_殉道3","qqwz_殉道4"],
                forced:true,
                priority:15,
                filter:function (event,player){
        return get.type(event.card)=='trick'||get.type(event.card)=='basic';
    },
                content:function (){
        game.log(player,'发动了殉道，',trigger.card,'对',trigger.target,'失效')
        trigger.untrigger();
        trigger.finish();
    },
                mark:true,
                intro:{
                    content:"一切伤害对你无效",
                },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='trick'||get.type(card)=='basic') return [0,0,0,0];
            },
                    },
                },
            },
            qqwz_殉道3:{
                audio:["qqwz殉道",2],
                trigger:{
                    player:"loseHpBefore",
                },
                forced:true,
                popup:false,
                filter:function (event,player){
return Math.random()<=1;
},
                content:function (){
trigger.untrigger();
trigger.finish();
},
            },
            qqwz_殉道4:{
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                popup:false,
                filter:function (event,player){
return Math.random()<=1;
},
                content:function (){
trigger.untrigger();
trigger.finish();  
},
            },
            qqwz_繁华:{
                audio:["qqwz繁华",2],
                trigger:{
                    player:"phaseDrawBegin",
                },
                content:function (){
        player.draw(3);
        player.addTempSkill('qqwz_繁华2','phaseAfter');
    },
                ai:{
                    threaten:1.5,
                },
            },
            qqwz_繁华2:{
                audio:["qqwz繁华",2],
                trigger:{
                    player:"useCard",
                },
                frequent:true,
                filter:function (event){
        return (get.type(event.card)=='basic');
    },
                content:function (){
        'step 0'
        var card=get.cardPile(function(card){
            return get.type(card)=='trick';
        });
        event.card=card;
        'step 1'
        if(event.card){
            player.gain(game.createCard(event.card),'gain2');
        }
    },
                ai:{
                    threaten:1.4,
                },
            },
            qqwz_汉室:{
                audio:["qqwz汉室",2],
                group:"qqwz_汉室2",
                trigger:{
                    player:"phaseDiscardBefore",
                },
                forced:true,
                content:function (){
    player.gainMaxHp();
    trigger.untrigger();
    trigger.finish();
},
                mod:{
                    globalTo:function (from,to,distance){
            return distance+2;
        },
                },
            },
            qqwz_汉室2:{
                audio:["qqwz汉室",2],
                enable:"phaseUse",
                usable:2,
                viewAs:{
                    name:"tao",
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"diamond","number":11,"name":"bxyr_kaitianfu","_transform":"translateX(448px)","_mouseentercreated":false,"clone":{"name":"bxyr_kaitianfu","suit":"diamond","number":11,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":494},"original":"h","timeout":464},{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"diamond","number":2,"name":"jihuocard","_transform":"translateX(336px)","_mouseentercreated":false,"clone":{"name":"jihuocard","suit":"diamond","number":2,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":495},"original":"h","timeout":465}],
                },
                filterCard:function (card,player){
        if(ui.selected.cards.length){
            return get.suit(card)==get.suit(ui.selected.cards[0]);
        }
        var cards=player.get('h');
        for(var i=0;i<cards.length;i++){
            if(card!=cards[i]){
                if(get.suit(card)==get.suit(cards[i])) return true;
            }
        }
        return false;
    },
                selectCard:2,
                complexCard:true,
                check:function (card){
        return 6-ai.get.value(card);
    },
                ai:{
                    basic:{
                        order:10,
                        useful:1,
                        value:5,
                    },
                    wuxie:function (target,card,player,viewer){
            if(ai.get.attitude(viewer,target)>0&&target.num('h','shan')){
                if(!target.num('h')||target.hp==1||Math.random()<0.7) return 0;
            }
        },
                    result:{
                        target:function (player,target){
                if(player.hasUnknown(2)&&get.mode()!='guozhan') return 0;
                var nh=target.num('h');
                if(get.mode()=='identity'){
                    if(target.isZhu&&nh<=2&&target.hp<=1) return -100;
                }
                if(nh==0) return -2;
                if(nh==1) return -1.7
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:1,
                        multitarget:1,
                        multineg:1,
                        recover:1,
                        save:1,
                    },
                },
            },
            qqwz_威视:{
                audio:["qqwz威视",2],
                trigger:{
                    global:"phaseBegin",
                },
                check:function (event,player){
        if(ai.get.attitude(player,event.player)<-2){
            var cards=player.get('h');
            if(cards.length>player.hp) return true;
            for(var i=0;i<cards.length;i++){
                var useful=ai.get.useful(cards[i]);
                if(useful<5) return true;
                if(cards[i].number>9&&useful<7) return true;
            }
        }
        return false;
    },
                logTarget:"player",
                filter:function (event,player){
        return event.player!=player&&
            player.num('h')>0&&event.player.num('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(trigger.player);
        "step 1"
        if(result.bool){
            player.draw(2);
            trigger.player.addTempSkill('qqwz_威视2','phaseAfter');
        }
    },
            },
            qqwz_威视2:{
                trigger:{
                    player:"UseCard",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player&&Math.random()<=0.3;
},
                content:function (){
player.loseHp();
},
                mod:{
                    playerEnabled:function (card,player,target){
            if(player!=target) return false;
        },
                },
            },
            qqwz_牵连:{
                audio:["qqwz牵连",2],
                trigger:{
                    target:"shaBefore",
                },
                direct:true,
                priority:11,
                selectTarget:[1,3],
                content:function (){
        "step 0"
        player.chooseTarget([1,3],get.prompt('qqwz_牵连'),function(card,player,target){
            return target!=player&&_status.event.getTrigger().player.canUse('sha',target,false);
        }).set('ai',function(target){
            var trigger=_status.event.getTrigger();
            var player=_status.event.player;
            return ai.get.effect(target,trigger.card,trigger.player,player)+0.1;
        });
        "step 1"
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('qqwz_牵连',target);
            event.target=target;
            target.chooseCard({name:'shan'},'交给'+get.translation(player)+
            '一张闪，或成为此杀的额外目标').set('ai',function(card){
                return ai.get.attitude(target,_status.event.source)>=0?1:-1;
            }).set('source',player);
            game.delay();
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            player.gain(result.cards,event.target);
            event.target.$give(result.cards,player);
            game.delay();
        }
        else{
            player.recover();
            trigger.targets.push(event.target);
            game.log(event.target,'成为了额外目标');
        }
    },
                ai:{
                    expose:0.2,
                    effect:{
                        target:function (card,player,target){
                if(card.name!='sha') return;
                var players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    var target2=players[i];
                    if(player!=target2&&target!=target2&&player.canUse(card,target2,false)&&
                        ai.get.effect(target2,{name:'shacopy',nature:card.nature,suit:card.suit},player,target)<0){
                        if(target.hp==target.maxHp) return [0,1];
                        return [0,0];
                    }
                }
            },
                    },
                },
            },
            qqwz_抵命:{
                mod:{
                    cardEnabled:function (card,player){
            if(card.name=='tao'&&_status.event.skill!='qqwz_抵命') return false;
        },
                    cardUsable:function (card,player){
            if(card.name=='tao'&&_status.event.skill!='qqwz_抵命') return false;
        },
                    cardRespondable:function (card,player){
            if(card.name=='tao'&&_status.event.skill!='qqwz_抵命') return false;
        },
                    cardSavable:function (card,player){
            if(card.name=='tao'&&_status.event.skill!='qqwz_抵命') return false;
        },
                },
                enable:["chooseToUse","chooseToRespond"],
                audio:["qqwz抵命",2],
                filter:function (event,player){
        return player.num('h','tao')>0;
    },
                filterCard:{
                    name:"tao",
                },
                viewAs:{
                    name:"guohe",
                    suit:"heart",
                    number:3,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"heart","number":3,"name":"tao","_transform":"translateX(448px)","_mouseentercreated":false,"clone":{"name":"tao","suit":"heart","number":3,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":1874},"original":"h","timeout":1842}],
                },
                viewAsFilter:function (player){
        if(!player.num('h','tao')) return false;
    },
                check:function (){return 1},
                ai:{
                    skillTagFilter:function (player){
            if(!player.num('h','tao')) return false;
        },
                    respondSha:true,
                    order:4,
                    useful:-1,
                    value:-1,
                    basic:{
                        order:5,
                        useful:1,
                        value:4.5,
                    },
                    result:{
                        target:-1.5,
                        player:function (player,target){
                if(ai.get.damageEffect(target,player,target)>0&&ai.get.attitude(player,target)>0&&ai.get.attitude(target,player)>0){
                    return 0;
                }
                var hs1=target.get('h','sha');
                var hs2=player.get('h','sha');
                if(hs1.length>hs2.length+1){
                    return -2;
                }
                var hsx=target.get('h');
                if(hsx.length>2&&hs2.length==0&&hsx[0].number<6){
                    return -2;
                }
                if(hsx.length>3&&hs2.length==0){
                    return -2;
                }
                if(hs1.length>hs2.length&&(!hs2.length||hs1[0].number>hs2[0].number)){
                    return -2;
                }
                return -0.5;
            },
                    },
                    tag:{
                        respond:2,
                        respondSha:2,
                        damage:1,
                        loseCard:1,
                        discard:1,
                    },
                },
            },
            qqwz_毒谋:{
                audio:["qqwz毒谋",2],
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                filter:function (event,player){
        return game.hasPlayer(function(player){
            return player.num('h')==0;
        });
    },
                content:function (){
        'step 0'
        player.chooseTarget([1,5],get.prompt('qqwz_毒谋'),function(card,player,target){
            return target.num('h')==0;
        }).set('ai',function(target){
            var player=_status.event.player;
            return ai.get.damageEffect(target,player,player);
        });
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_毒谋',result.targets);
            result.targets[0].loseHp(2);
        }
    },
            },
            qqwz_火牢:{
                skillAnimation:"epic",
                animationColor:"fire",
                audio:["qqwz火牢",2],
                enable:"phaseUse",
                filter:function (event,player){
        return !player.storage.qqwz_火牢;
    },
                filterTarget:function (card,player,target){
        return player!=target;
    },
                unique:true,
                selectTarget:-1,
                multitarget:true,
                multiline:true,
                mark:true,
                line:"fire",
                content:function (){
        "step 0"
        player.storage.qqwz_火牢=true;
        player.awakenSkill('qqwz_火牢');
        event.num=1;
        event.targets=targets.slice(0);
        event.targets.sort(lib.sort.seat);
        "step 1"
        if(event.targets.length){
            var target=event.targets.shift();
            event.target=target;
            var res=ai.get.damageEffect(target,player,target,'fire');
            target.chooseToDiscard('he','弃置至少'+get.cnNumber(event.num)+'张牌或受到4点火焰伤害',[num,Infinity]).set('ai',function(card){
                if(ui.selected.cards.length>=_status.event.getParent().num) return -1;
                if(_status.event.player.hasSkillTag('nofire')) return -1;
                if(_status.event.res>=0) return 6-ai.get.value(card);
                if(get.type(card)!='basic'){
                    return 10-ai.get.value(card);
                }
                return 8-ai.get.value(card);
            }).set('res',res);
        }
        else{
            event.finish();
        }
        "step 2"
        if(!result.bool){
            event.target.damage(4,'fire');
            event.num=1;
        }
        else{
            event.num=result.cards.length+2;
        }
        event.goto(1);
    },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                var num=0,players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(player!=players[i]&&ai.get.damageEffect(players[i],player,players[i],'fire')<0){
                        var att=ai.get.attitude(player,players[i]);
                        if(att>0){
                            num--;
                        }
                        else if(att<0){
                            num++;
                        }
                    }
                }
                if(game.players.length<5){
                    return num-1;
                }
                else{
                    return num-2;
                }
            },
                    },
                },
                init:function (player){
        player.storage.xinfencheng=false;
    },
                intro:{
                    content:"limited",
                },
            },
            qqwz_火刑:{
                audio:["qqwz火刑",2],
                usable:2,
                trigger:{
                    global:"loseEnd",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player;
},
                content:function (){
 trigger.player.damage(2,'fire')._triggered=null;
},
            },
            qqwz_破计:{
                audio:["qqwz破计",2],
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                content:function (){
        player.draw(2);
    },
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'&&player!=target){
                return false;
            }
        },
                },
                ai:{
                    playernowuxie:true,
                },
            },
            qqwz_诛族:{
                audio:["qqwz诛族",2],
                enable:"phaseUse",
                usable:2,
                filterCard:function (card){
        return get.type(card,'trick')=='trick';
    },
                filterTarget:function (card,player,target){
        return target!=player&&target.num('h')>0;
    },
                discard:false,
                delay:false,
                check:function (card){
        return 8-ai.get.value(card);
    },
                content:function (){
        'step 0'
        player.showCards(cards);
        'step 1'
        ui.cardPile.insertBefore(cards[0],ui.cardPile.firstChild);
        var n1=target.get('he',function(card){
            if(!lib.filter.cardDiscardable(card,player)) return false;
            return get.type(card,'trick')=='trick';
        });
        var n2=target.get('he',function(card){
            if(!lib.filter.cardDiscardable(card,player)) return false;
            return get.type(card,'trick')!='trick';
        });
        if(n1.length>1||n2.length>2||(n1.length==3&&n2.length==2)){
            target.chooseToDiscard('弃置3张锦囊牌，或两张非锦囊牌',true,'he',function(card,player){
                if(!lib.filter.cardDiscardable(card,player)) return false;
                if(!_status.event.nontrick){
                    return get.type(card,'trick')=='trick';
                }
                if(ui.selected.cards.length){
                    return get.type(card,'trick')!='trick';
                }
                return true;
            }).set('ai',function(card){
                if(get.type(card,'trick')=='trick'){
                    return 8-ai.get.value(card);
                }
                return -ai.get.value(card);
            }).set('selectCard',function(){
                if(ui.selected.cards.length==3&&get.type(ui.selected.cards[0],'trick')=='trick'){
                    return 1;
                }
                return 2;
            }).set('nontrick',n2.length>=2).set('complexCard',true);
        }
        else{
            if(n1.length){
                target.discard(n1);
            }
            else if(n2.length){
                target.discard(n2);
            }
        }
    },
                ai:{
                    order:9,
                    result:{
                        target:-1,
                    },
                },
            },
            qqwz_去病:{
                audio:["qqwz去病",2],
                enable:"phaseUse",
                filterCard:true,
                usable:1,
                check:function (card){
        return 9-ai.get.value(card)
    },
                filterTarget:function (card,player,target){
        if(target.hp>=target.maxHp) return false;
        return true;
    },
                content:function (){
        target.damage(2)._triggered=null;
        player.recover();
    },
                ai:{
                    order:9,
                    result:{
                        target:function (player,target){
                if(target.hp==1) return 5;
                if(player==target&&player.num('h')>player.hp) return 5;
                return 2;
            },
                    },
                    threaten:2,
                },
            },
            qqwz_医心:{
                audio:["qqwz医心",2],
                group:"qqwz_医心2",
                enable:"chooseToUse",
                filter:function (event,player){
        return _status.currentPhase!=player;
    },
                filterCard:function (card){
        return get.color(card)=='red';
    },
                position:"he",
                viewAs:{
                    name:"tao",
                },
                prompt:"将一张红色牌当桃使用",
                check:function (card){return 15-ai.get.value(card)},
                ai:{
                    skillTagFilter:function (player){
            return player.num('he',{color:'red'})>0&&_status.currentPhase!=player;
        },
                    threaten:1.5,
                    save:true,
                    basic:{
                        order:function (card,player){
                if(player.hasSkillTag('pretao')) return 5;
                return 2;
            },
                        useful:[8,6.5],
                        value:[8,6.5],
                    },
                    result:{
                        target:function (player,target){
                // if(player==target&&player.hp<=0) return 2;
                var nd=player.needsToDiscard();
                var keep=false;
                if(nd<=0){
                    keep=true;
                }
                else if(nd==1&&target.hp>=2&&target.num('h','tao')<=1){
                    keep=true;
                }
                var mode=get.mode();
                if(target.hp>=2&&keep&&target.hasFriend()){
                    if(target.hp>2||nd==0) return 0;
                    if(target.hp==2){
                        if(game.hasPlayer(function(current){
                            if(target!=current&&ai.get.attitude(target,current)>=3){
                                if(current.hp<=1) return true;
                                if((mode=='identity'||mode=='versus'||mode=='chess')&&current.identity=='zhu'&&current.hp<=2) return true;
                            }
                        })){
                            return 0;
                        }
                    }
                }
                if(target.hp<0&&target!=player&&target.identity!='zhu') return 0;
                var att=ai.get.attitude(player,target);
                if(att<3&&att>=0&&player!=target) return 0;
                var tri=_status.event.getTrigger();
                if(mode=='identity'&&player.identity=='fan'&&target.identity=='fan'){
                    if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='fan'&&tri.source!=target){
                        var num=game.countPlayer(function(current){
                            if(current.identity=='fan'){
                                return current.num('h','tao');
                            }
                        });
                        if(num>1&&player==target) return 2;
                        return 0;
                    }
                }
                if(mode=='identity'&&player.identity=='zhu'&&target.identity=='nei'){
                    if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='zhong'){
                        return 0;
                    }
                }
                if(mode=='stone'&&target.isMin()&&
                player!=target&&tri&&tri.name=='dying'&&player.side==target.side&&
                tri.source!=target.getEnemy()){
                    return 0;
                }
                return 2;
            },
                    },
                    tag:{
                        recover:1,
                        save:1,
                    },
                },
            },
            qqwz_医心2:{
                audio:["qqwz医心",2],
                trigger:{
                    player:"recoverBefore",
                },
                forced:true,
                content:function (){
player.hp==player.MaxHp;
},
            },
            qqwz_去病2:{
                audio:["qqwz去病",2],
                trigger:{
                    player:"damageEnd",
                },
                direct:true,
                content:function (){
      player.recover();
    },
                ai:{
                    expose:0.5,
                },
            },
            qqwz_缓图:{
                audio:["qqwz缓图",2],
                group:"qqwz_缓图2",
                trigger:{
                    player:"useCard",
                },
                forced:true,
                filter:function (event,player){
      return Math.random()<=0.5;
},
                content:function (){
        player.draw();
        player.recover();
    },
                intro:{
                    content:"card",
                },
            },
            qqwz_缓图2:{
                audio:["qqwz缓图",2],
                trigger:{
                    player:"useCardAfter",
                },
                forced:true,
                filter:function (event,player){
   return get.type(event.card)=='basic'&&Math.random()<=0.4;
},
                content:function (){
player.useCard(trigger.card,trigger.targets,false)._triggered=null;
},
            },
            qqwz_鸿鹄:{
                audio:["qqwz鸿鹄",2],
                group:"qqwz_鸿鹄2",
                trigger:{
                    player:"damageAfter",
                },
                forced:true,
                content:function (){
        player.draw();
        player.recover();
    },
            },
            qqwz_鸿鹄2:{
                audio:["qqwz鸿鹄",2],
                trigger:{
                    global:"discardAfter",
                },
                filter:function (event,player){
        for(var i=0;i<event.cards.length;i++){
            if(get.position(event.cards[i])=='d'){
                return true;
            }
        }
        return false;
    },
                direct:true,
                popup:false,
                content:function (){
        "step 0"
        if(trigger.delay==false) game.delay();
        event.cards=[];
        for(var i=0;i<trigger.cards.length;i++){
            if(get.position(trigger.cards[i])=='d'){
                event.cards.push(trigger.cards[i]);
                ui.special.appendChild(trigger.cards[i]);
            }
        }
        "step 1"
        if(event.cards.length){
            player.chooseCardButton(get.prompt('qqwz_鸿鹄2'),event.cards,[1,event.cards.length]).set('ai',function(button){
                if(!_status.event.goon||ui.selected.buttons.length) return 0;
                return 1;
            }).set('goon',game.hasPlayer(function(current){
                return Math.abs(ai.get.attitude(player,current))>1;
            }));
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            event.togive=result.links.slice(0);
            player.chooseTarget('将'+get.translation(result.links)+'交给一名角色',true,function(card,player,target){
                return target!=player;
            }).set('ai',function(target){
                var att=ai.get.attitude(_status.event.player,target);
                if(_status.event.enemy){
                    return -att;
                }
                else{
                    if(att>2) return att/Math.sqrt(1+target.num('h'));
                    return att/Math.sqrt(1+target.num('h'))/5;
                }
            }).set('enemy',ai.get.value(event.togive[0])<0);
        }
        else{
            for(var i=0;i<event.cards.length;i++){
                ui.discardPile.appendChild(event.cards[i]);
            }
            event.finish();
        }
        "step 3"
        if(result.bool){
            player.logSkill('qqwz_鸿鹄2',result.targets);
            for(var i=0;i<event.togive.length;i++){
                event.cards.remove(event.togive[i]);
            }
            result.targets[0].gain(event.togive,player);
            result.targets[0].$gain2(event.togive);
            event.goto(1);
        }
        else{
            for(var i=0;i<event.cards.length;i++){
                ui.discardPile.appendChild(event.cards[i]);
            }
            event.finish();
        }
    },
                ai:{
                    expose:0.1,
                    effect:{
                        target:function (card,player,target,current){
                if(target.hasFriend()&&get.tag(card,'discard')){
                    if(current<0) return 0;
                    return [1,1];
                }
            },
                    },
                },
            },
            qqwz_隔墙:{
                audio:["qqwz隔墙",2],
                trigger:{
                    global:"phaseEnd",
                },
                filter:function (event,player){
        return event.player!=player&&event.player.isAlive();
    },
                frequent:true,
                content:function (){
        "step 0"
        if(trigger.player.num('e')){
            player.choosePlayerCard(trigger.player,'e','选择装备一张装备牌并令其翻面，或取消并摸二张牌');
        }
        "step 1"
        if(result&&result.links&&result.links.length){
            game.delay(2);
            trigger.player.$give(result.links[0],player);
            trigger.player.turnOver();
            player.equip(result.links[0]);
            player.line(trigger.player);
        }
        else{
            player.draw(2);
        }
    },
                ai:{
                    expose:0.1,
                },
            },
            qqwz_投曹:{
                skillAnimation:true,
                audio:["qqwz投曹",2],
                unique:true,
                enable:"phaseUse",
                filter:function (event,player){
        return !player.storage.qqwz_投曹&&player.num('e')>0;
    },
                init:function (player){
        player.storage.qqwz_投曹=false;
    },
                filterTarget:function (card,player,target){
        return player!=target;
    },
                mark:true,
                content:function (){
        "step 0"
        player.awakenSkill('qqwz_投曹');
        var cards=player.get('e');
        target.gain(cards,player);
        event.num=cards.length;
        player.$give(cards,target);
        player.storage.qqwz_投曹=true;
        game.delay();
        "step 1"
        target.chooseTarget([1,event.num],'令'+get.translation(player)+'回复'+
            event.num+'点体力并令其摸'+event.num+'张牌，或对攻击范围内的'+event.num+'名角色造成2点伤害',function(card,player,target2){
            return get.distance(_status.event.player,target2,'attack')<=1;
        }).set('ai',function(target2){
            var target=_status.event.player;
            var player=_status.event.getParent().player;
            if(ai.get.attitude(target,player)>0){
                if(player.hp+event.num<=player.maxHp||player.hp==1) return -1;
            }
            return ai.get.damageEffect(target2,target,target);
        });
        "step 2"
        if(result.bool){
            target.line(result.targets,'green');
            event.targets=result.targets;
            event.num2=0;
        }
        else{
            player.recover(event.num);
            player.draw(event.num);
            event.finish();
        }
        "step 3"
        if(event.num2<event.targets.length){
            event.targets[event.num2].damage(2,target);
            event.num2++;
            event.redo();
        }
    },
                intro:{
                    content:"limited",
                },
                ai:{
                    order:1,
                    result:{
                        target:1,
                        player:function (player){
                var bool=true,players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(players[i]!=player&&ai.get.attitude(player,players[i])>2&&ai.get.attitude(players[i],player)>2){
                        bool=false;break;
                    }
                }
                if(bool) return -10;
                if(player.hp==1) return 1;
                if(game.phaseNumber<game.players.length) return -10;
                if(player.num('e')+player.hp<=player.maxHp) return 1;
                return -10;
            },
                    },
                },
            },
            qqwz_罪业:{
                audio:["qqwz罪业",2],
                group:["qqwz_罪业2","qqwz_罪业3"],
                enable:"phaseUse",
                usable:1,
                delay:0,
                filter:function (event,player){
        return player.num('h',{color:'red'})&&player.num('h',{color:'black'});
    },
                content:function (){
        'step 0'
        player.chooseControl('红色','黑色').set('ai',function(){
            var player=_status.event.player;
            if(player.num('h',{color:'red'})==1&&
            player.num('h',{color:'black'})>1) return '红色';
            return '黑色';
        });
        'step 1'
        event.control=result.control;
        player.showHandcards();
        'step 2'
        var cards;
        if(event.control=='红色'){
            cards=player.get('h',{color:'red'});
        }
        else{
            cards=player.get('h',{color:'black'});
        }
        player.discard(cards);
        event.num=cards.length;
        'step 3'
        player.chooseTarget([1,event.num],function(card,player,target){
            return target!=player&&target.num('he')>0;
        }).set('ai',function(target){
            return -ai.get.attitude(_status.event.player,target)+0.5;
        });
        'step 4'
        if(result.bool&&result.targets){
            player.line(result.targets,'green');
            event.targets=result.targets;
            event.targets.sort(lib.sort.seat);
            event.gained=event.targets.length;
        }
        else{
            event.finish();
        }
        'step 5'
        if(event.targets.length){
            player.gainPlayerCard(2,event.targets.shift(),'he',true);
            event.redo();
        }
        'step 6'
        if(event.gained>=5){
            player.loseMaxHp();
        }
    },
                ai:{
                    order:function (item,player){
            if(player.num('h',{color:'red'})==1) return 10;
            if(player.num('h',{color:'black'})==1) return 10;
            return 1;
        },
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_罪业2:{
                audio:["qqwz罪业",2],
                trigger:{
                    player:"phaseDiscardBefore",
                },
                forced:true,
                content:function (){
    trigger.untrigger();
    trigger.finish();
},
            },
            qqwz_罪业3:{
                audio:["qqwz罪业",2],
                trigger:{
                    player:"loseHpBefore",
                },
                forced:true,
                popup:false,
                filter:function (event,player){
return Math.random()<=1;
},
                content:function (){
trigger.untrigger();
trigger.finish();
},
            },
            qqwz_推卸:{
                audio:["qqwz推卸",2],
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                content:function (){
         "step 0"
        player.chooseTarget(get.prompt('qqwz_推卸'),function(card,player,target){
                    return target!=event.player&&target.num('he')>0;
                });
        "step 1"
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('qqwz_推卸',target);
            target.draw(2);
            player.draw();
            trigger.untrigger();
            trigger.finish();
        }
},
            },
            qqwz_谗言:{
                audio:["qqwz谗言",2],
                trigger:{
                    player:"phaseUseBegin",
                },
                check:function (event,player){
        var nh=player.num('h')-player.num('h',{type:'equip'});
        if(nh<=1) return true;
        if(player.num('h','tao')) return false;
        if(nh<=2) return Math.random()<0.7;
        if(nh<=3) return Math.random()<0.4;
        return false;
    },
                content:function (){
        player.draw(3);
        player.addTempSkill('qqwz_谗言2','phaseAfter');
    },
            },
            qqwz_谗言2:{
                audio:["qqwz谗言",2],
                trigger:{
                    source:"damageEnd",
                },
                forced:true,
                content:function (){
       player.draw();
},
                mod:{
                    maxHandcard:function (player,num){
            var damage=player.getStat().damage;
            if(typeof damage=='number') return num-player.hp+damage;
            return 0;
        },
                },
            },
            qqwz_乱国:{
                audio:["qqwz乱国",2],
                group:["qqwz_乱国延迟锦囊","qqwz_乱国锦囊","qqwz_乱国基本","qqwz_乱国机关","qqwz_乱国回合"],
                enable:"phaseUse",
                usable:2,
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[],food:[],jiguan:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('食物',[list.food,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=[];
                for(var i=0;i<game.players.length;i++){
                    if(lib.filter.filterTarget(card,player,game.players[i])){
                        targets.push(game.players[i]);
                    }
                }
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                // player.addTempSkill('moon_15_5_1',{player:'Begin'});
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
            player.useCard(event.card,result.targets);
        }
     

    },
                ai:{
                    order:9,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_乱国锦囊:{
                enable:"phaseUse",
                audio:["qqwz乱国",2],
                usable:2,
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[],food:[],jiguan:[],jiqi:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('锦囊',[list.trick,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=[];
                for(var i=0;i<game.players.length;i++){
                    if(lib.filter.filterTarget(card,player,game.players[i])){
                        targets.push(game.players[i]);
                    }
                }
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                // player.addTempSkill('moon_15_5_1',{player:'Begin'});
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
            player.useCard(event.card,result.targets);
        }
     

    },
                ai:{
                    order:4,
                    result:{
                        player:function (player){
                var allshown=true,players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(players[i].ai.shown==0){
                        allshown=false;
                    }
                    if(players[i]!=player&&players[i].num('h')&&ai.get.attitude(player,players[i])>0){
                        return 1;
                    }
                }
                if(allshown) return 1;
                return 0;
            },
                    },
                    threaten:1.6,
                },
            },
            qqwz_乱国基本:{
                audio:["qqwz乱国",2],
                enable:"phaseUse",
                usable:2,
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[],food:[],jiguan:[],jiqi:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('基本',[list.basic,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=[];
                for(var i=0;i<game.players.length;i++){
                    if(lib.filter.filterTarget(card,player,game.players[i])){
                        targets.push(game.players[i]);
                    }
                }
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                // player.addTempSkill('moon_15_5_1',{player:'Begin'});
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
            player.useCard(event.card,result.targets);
        }
     

    },
                ai:{
                    order:9,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_乱国机关:{
                audio:["qqwz乱国",2],
                enable:"phaseUse",
                usable:2,
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[],food:[],jiguan:[],jiqi:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('机关',[list.jiguan,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=[];
                for(var i=0;i<game.players.length;i++){
                    if(lib.filter.filterTarget(card,player,game.players[i])){
                        targets.push(game.players[i]);
                    }
                }
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                // player.addTempSkill('moon_15_5_1',{player:'Begin'});
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
            player.useCard(event.card,result.targets);
        }
     

    },
                ai:{
                    order:9,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_乱国延迟锦囊:{
                audio:["qqwz乱国",2],
                enable:"phaseUse",
                usable:2,
                content:function (){
        'step 0'
        var list={basic:[],equip:[],trick:[],delay:[],food:[],jiguan:[],jiqi:[]};
        for(var i=0;i<lib.inpile.length;i++){
            var name=lib.inpile[i];
            var info=lib.card[name];
            if(info.autoViewAs||name=='yuansuhuimie') continue;
            if(lib.filter.cardEnabled({name:name},player)){
                if(!list[info.type]){
                    list[info.type]=[];
                }
                list[info.type].push([get.translation(lib.card[name].type),'',name]);
            }
        }
        list.trick.sort(lib.sort.name);
        var dialog=ui.create.dialog('延迟锦囊',[list.delay,'vcard']);
        // for(var i in list){
        //     dialog.addText(get.translation(i)+'牌');
        //     dialog.add([list[i],'vcard']);
        // }
        var rand1=Math.random()<1/3;
        var rand2=Math.random()<0.5;
        var rand3=Math.random()<1/3;
        var rand4=Math.random()<1/3;
        player.chooseButton(dialog).ai=function(button){
            var name=button.link[2];
            if(player.hp<=1){
                switch(name){
                    case 'zhiliaobo':return 1;
                    case 'dunpaigedang':return 0.8;
                    case 'nanman':return 0.5;
                    default:return 0;
                }
            }
            if(rand4&&player.num('h')<=1){
                switch(name){
                    case 'zengbin':return 1;
                    case 'wuzhong':return 0.8;
                    default:return 0;
                }
            }
            if(player.hasSkill('qinglonglingzhu')){
                if(rand2) return name=='chiyuxi'?0.8:0;
                return name=='jingleishan'?0.8:0;
            }
            if(rand2) return name=='wanjian'?0.8:0;
            return name=='nanman'?0.8:0;
        }
        'step 1'
        if(result.bool){
            var name=result.links[0][2];
            var info=lib.card[name];
            var card=game.createCard(name);
            if(info.selectTarget==-1){
                var targets=[];
                for(var i=0;i<game.players.length;i++){
                    if(lib.filter.filterTarget(card,player,game.players[i])){
                        targets.push(game.players[i]);
                    }
                }
                if(targets.length){
                    targets.sort(lib.sort.seat);
                    // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
                    player.useCard(card,targets);
                }
                event.finish();
            }
            else if(info.notarget){
                // player.addTempSkill('moon_15_5_1',{player:'Begin'});
                player.useCard(card);
            }
            else{
                var next=player.chooseTarget('选择'+get.translation(name)+'的目标');
                next._get_card=card;
                next.filterTarget=lib.filter.filterTarget;
                next.ai=ai.get.effect;
                if(typeof info.selectTarget=='function'){
                    next.selectTarget=info.selectTarget;
                }
                else{
                    next.selectTarget=get.select(info.selectTarget);
                }
                event.card=card;
            }
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.bool){
            // player.addTempSkill('moon_15_5_1',{player:'phaseBegin'});
            player.useCard(event.card,result.targets);
        }
     

    },
                ai:{
                    order:9,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_乱国回合:{
                audio:["qqwz乱国",2],
                trigger:{
                    global:"phaseBefore",
                },
                forced:true,
                filter:function (event,player){
     return player!=event.player;
},
                content:function (){
     player.phase();
},
            },
            qqwz_并起:{
                audio:["qqwz并起",2],
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target;
    },
                selectTarget:function (){
        return [1,4];
    },
                position:"he",
                check:function (card){
        return 8-ai.get.useful(card);
    },
                content:function (){
        "step 0"
        player.draw(2);
        player.recover(3);
        "step 1"
        target.draw(4);
    },
                ai:{
                    threaten:1.5,
                    result:{
                        target:function (player,target){
                return -target.num('h');
            },
                    },
                    order:10,
                    expose:0.4,
                },
            },
            qqwz_让梨:{
                audio:["qqwz让梨",2],
                group:"qqwz_让梨2",
                trigger:{
                    player:"phaseDrawBegin",
                },
                frequent:true,
                content:function (){
        trigger.num+=3;
    },
                ai:{
                    threaten:1.3,
                },
            },
            qqwz_儒门:{
                audio:["qqwz儒门",2],
                trigger:{
                    player:"damageBegin",
                },
                filter:function (event,player){
        return event.source&&event.source.hp<player.hp;
    },
                content:function (){
        trigger.num=0;
    },
                ai:{
                    threaten:0.8,
                },
            },
            qqwz_让梨2:{
                audio:["qqwz让梨",2],
                trigger:{
                    player:"phaseDiscardBefore",
                },
                forced:true,
                content:function (){
    trigger.untrigger();
    trigger.finish();
},
            },
            qqwz_秉忠:{
                trigger:{
                    player:"discardAfter",
                },
                direct:true,
                audio:["qqwz秉忠",2],
                filter:function (event,player){
        for(var i=0;i<event.cards.length;i++){
            if(get.position(event.cards[i])=='d'){
                return true;
            }
        }
        return false;
    },
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_秉忠'),function(card,player,target){
            return player!=target&&target.num('he')>0;
        }).set('ai',function(target){
            return -ai.get.attitude(_status.event.player,target);
        });
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_秉忠',result.targets);
            event.target=result.targets[0];
            player.discardPlayerCard(2,event.target,true);
        }
        else{
            event.finish();
        }
    },
                ai:{
                    expose:0.2,
                },
            },
            qqwz_孤援:{
                audio:["qqwz孤援",2],
                trigger:{
                    global:"damageEnd",
                },
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('孤援'),function(card,player,target){
                    return target.hp!=0;
                });
        "step 1"
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('qqwz_孤援',target);
            target.draw();
            player.recover(2);
        }
    },
                ai:{
                    threaten:1.5,
                    result:{
                        target:function (player,target){
                return -target.num('h');
            },
                    },
                    order:10,
                    expose:0.4,
                },
            },
            qqwz_妖艳:{
                audio:["qqwz妖艳",2],
                group:"qqwz_妖艳2",
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                content:function (){
        game.countPlayer(function(current){
            if(current!=player&&!current.hasSkill('fengyin')){
                player.line(current,'green');
                current.addTempSkill('fengyin','phaseAfter');
            }
        });
    },
            },
            qqwz_醉魂:{
                audio:["qqwz醉魂",2],
                enable:"phaseUse",
                filter:function (event,player){
        return player.num('he',{type:'equip'});
    },
                filterCard:{
                    type:"equip",
                },
                position:"he",
                filterTarget:function (card,player,target){
        return target!=player;
    },
                check:function (card){
        var player=_status.event.player;
        if(game.hasPlayer(function(current){
            return ai.get.attitude(player,current)>2&&current.isTurnedOver();
        })){
            return 10-ai.get.value(card,player);
        }
        return 6-ai.get.value(card,player);
    },
                content:function (){
        'step 0'
        target.turnOver();
        'step 1'
        target.draw();
        player.draw();
    },
                ai:{
                    order:8,
                    result:{
                        target:function (player,target){
                if(target.isTurnedOver()) return 2;
                return -0.5;
            },
                    },
                },
            },
            qqwz_妖艳2:{
                audio:["qqwz妖艳",2],
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                filter:function (event){       
        return event.source.sex=='male';
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        trigger.source.loseHp();
    },
            },
            qqwz_战神:{
                group:["qqwz_战神决斗","qqwz_战神伤害","qqwz_战神闪杀","qqwz_战神绝境","qqwz_战神免致死","qqwz_战神无视防具"],
                mod:{
                    targetInRange:function (card,player,target,now){
            if(card.name=='sha') return true;
        },
                },
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                audio:["qqwz战神",2],
                filter:function (event,player){
        return event.card;
    },
                content:function (){
        trigger.directHit=true;
    },
            },
            qqwz_战神决斗:{
                audio:["qqwz战神",2],
                trigger:{
                    player:"juedou",
                    target:"juedou",
                },
                forced:true,
                filter:function (event,player){
        return event.turn!=player;
    },
                content:function (){
        "step 0"
        var next=trigger.turn.chooseToRespond({name:'sha'});
        next.autochoose=lib.filter.autoRespondSha;
        next.ai=function(card){
            if(ai.get.attitude(trigger.turn,player)<0&&trigger.turn.num('h','sha')>1){
                return ai.get.unuseful2(card);
            }
            return -1;
        };
        "step 1"
        if(result.bool==false){
            trigger.directHit=true;
        }
    },
                ai:{
                    result:{
                        target:function (card,player,target){
                if(card.name=='juedou'&&target.num('h')>0) return [1,0,0,-1];
            },
                    },
                },
            },
            qqwz_战神闪杀:{
                audio:["qqwz战神",2],
                enable:["chooseToUse","chooseToRespond"],
                filterCard:{
                    name:"shan",
                },
                viewAs:{
                    name:"sha",
                    suit:"diamond",
                    number:5,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"diamond","number":5,"name":"shan","_transform":"translateX(112px)","_mouseentercreated":false,"clone":{"name":"shan","suit":"diamond","number":5,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":327},"original":"h","timeout":307}],
                },
                viewAsFilter:function (player){
                if(!player.num('h','shan')) return false;
            },
                prompt:"将一张闪当杀使用或打出",
                check:function (){return 1},
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                        if(get.tag(card,'respondSha')&&current<0) return 0.6
                    },
                    },
                    respondSha:true,
                    skillTagFilter:function (player){
                    if(!player.num('h','shan')) return false;
                },
                    order:function (){
                    return ai.get.order({name:'sha'})+0.1;
                },
                    useful:-1,
                    value:-1,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    result:{
                        target:function (player,target){
                        if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                            if(ai.get.attitude(player,target)>0){
                                return -6;
                            }
                            else{
                                return -3;
                            }
                        }
                        return -1.5;
                    },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                        if(card.nature=='poison') return;
                        return 1;
                    },
                        natureDamage:function (card){
                        if(card.nature) return 1;
                    },
                        fireDamage:function (card,nature){
                        if(card.nature=='fire') return 1;
                    },
                        thunderDamage:function (card,nature){
                        if(card.nature=='thunder') return 1;
                    },
                        poisonDamage:function (card,nature){
                        if(card.nature=='poison') return 1;
                    },
                    },
                },
            },
            qqwz_战神伤害:{
                audio:["qqwz战神",2],
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                filter:function (event,player){
        return player.getStat('damage')>=4;
    },
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('战神'),function(card,player,target){
                    return player.getStat('damage')>=4;
                });
        "step 1"
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('qqwz_战神_伤害',target);
            target.damage(4)._triggered=null;
        }
    },
            },
            qqwz_战神绝境:{
                audio:["qqwz战神",2],
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                priority:-500,
                content:function (){
if(trigger.num>1) trigger.num=1
},
            },
            qqwz_战神免致死:{
                audio:["qqwz战神",2],
                trigger:{
                    player:"dieBefore",
                },
                forced:true,
                unique:true,
                filter:function (event,player){
       return player.hp>=1;

    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        player.hp==player.hp;
},
            },
            qqwz_无前:{
                audio:["qqwz无前",2],
                group:["qqwz_无前2","qqwz_无前3","qqwz_无前4","qqwz_无前5"],
                trigger:{
                    source:"damageEnd",
                },
                forced:true,
                priority:55,
                content:function (){
        var list=["juedou"];
        player.gain(game.createCard(list.randomGet()));
        player.$draw();
    },
            },
            qqwz_无前2:{
                audio:["qqwz无前",2],
                trigger:{
                    source:"damageEnd",
                },
                forced:true,
                filter:function (event,player){
    return event.card&&event.card.name=='juedou'&&Math.random()<=0.7;;
},
                content:function (){
        trigger.player.die();
},
                mod:{
                    cardUsable:function (card,player,num){
          if(card.name=='juedou') return Infinity;
    },
                },
            },
            qqwz_无前3:{
                audio:["qqwz无前",2],
                trigger:{
                    global:"gainEnd",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player&&Math.random()<=0.6;
},
                content:function (){
player.draw();
},
            },
            qqwz_无前4:{
                audio:["qqwz无前",2],
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                content:function (){
        var hq=player.num('e');
        player.changeHujia(hq);
},
            },
            qqwz_无前5:{
                audio:["qqwz无前",2],
                trigger:{
                    global:"damageBefore",
                },
                forced:true,
                filter:function (event,player){
    return player!=event.player;
},
                content:function (){
       game.me.hp+=1;
},
            },
            qqwz_战神无视防具:{
                ai:{
                    unequip:true,
                    skillTagFilter:function (player,tag,arg){
                    if(arg&&arg.name=='sha') return true;
                    return false;
                },
                },
            },
            qqwz_进击:{
                audio:["qqwz进击",2],
                group:"qqwz_进击2",
                trigger:{
                    source:"damageEnd",
                },
                direct:true,
                filter:function (event){
     return event.card&&event.card.name=='sha'&&event.cards&&event.player.num('e');
    },
                content:function (){
        "step 0"
        player.choosePlayerCard('e',trigger.player);
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_进击');
            trigger.player.discard(result.links[0]);
            event.card=result.links[0];
        }
        else{
            event.finish();
        }
        "step 2"
        if(get.position(card)=='d'){
            if(get.subtype(card)=='equip3'||get.subtype(card)=='equip4'){
                player.gain(card,trigger.player);
                player.$gain2(card);
            }
        }
    },
            },
            qqwz_进击2:{
                audio:["qqwz进击",2],
                trigger:{
                    player:"phaseBefore",
                },
                forced:true,
                content:function (){
player.addTempSkill('qqwz_进击3','phaseAfter');
},
            },
            qqwz_进击3:{
                mod:{
                    globalFrom:function (from,to,distance){
            return distance-99999;
        },
                    selectTarget:function (card,player,range){
           if(card.name=='sha') range[1]+=6;
    },
                },
            },
            qqwz_白马:{
                audio:["qqwz白马",2],
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                content:function (){
       player.addTempSkill('qqwz_白马2',{player:'phaseBegin'});
       player.addTempSkill('qianxing',{player:'phaseBegin'});
    },
                mod:{
                    globalFrom:function (from,to,current){
            if(from.hp>6) return current-2;
        },
                    globalTo:function (from,to,current){
            if(to.hp<=4) return current+3;
        },
                },
                ai:{
                    threaten:0.8,
                },
            },
            qqwz_白马2:{
                audio:["qqwz白马",2],
                trigger:{
                    global:"useCard",
                },
                frequent:true,
                filter:function (event){
        return (get.type(event.card)=='equip');
    },
                content:function (){
        player.draw(2);
    },
                ai:{
                    threaten:1.4,
                },
            },
            qqwz_英雄:{
                audio:["qqwz英雄",2],
                group:["qqwz_英雄2","qqwz_英雄3"],
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                content:function (){
for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='wu') game.players[i].draw(2);
}
},
            },
            qqwz_英雄2:{
                audio:["qqwz英雄",2],
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                content:function (){
for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='wei') game.players[i].damage(2,'fire')._triggered=null;
}
},
            },
            qqwz_英雄3:{
                audio:["qqwz英雄",2],
                trigger:{
                    player:"turnOverAfter",
                },
                forced:true,
                content:function (){
for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='qun') game.players[i].TurnOver();
}
},
            },
            qqwz_急援:{
                audio:["qqwz急援",2],
                group:"qqwz_急援2",
                unique:true,
                trigger:{
                    target:"taoBegin",
                },
                zhuSkill:true,
                forced:true,
                filter:function (event,player){
        if(event.player==player) return false;
        if(!player.hasZhuSkill('qqwz_急援')) return false;
        if(player.hp>0) return false;
        if(event.player.group!='wu') return false;
        return true;
    },
                content:function (){
        player.recover(2);
        player.draw(2);
    },
            },
            qqwz_急援2:{
                audio:["qqwz急援",2],
                unique:true,
                trigger:{
                    player:"damageBegin",
                },
                zhuSkill:true,
                forced:true,
                filter:function (event,player){
        if(event.source!='wu') return false;
        return true;
    },
                content:function (){
        player.recover(2);
        player.draw();
    },
            },
            qqwz_权衡:{
                audio:["qqwz权衡",2],
                group:"qqwz_权衡2",
                enable:"phaseUse",
                position:"he",
                usable:3,
                filterCard:true,
                selectCard:[1,Infinity],
                prompt:"弃置任意张牌并摸等量X2的牌",
                check:function (card){
        return 6-ai.get.value(card)
    },
                content:function (){
        var abc=player.hp;
        player.draw(cards.length*2);
    },
                ai:{
                    order:1,
                    result:{
                        player:1,
                    },
                    threaten:1.5,
                },
            },
            qqwz_权衡2:{
                mod:{
                    maxHandcard:function (player,num){
            if(player.hp<player.maxHp) return num+player.maxHp-player.hp;
        },
                },
            },
            qqwz_踏浪:{
                audio:["qqwz踏浪",2],
                group:["qqwz_踏浪2","qqwz_踏浪3","qqwz_踏浪4"],
                enable:"chooseToUse",
                position:"he",
                viewAs:{
                    name:"guohe",
                },
                viewAsFilter:function (player){
        if(!player.num('he')) return false;
    },
                prompt:"将一张牌当过河拆桥使用",
                check:function (card){return 4-ai.get.value(card)},
                ai:{
                    basic:{
                        order:9,
                        useful:1,
                        value:5,
                    },
                    result:{
                        target:function (player,target){
                var es=target.get('e');
                var nh=target.num('h');
                var noe=(es.length==0||target.hasSkillTag('noe'));
                var noe2=(es.length==1&&es[0].name=='baiyin'&&target.hp<target.maxHp);
                var noh=(nh==0||target.hasSkillTag('noh'));
                if(noh&&noe) return 0;
                if(noh&&noe2) return 0.01;
                if(ai.get.attitude(player,target)<=0) return (target.num('he'))?-1.5:1.5;
                var js=target.get('j');
                if(js.length){
                    var jj=js[0].viewAs?{name:js[0].viewAs}:js[0];
                    if(jj.name=='guohe') return 3;
                    if(js.length==1&&ai.get.effect(target,jj,target,player)>=0){
                        return -1.5;
                    }
                    return 2;
                }
                return -1.5;
            },
                    },
                    tag:{
                        loseCard:1,
                        discard:1,
                    },
                },
            },
            qqwz_踏浪2:{
                mod:{
                    targetEnabled:function (card,player,target,now){
            if(card.name=='guohe'||card.name=='lebu') return false;
        },
                },
            },
            qqwz_踏浪3:{
                audio:["qqwz踏浪",2],
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
return event.player.get('h').length!=0;
},
                content:function (){
trigger.untrigger();
trigger.finish();    
},
            },
            qqwz_踏浪4:{
                audio:["qqwz踏浪",2],
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
                    if(event.player.get('h').length==0) return true;
            },
                forced:true,
                content:function (){
                trigger.player.loseHp(3)._triggered=null;
            },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                        if(card.name=='sha'&&target.get('h').length==0) return [1,-2];
                    },
                    },
                },
            },
            qqwz_雄发:{
                audio:["qqwz雄发",2],
                trigger:{
                    player:"phaseDrawBegin",
                },
                frequent:true,
                content:function (){
        var num=player.maxHp;
        trigger.num+=(num);
    },
                mod:{
                    globalFrom:function (from,to,distance){
            return distance-3;
        },
                },
                ai:{
                    threaten:1.3,
                },
            },
            qqwz_揣测:{
                audio:["qqwz揣测",2],
                enable:"phaseUse",
                usable:3,
                filter:function (event,player){
        return player.num('h')>0;
    },
                filterTarget:function (card,player,target){
        return player!=target;
    },
                content:function (){
        "step 0"
        target.chooseControl('heart2','diamond2','club2','spade2').set('ai',function(event){
            switch(Math.floor(Math.random()*6)){
                case 0:return 'heart2';
                case 1:case 4:case 5:return 'diamond2';
                case 2:return 'club2';
                case 3:return 'spade2';
            }
        });
        "step 1"
        game.log(target,'选择了'+get.translation(result.control));
        event.choice=result.control;
        target.popup(event.choice);
        event.card=player.get('h').randomGet();
        target.gain(event.card,player);
        player.$give(event.card,target);
        game.delay();
        "step 2"
        if(get.suit(event.card)+'2'!=event.choice) target.damage(2,'nocard')._triggered=null;
    },
                ai:{
                    order:1,
                    result:{
                        target:function (player,target){
                var eff=ai.get.damageEffect(target,player);
                if(eff>=0) return 1+eff;
                var value=0,i;
                var cards=player.get('h');
                for(i=0;i<cards.length;i++){
                    value+=ai.get.value(cards[i]);
                }
                value/=player.num('h');
                if(target.hp==1) return Math.min(0,value-7);
                return Math.min(0,value-5);
            },
                    },
                },
            },
            qqwz_焦凤:{
                audio:["qqwz焦凤",2],
                group:"qqwz_焦凤2",
                filter:function (event,player){
        return player.num('he',{color:'red'})>0;
    },
                enable:"chooseToUse",
                filterCard:function (card){
        return get.color(card)=='red';
    },
                position:"he",
                viewAs:{
                    name:"lebu",
                    suit:"heart",
                    number:6,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"heart","number":6,"name":"huaji","_transform":"translateY(0px)","_mouseentercreated":false,"clone":{"name":"huaji","suit":"heart","number":6,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":943},"original":"j","viewAs":"lebu","timeout":921}],
                },
                prompt:"将一张红色牌当乐不思蜀使用",
                check:function (card){return 6-ai.get.value(card)},
                ai:{
                    threaten:1.5,
                    basic:{
                        order:1,
                        useful:1,
                        value:8,
                    },
                    result:{
                        target:function (player,target){
                var num=target.hp-target.num('h')-2;
                if(num>-1) return -0.01;
                if(target.hp<3) num--;
                if(target.isTurnedOver()) num/=2;
                var dist=get.distance(player,target,'absolute');
                if(dist<1) dist=1;
                return num/Math.sqrt(dist);
            },
                    },
                    tag:{
                        skip:"phaseUse",
                    },
                },
            },
            qqwz_焦凤2:{
                trigger:{
                    player:["useCard","respond","phaseAfter"],
                },
                audio:["qqwz焦凤",2],
                direct:true,
                unique:true,
                filter:function (event,player,name){
        if(name=='phaseAfter') return true;
        return event.card&&get.color(event.card)=='red';    
    },
                init:function (player){
        player.storage.qqwz_焦凤2=0;
    },
                content:function (){
        player.draw();
        if(event.triggername=='phaseAfter'){
            player.storage.qqwz_焦凤2=0;  
        }                            
        else{
            player.logSkill('qqwz_焦凤2');
            player.addTempSkill('qqwz_焦凤2_maxHandcard',{player:'phaseAfter'});
            player.storage.qqwz_焦凤2++;
        }
    },
                ai:{
                    threaten:0.8,
                    effect:{
                        player:function (card,player,target,effect){
                if(get.color(card)=='red') return [1,3];
            },
                    },
                },
                subSkill:{
                    maxHandcard:{
                        mod:{
                            maxHandcard:function (player,current){
                    if(player.storage.qqwz_焦凤2&&typeof player.storage.qqwz_焦凤2=='number') return current+player.storage.qqwz_焦凤2;
                },
                        },
                    },
                },
            },
            qqwz_流年:{
                trigger:{
                    player:"damageEnd",
                },
                audio:["qqwz流年",2],
                priority:5,
                content:function (){
    player.chooseToDiscard('h',true)
    player.recover()
    },
                mod:{
                    targetEnabled:function (card,player,target){
            if(card.name=='lebu'){
                return false;
            }                        
            if(card.name=='sha'){
                return false;
            }
        },
                },
            },
            qqwz_鸳鸯:{
                audio:["qqwz鸳鸯",2],
                enable:"phaseUse",
                filterCard:true,
                usable:1,
                selectCard:1,
                check:function (card){
        var player=get.owner(card);
        if(player.num('h')>player.hp)
            return 8-ai.get.value(card)
        if(player.hp<player.maxHp)
            return 6-ai.get.value(card)
        return 4-ai.get.value(card)

    },
                filterTarget:function (card,player,target){
        if(target.sex!='male') return false;
        if(target.hp>=target.maxHp) return false;
        if(target==player) return false;
        return true;
    },
                content:function (){
        player.recover();
        player.addTempSkill('qqwz_鸳鸯2','phaseAfter');
        target.recover(2);
        target.gainMaxHp();
        target.draw();
    },
                ai:{
                    order:5.5,
                    result:{
                        player:function (player){
                if(player.hp<player.maxHp) return 4;
                if(player.num('h')>player.hp) return 0
                return -1;
            },
                        target:4,
                    },
                    threaten:2,
                },
            },
            qqwz_影剑2:{
                audio:["qqwz影剑",2],
                trigger:{
                    global:"useCardAfter",
                },
                forced:true,
                unique:true,
                forceunique:true,
                filter:function (event,player){
        var type=get.type(event.card,'equip');
        return event.player!=player&&(type=='equip');
    },
                content:function (){
        'step 0'
        var card=get.cardPile(function(card){
            return get.type(card)=='equip';
        });
        event.card=card;
        'step 1'
        if(event.card){
            player.equip(event.card);
        }
    },
            },
            qqwz_影剑:{
                audio:["qqwz影剑",2],
                group:["qqwz_影剑2","qqwz_影剑3"],
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='e') return true;
        }
        return false;
    },
                content:function (){
        var num=0;
        for(var i=0;i<trigger.cards.length;i++){
            if(trigger.cards[i].original=='e') num+=2;
        }
        player.draw(num);
    },
                ai:{
                    noe:true,
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='equip') return [1,3];
            },
                    },
                },
            },
            qqwz_影剑3:{
                trigger:{
                    player:"equipBegin",
                },
                audio:["qqwz影剑",2],
                frequent:true,
                filter:function (event,player){
                    return player.num('e',{subtype:'equip1'})&&get.subtype(event.card)== 'equip1';
                },
                content:function (){
                    "step 0"
                    trigger.untrigger();
                    trigger.finish();
                    player.$equip(trigger.card);
                    game.addVideo('equip',player,get.cardInfo(trigger.card));
                    game.log(player,'装备了',trigger.card);
                    "step 1"
                    var info=get.info(trigger.card);
                    if(info.onEquip&&(!info.filterEquip||info.filterEquip(trigger.card,player))){
                        var next=game.createEvent('equip_'+trigger.card.name);
                        next.setContent(info.onEquip);
                        next.player=player;
                        next.trigger.card=trigger.card;
                        game.delayx();
                    }
                    delete player.equiping;
                },
                ai:{
                    effect:{
                        player:function (card,player,target){
                            if(get.subtype(card)=='equip1') return[1,10];
                        },
                    },
                },
            },
            qqwz_鸳鸯2:{
                mod:{
                    cardUsable:function (card,player,num){
                    if(card.name=='sha') return num+2;
                },
                },
            },
            qqwz_绿荫:{
                mod:{
                    cardEnabled:function (card,player){
            if(_status.event.skill!='qqwz_绿荫'&&card.name!='wuzhong'&&get.suit(card)=='heart') return false;
        },
                    cardUsable:function (card,player){
            if(_status.event.skill!='qqwz_绿荫'&&card.name!='wuzhong'&&get.suit(card)=='heart') return false;
        },
                    cardRespondable:function (card,player){
            if(_status.event.skill!='qqwz_绿荫'&&card.name!='wuzhong'&&get.suit(card)=='heart') return false;
        },
                    cardSavable:function (card,player){
            if(_status.event.skill!='qqwz_绿荫'&&card.name!='wuzhong'&&get.suit(card)=='heart') return false;
        },
                },
                audio:["qqwz绿荫",2],
                enable:["chooseToUse","chooseToRespond"],
                usable:5,
                filterCard:{
                    suit:"heart",
                },
                viewAs:{
                    name:"wuzhong",
                    suit:"spade",
                    number:2,
                    cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"spade","number":2,"name":"bagua","_transform":"translateX(112px)","_mouseentercreated":false,"clone":{"name":"bagua","suit":"spade","number":2,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":332},"original":"h","timeout":317}],
                },
                check:function (){return 1},
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'respondSha')&&current<0) return 0.6
            },
                    },
                    respondSha:true,
                    order:4,
                    useful:-1,
                    value:-1,
                    basic:{
                        order:7.2,
                        useful:4,
                        value:9.2,
                    },
                    result:{
                        target:2,
                    },
                    tag:{
                        draw:2,
                    },
                },
            },
            qqwz_花落:{
                audio:["qqwz花落",2],
                group:"qqwz_花落2",
                trigger:{
                    player:"damageBegin",
                },
                content:function (){
  var rg=player.num;
trigger.source.damage(rg)._triggered=null;
trigger.untrigger();
trigger.finish();
},
            },
            qqwz_花落2:{
                mod:{
                    suit:function (card,suit){
            if(suit=='spade') return 'heart';
        },
                },
            },
            qqwz_铁壁:{
                audio:["qqwz铁壁",2],
                trigger:{
                    global:"discardAfter",
                },
                filter:function (event){
        if(_status.currentPhase!=event.player){
            for(var i=0;i<event.cards.length;i++){
                if(event.cards[i].original=='h') return true;
            }
        }
        return false;
    },
                check:function (event,player){
        return ai.get.attitude(player,event.player)>2;
    },
                content:function (){
        "step 0"
        player.line(trigger.player,'green');
        player.damage();
        "step 1"
        trigger.player.draw(3);
        player.draw(1);
    },
            },
            qqwz_冷血:{
                audio:["qqwz冷血",2],
                trigger:{
                    player:"dieBefore",
                },
                forced:true,
                filter:function (event,player){return player.maxHp>0&&player.hp<=0},
                content:function (){
        "step 0";
        if(player.storage.qqwz_冷血==undefined) player.storage.qqwz_冷血=[];
        player.storage.qqwz_冷血.push(event.card);
        player.syncStorage('qqwz_冷血');
        player.showCards(player.storage.qqwz_冷血,'冷血')
        player.markSkill('qqwz_冷血');
        "step 1"
        for(var i=0;i<player.storage.qqwz_冷血.length-1;i++){
            if(get.number(event.card)&&get.number(event.card)==get.number(player.storage.qqwz_冷血[i])) return;
        }
        trigger.untrigger();
        trigger.finish();
        if(player.hp<=0){
            player.hp=8;
            player.update();
        }
    },
                mod:{
                    maxHandcard:function (player,num){
            if(player.storage.qqwz_冷血&&player.storage.qqwz_冷血.length) return num-player.hp+player.storage.qqwz_冷血.length;
        },
                },
                intro:{
                    content:"cards",
                    onunmark:function (storage,player){
            if(storage&&storage.length){
                player.$throw(storage);
                for(var i=0;i<storage.length;i++){
                    ui.discardPile.appendChild(storage[i]);
                }
                delete player.storage.qqwz_冷血;
            }
        },
                },
            },
            qqwz_奋命:{
                audio:["qqwz奋命",2],
                trigger:{
                    global:"damageBegin",
                },
                forced:true,
                popup:false,
                filter:function (event,player){
return player!=event.player&&(get.translation(event.player.name)=='qqwz吴王光耀'||get.translation(event.player.name2)=='qqwz吴王光耀');
},
                content:function (){
trigger.untrigger();
trigger.finish();
    player.damage(2);
},
            },
            qqwz_烈士:{
                audio:["qqwz烈士",2],
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.num('h')>0;
    },
                filter:function (event,player){
        return player.num('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(target);
        "step 1"
        if(result.bool){
            player.addTempSkill('qqwz_烈士2','phaseAfter');
        }
        else{
            player.draw(2);
        }
    },
                ai:{
                    order:function (name,player){
            var cards=player.get('h');
            if(player.num('h','sha')==0){
                return 1;
            }
            for(var i=0;i<cards.length;i++){
                if(cards[i].name!='sha'&&cards[i].number>11&&ai.get.value(cards[i])<7){
                    return 9;
                }
            }
            return ai.get.order({name:'sha'})-1;
        },
                    result:{
                        player:function (player){
                if(player.num('h','sha')>0) return 0.6;
                var num=player.num('h');
                if(num>player.hp) return 0;
                if(num==1) return -2;
                if(num==2) return -1;
                return -0.7;
            },
                        target:function (player,target){
                var num=target.num('h');
                if(num==1) return -1;
                if(num==2) return -0.7;
                return -0.5
            },
                    },
                    threaten:1.3,
                },
            },
            qqwz_烈士2:{
                mod:{
                    targetInRange:function (card,player,target,now){
                    if(card.name=='sha') return true;
                },
                    selectTarget:function (card,player,range){
                    if(card.name=='sha'&&range[1]!=-1) range[1]+=7;
                },
                    cardUsable:function (card,player,num){
                    if(card.name=='sha') return num+1;
                },
                },
            },
            qqwz_酣战:{
                audio:["qqwz酣战",2],
                trigger:{
                    source:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player;
},
                content:function (){
        trigger.player.loseMaxHp();
trigger.player.loseHp();
trigger.untrigger();
trigger.finish();
},
            },
            qqwz_睥睨:{
                audio:["qqwz睥睨",2],
                trigger:{
                    player:"phaseBegin",
                },
                content:function (){
   "step 0"
 var pos=4;
 var fellow=game.addFellow(pos,'qqwz策马扬鞭');        
 fellow.style.left='calc(50% - 500px)';
 fellow.style.top='calc(50% - 19px)';
 fellow.classList.add('minskin');
         fellow.side=player.side;
 fellow.identity=player.identity;
if(fellow.identity=='zhu') fellow.identity='zhong';
         fellow.setIdentity('忠臣');
         fellow.draw(fellow.maxHp)
         fellow.node.identity.dataset.color=fellow.identity;
//------------------------------------------------------------------
 var fellow1=game.addFellow(pos,'qqwz吴王光耀');        
 fellow1.style.left='calc(50% + 400px)';
 fellow1.style.top='calc(50% - 19px)';
 fellow1.classList.add('minskin');
 fellow1.side=player.side;
 fellow1.identity=player.identity;
if(fellow1.identity=='zhu') fellow1.identity='zhong';
         fellow1.setIdentity('忠臣');
         fellow1.draw(fellow1.maxHp)
         fellow1.node.identity.dataset.color=fellow1.identity;
        //------------------------------------------------------------------
 var fellow2=game.addFellow(pos,'qqwz豪饮鲸吞');        
 fellow2.style.left='calc(50% + 200px)';
 fellow2.style.top='calc(50% - 19px)';
 fellow2.classList.add('minskin');
 fellow2.side=player.side;
 fellow2.identity=player.identity;
if(fellow2.identity=='zhu') fellow2.identity='zhong';
         fellow2.setIdentity('忠臣');
         fellow2.draw(fellow2.maxHp)
         fellow2.node.identity.dataset.color=fellow2.identity;
        //------------------------------------------------------------------
 var fellow3=game.addFellow(pos,'qqwz笃烈之士');        
 fellow3.style.left='calc(50% - 300px)';
 fellow3.style.top='calc(50% - 19px)';
 fellow3.classList.add('minskin');
 fellow3.side=player.side;
 fellow3.identity=player.identity;
if(fellow3.identity=='zhu') fellow3.identity='zhong';
         fellow3.setIdentity('忠臣');
         fellow3.draw(fellow3.maxHp)
         fellow3.node.identity.dataset.color=fellow3.identity;
       "step 1"
       player.removeSkill('qqwz_睥睨');
      },
            },
            qqwz_魂佑:{
                audio:["qqwz魂佑",2],
                group:"qqwz_魂佑2",
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                content:function (){
for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='wu') game.players[i].draw(2);
}
    },
            },
            qqwz_虎踞:{
                audio:["qqwz虎踞",2],
                trigger:{
                    player:"phaseDrawBegin",
                },
                frequent:true,
                content:function (){
        trigger.num+=2;
    },
                mod:{
                    globalFrom:function (from,to,distance){
            return distance-2;
        },
                },
                ai:{
                    threaten:1.3,
                },
            },
            qqwz_军霸2:{
                audio:["qqwz军霸",2],
                trigger:{
                    player:"damageBegin",
                },
                frequent:true,
                priority:-500,
                content:function (){
if(trigger.num>1) trigger.num=1
},
                group:["qqwz_军霸3"],
            },
            qqwz_军霸3:{
                audio:["qqwz军霸",2],
                trigger:{
                    player:"phaseDiscardBefore",
                },
                frequent:true,
                content:function (){
trigger.untrigger();
trigger.finish();
},
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'){
                return false;
            }
        },
                },
            },
            qqwz_转日:{
                audio:["qqwz转日",2],
                group:"qqwz_转日2",
                trigger:{
                    player:"shaBefore",
                    target:"shaBefore",
                },
                frequent:true,
                filter:function (event,player){
        if(event.card.name=='sha') return true;
    },
                content:function (){
       player.recover();
        player.draw();
    },
                ai:{
                    effect:{
                        target:function (card,player,target){
                if(card.name=='sha') return [1,0.6];
            },
                        player:function (card,player,target){
                if(card.name=='sha') return [1,1];
            },
                    },
                },
            },
            qqwz_转日2:{
                audio:["qqwz转日",2],
                trigger:{
                    player:"damageBegin",
                },
                filter:function (event,player){
        return event.card&&event.card.name=='juedou';
    },
                content:function (){
     player.draw();
     trigger.untrigger();
     trigger.finish();           
    },
            },
            qqwz_卧虎:{
                skillAnimation:true,
                audio:["qqwz卧虎",2],
                derivation:["qqwz_虎踞","qqwz_庇佑"],
                unique:true,
                trigger:{
                    player:"phaseBegin",
                },
                filter:function (event,player){
        return player.hp!=player.num('he')&&!player.storage.qqwz_卧虎;
    },
                forced:true,
                priority:3,
                content:function (){
        player.loseHp(3);
        player.addSkill('qqwz_虎踞');
        player.addSkill('qqwz_庇佑');
        player.awakenSkill('qqwz_卧虎');
        player.storage.qqwz_卧虎=true;
        game.createTrigger('phaseBegin','qqwz_庇佑',player,trigger);
    },
                ai:{
                    threaten:function (player,target){
            if(target.hp!=target.num('he')) return 2;
            return 0.5;
        },
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                if(!target.hasFriend()) return;
                if(get.tag(card,'damage')==1&&target.hp==2&&!target.isTurnedOver()&&
                _status.currentPhase!=target&&get.distance(_status.currentPhase,target,'absolute')<=3) return [0.5,1];
            },
                    },
                },
            },
            qqwz_庇佑:{
                audio:["qqwz庇佑",2],
                trigger:{
                    player:"phaseBegin",
                },
                filter:function (event,player){
        return player.hp<player.maxHp;
    },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget([1,2],get.prompt('qqwz_庇佑'),function(card,player,target){
            return player!=target;
        }).set('ai',function(target){
            var player=_status.event.player;
            if(player.maxHp-player.hp==1&&target.num('he')==0){
                return 0;
            }
            if(ai.get.attitude(_status.event.player,target)>0){
                return 10+ai.get.attitude(_status.event.player,target);
            }
            if(player.maxHp-player.hp==1){
                return -1;
            }
            return 1;
        });
        "step 1"
        if(result.bool){
            event.num=player.maxHp-player.hp;
            if(player.num('e')>=player.hp){
                event.num=player.maxHp;
            }
            player.logSkill('qqwz_庇佑',result.targets);
            event.target=result.targets[0];
            if(event.num==1){
                event.directcontrol=true;
            }
            else{
                var str1='摸'+get.cnNumber(event.num,true)+'弃一';
                var str2='受到'+get.cnNumber(event.num,true)+'点伤害弃'+get.cnNumber(event.num,true);
                player.chooseControl(str1,str2,function(event,player){
                    return _status.event.choice;
                }).set('choice',ai.get.attitude(player,event.target)>0?str1:str2);
                event.str=str1;
            }
        }
        else{
            event.finish();
        }
        "step 2"
        if(event.directcontrol||result.control==event.str){
            event.target.draw(event.num);
            event.target.changeHujia(event.num),
            event.target.chooseToDiscard(true,'he');
        }
        else{
            event.target.damage(event.num);
            event.target.chooseToDiscard(event.num,true,'he');
        }
    },
                ai:{
                    threaten:function (player,target){
            if(target.hp==1||target.num('e')>=target.hp) return 2;
            if(target.hp==target.maxHp) return 0.5;
            if(target.hp==2) return 1.5;
            return 0.5;
        },
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                if(target.maxHp<=3) return;
                if(get.tag(card,'damage')){
                    if(target.hp==target.maxHp) return [0,1];
                }
                if(get.tag(card,'recover')&&player.hp>=player.maxHp-1) return [0,0];
            },
                    },
                },
            },
            qqwz_联盟:{
                audio:["qqwz联盟",2],
                group:"qqwz_联盟2",
                enable:"phaseUse",
                usable:1,
                changeSeat:true,
                filterTarget:function (card,player,target){
        return player!=target;
    },
                content:function (){
        target.gain(player.get('h'));
        target.$give(player.num('h'),target);
        player.draw(2);
    },
            },
            qqwz_联盟2:{
                audio:["qqwz联盟",2],
                trigger:{
                    player:"phaseEnd",
                },
                frequent:true,
                content:function (){
        player.draw(3);
    },
            },
            qqwz_人杰:{
                audio:["qqwz人杰",2],
                enable:"phaseUse",
                unique:true,
                delay:0,
                direct:true,
                content:function (){
        "step 0"
        var dialog=ui.create.dialog('qqwz_人杰');
        for(var i=0;i<game.players.length;i++){
             if(game.players[i]==player) continue;
             if(game.players[i].num('h')){
                dialog.add(get.translation(game.players[i])+'的'+'手牌');
                var hs=game.players[i].get('h');
                dialog.add(hs);                                     
             }
        }
        event.dialog=dialog;
        if(player==game.me){
            if(event.isMine()){
                game.pause();
                ui.create.confirm('o');
                    game.countChoose();
                    event.choosing=true;
            }
            else{
                event.finish();
                    event.result='viewed';
                setTimeout(function(){
                    event.dialog.close();
                },2*lib.config.duration);
                game.delayx(2);
            }
        }
        else{
            event.finish();
        }        
        "step 1"
            event.result='viewed';
        _status.imchoosing=false;
            event.choosing=false;
        if(event.dialog) event.dialog.close();                        
    },
                group:"qqwz_人杰2",
            },
            qqwz_人杰2:{
                audio:["qqwz人杰",2],
                trigger:{
                    source:"damageEnd",
                    player:"damageEnd",
                },
                direct:true,
                content:function (){
                    'step 0'
                    player.chooseTarget('人杰:选择两名角色置换他们的手牌',function(card,player,target){
                        return target.num('h');
                    },2).set('ai',function(target){
                        if(!ui.selected.targets.length) return -ai.get.attitude(player,target)+target.num('h');
                        if(ui.selected.targets.length){
                            var num=ui.selected.targets[0].num('h')-target.num('h');
                            if(num>0) return ai.get.attitude(player,target);
                            return 0;
                        }
                    });    
                    'step 1'
                    if(result.bool){
                        player.logSkill('qqwz_人杰2',result.targets);
                        event.cards0=result.targets[0].get('h');
                        event.cards1=result.targets[1].get('h');
                        result.targets[0].lose(event.cards0,ui.special);
                        result.targets[1].lose(event.cards1,ui.special);
                        result.targets[0].gain(event.cards1,result.targets[1]);
                        result.targets[1].gain(event.cards0,result.targets[0]);
                        result.targets[0].$give(event.cards0.length,result.targets[1]);
                        result.targets[1].$give(event.cards1.length,result.targets[0]);                
                    }
                    else{
                        event.finish();
                    }
                },
                ai:{
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                            if(get.tag(card,'damage')){
                                if(player.hasSkill('jueqing')) return [1,-2];
                                if(!target.hasFriend()) return;
                                if(target.hp>=4&&player.num('h')>target.num('h')) return [1,get.tag(card,'damage')*2];
                                if(target.hp==3&&player.num('h')>target.num('h')) return [1,get.tag(card,'damage')*1.5];
                                if(target.hp==2&&player.num('h')>target.num('h')) return [1,get.tag(card,'damage')*0.5];
                            }
                        },
                    },
                },
            },
            qqwz_施财:{
                audio:["qqwz施财",2],
                trigger:{
                    player:"phaseDrawBegin",
                },
                threaten:1.4,
                check:function (event,player){
        if(player.num('h')<=1) return true;
        var min=[];
        var temp=player.next.num('h');
        var players=game.filterPlayer();
        for(var i=0;i<players.length;i++){
            if(players[i]!=player&&players[i].num('h')<temp){
                temp=players[i].num('h');
            }
        }
        for(var i=0;i<players.length;i++){
            if(players[i]!=player&&players[i].num('h')==temp){
                min.push(players[i]);
            }
        }
        for(var i=0;i<min.length;i++){
            if(ai.get.attitude(player,min[i])>0) return true;
        }
        return false;
    },
                content:function (){
        trigger.num+=4;
        player.addSkill('qqwz_施财2');
    },
                ai:{
                    threaten:2,
                    ai:{
                        noh:true,
                        skillTagFilter:function (player,tag){
                if(tag=='noh'){
                    if(player.num('h')!=2) return false;
                }
            },
                    },
                },
            },
            qqwz_施财2:{
                trigger:{
                    player:"phaseDrawEnd",
                },
                forced:true,
                popup:false,
                audio:["qqwz施财",2],
                content:function (){
                "step 0"
                player.removeSkill('qqwz_施财2');
                if(player.num('h')<=8){
                    event.finish();
                    return;
                }
                player.chooseCardTarget({
                    selectCard:Math.floor(player.num('h')/2),
                    filterTarget:function(card,player,target){
                        return target.isFewestHandcard();
                    },
                    forced:true,
                    ai2:function(target){
                        return ai.get.attitude(_status.event.player,target);
                    }
                });
                "step 1"
                if(result.targets&&result.targets[0]){
                    result.targets[0].gain(result.cards,player);
                    player.$give(result.cards.length,result.targets[0]);
                }
            },
            },
            qqwz_明谏:{
                audio:["qqwz明谏",2],
                enable:"phaseUse",
                filter:function (event,player){
        return player.num('h',{type:'equip'})>0;
    },
                filterCard:function (card){
        return get.type(card)=='equip';
    },
                filterTarget:function (card,player,target){
        if(target.isMin()) return false;
        return player!=target;
    },
                content:function (){
        target.addTempSkill('qqwz_暗谏');
        target.equip(cards[0]);
        player.draw();
    },
                ai:{
                    basic:{
                        order:10,
                    },
                    result:{
                        target:3,
                    },
                    threaten:1.3,
                },
            },
            qqwz_暗谏:{
                trigger:{
                    player:"equipBegin",
                },
                frequent:true,
                filter:function (event,player){
        return player.num('e',{type:'equip'})&&get.type(event.card)== 'equip';
    },
                content:function (){
        "step 0"
        trigger.untrigger();
        trigger.finish();
        player.$equip(trigger.card);
        game.addVideo('equip',player,get.cardInfo(trigger.card));
        game.log(player,'装备了',trigger.card);
        "step 1"
        var info=get.info(trigger.card);
        if(info.onEquip&&(!info.filterEquip||info.filterEquip(trigger.card,player))){
            var next=game.createEvent('equip_'+trigger.card.name);
            next.setContent(info.onEquip);
            next.player=player;
            next.trigger.card=trigger.card;
            game.delayx();
        }
        delete player.equiping;
    },
                ai:{
                    effect:{
                        player:function (card,player,target){
                if(get.type(card)=='equip') return[1,10];
            },
                    },
                },
            },
            qqwz_修政:{
                audio:["qqwz修政",2],
                unique:true,
                gainable:true,
                trigger:{
                    global:"discardAfter",
                },
                filter:function (event,player){
        if(event.player!=player&&event.player.classList.contains('dead')==false&&
        event.cards&&event.cards.length&&event.getParent(2).name=='phaseDiscard'){
            for(var i=0;i<event.cards.length;i++){
                if(get.position(event.cards[i])=='d'){
                    return true;
                }
            }
            return false;
        }
    },
                check:function (event,player){
        var du=false;
        var num=0;
        for(var i=0;i<event.cards.length;i++){
            if(get.position(event.cards[i])=='d'){
                num++;
                if(event.cards[i].name=='du'){
                    du=true;
                }
            }
        }
        if(ai.get.attitude(player,event.player)>0){
            if(du&&num<=3){
                return false;
            }
            return true;
        }
        if(du) return true;
        return num>2;
    },
                direct:true,
                content:function (){
        "step 0"
        event.cards=trigger.cards.slice(0);
        for(var i=0;i<event.cards.length;i++){
            if(get.position(event.cards[i])!='d'){
                event.cards.splice(i,1);i--;
            }
        }
        if(event.cards.length==0){
            event.finish();
            return;
        }
        var check=lib.skill.guzheng.check(trigger,player);
        player.chooseCardButton(event.cards,'修政：选择令'+get.translation(trigger.player)+'收回的牌').set('ai',function(button){
            if(_status.event.check){
                return 20-ai.get.value(button.link);
            }
            return 0;
        }).set('check',check);
        "step 1"
        if(result.bool){
            game.delay(0.5);
            player.logSkill('qqwz_修政',trigger.player);
            trigger.player.gain(result.links[0]);
            trigger.player.$gain2(result.links[0]);
            game.log(trigger.player,'收回了',result.links[0]);
            event.cards.remove(result.links[0]);
            if(event.cards.length){
                player.gain(event.cards);
                player.$gain2(event.cards);
                game.log(player,'收回了',event.cards);
            }
            game.delay();
        }
    },
                ai:{
                    threaten:1.3,
                    expose:0.2,
                },
            },
            qqwz_魂佑2:{
                audio:["qqwz魂佑",2],
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                content:function (){
for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='wei')game.players[i].loseHp(2);
}
},
            },
            qqwz_芙蓉:{
                audio:["qqwz芙蓉",2],
                group:["qqwz_芙蓉_color","qqwz_芙蓉_color2"],
                subSkill:{
                    color:{
                        trigger:{
                            player:"phaseBegin",
                        },
                        forced:true,
                        popup:false,
                        silent:true,
                        content:function (){
                player.storage.qqwz_芙蓉_color=['black','red'];
            },
                    },
                    color2:{
                        trigger:{
                            player:"useCard",
                        },
                        forced:true,
                        popup:false,
                        silent:true,
                        filter:function (event,player){
                return Array.isArray(player.storage.qqwz_芙蓉_color)&&_status.currentPhase==player;
            },
                        content:function (){
                player.storage.qqwz_芙蓉_color.remove(get.color(trigger.card));
            },
                    },
                },
                trigger:{
                    player:"phaseDiscardBegin",
                },
                direct:true,
                filter:function (event,player){
        if(!player.storage.qqwz_芙蓉_color) return false;
        var length=player.storage.qqwz_芙蓉_color.length;
        if(length==0) return false;
        var hs=player.get('h');
        if(hs.length==0) return false;
        if(length==2) return true;
        var color=player.storage.qqwz_芙蓉_color[0];
        for(var i=0;i<hs.length;i++){
            if(get.color(hs[i])==color) return true;
        }
        return false;
    },
                intro:{
                    content:"cards",
                },
                init:function (player){
        player.storage.qqwz_芙蓉=[];
    },
                content:function (){
        'step 0'
        player.chooseCard(get.prompt('qqwz_芙蓉'),function(card){
            return _status.event.player.storage.qqwz_芙蓉_color.contains(get.color(card));
        }).set('ai',function(card){
            var player=_status.event.player;
            if(player.storage.qqwz_芙蓉.length==2){
                if(!game.hasPlayer(function(current){
                    return (current!=player&&
                        ai.get.damageEffect(current,player,player)>0&&
                        ai.get.attitude(player,current)<0)
                })) return 0;
            }
            return 7-ai.get.value(card);
        });
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_芙蓉');
            if(player.storage.qqwz_芙蓉.length<2){
                player.$give(result.cards,player);
            }
            player.lose(result.cards,ui.special);
            player.storage.qqwz_芙蓉=player.storage.qqwz_芙蓉.concat(result.cards);
            player.markSkill('qqwz_芙蓉');
            player.syncStorage('qqwz_芙蓉');
        }
        else{
            event.finish();
        }
        'step 2'
        if(player.storage.qqwz_芙蓉.length==2){
            player.$throw(player.storage.qqwz_芙蓉);
            while(player.storage.qqwz_芙蓉.length){
                ui.discardPile.appendChild(player.storage.qqwz_芙蓉.shift());
            }
            player.unmarkSkill('qqwz_芙蓉');
            player.chooseTarget(function(card,player,target){
                return target!=player;
            },'对一名角色造成4点神圣伤害并弃置其装备区内的牌').set('ai',function(target){
                var player=_status.event.player;
                if(ai.get.attitude(player,target)>0) return -1;
                return ai.get.damageEffect(target,player,player)+target.num('e')/2;
            });
        }
        else{
            event.finish();
        }
        'step 3'
        if(result.bool){
            var target=result.targets[0];
            target.damage(4)._triggered=null;
            event.target=target;
            player.line(target,'green');
        }
        else{
            event.finish();
        }
        'step 4'
        if(event.target&&event.target.isAlive()){
            var es=event.target.get('e');
            if(es.length){
                event.target.discard(es);
            }
        }
    },
                ai:{
                    threaten:1.5,
                },
            },
            qqwz_沉鱼:{
                audio:["qqwz沉鱼",2],
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                content:function (){
        player.addTempSkill('qqwz_花落',{player:'phaseBegin'});
        player.addTempSkill('qqwz_流年',{player:'phaseBegin'});
    },
            },
            qqwz_狂傲:{
                audio:["qqwz狂傲",2],
                trigger:{
                    player:"chooseToRespondBegin",
                },
                frequent:true,
                filter:function (event,player){
        if(event.responded) return false;
        return _status.currentPhase!==player;
    },
                content:function (){
        "step 0"
        var cards=[];
        if(ui.cardPile.childNodes.length<10){
            var discardcards=get.cards(10);
            for(var i=0;i<discardcards.length;i++){
                ui.discardPile.appendChild(discardcards[i]);
            }
        }
        for(var i=0;i<10;i++){
            cards.push(ui.cardPile.childNodes[i]);
        }
        player.chooseCardButton('狂傲：选择一张卡牌打出',cards).set('filterButton',function(button){
            return get.type(button.link)=='basic'&&_status.event.getTrigger().filterCard(button.link);
        });
        "step 1"
        if(result.bool){
            game.log(player,'狂傲发动成功');
            trigger.untrigger();
            trigger.responded=true;
            result.links[0].remove();
            trigger.result={bool:true,card:result.links[0]}
        }
    },
                ai:{
                    effect:{
                        target:function (card,player,target,effect){
                if(get.tag(card,'respondShan')) return 0.7;
                if(get.tag(card,'respondSha')) return 0.7;
            },
                    },
                },
                group:"aocai2",
            },
            qqwz_杀令:{
                audio:["qqwz杀令",2],
                group:["qqwz_杀令2"],
                enable:"chooseToUse",
                filter:function (event,player){
        return player.num('h',{type:'basic'});
    },
                chooseButton:{
                    dialog:function (){
            var list=[];
                for(var i in lib.card){
                    if(!lib.translate[i+'_info']) continue;
                    if(lib.card[i].mode&&lib.card[i].mode.contains(lib.config.mode)==false) continue;
                    if(lib.card[i].type=='basic') list.push(['basic','',i]);
                }
            list.push(['基本','','sha','fire']);
            list.push(['基本','','sha','thunder']);    
            list.push(['基本','','sha','poison']);    

            return ui.create.dialog('杀令:请选择想要使用的基本牌',[list,'vcard']);
        },
                    filter:function (button,player){
            return lib.filter.filterCard({name:button.link[2]},player,_status.event.getParent());
        },
                    check:function (button){
            var player=_status.event.player;
            var shaTarget=false;
            for(var i=0;i<game.players.length;i++){
                if(player.canUse('sha',game.players[i])&&ai.get.effect(game.players[i],{name:'sha'},player)>0){
                    shaTarget=true;
                }
            }
            if(player.isDamaged()) return (button.link[2]=='tao')?1:-1;
            if(shaTarget&&player.num('h','sha')&&!player.num('h','jiu')) return (button.link[2]=='jiu')?1:-1;
            if(shaTarget&&!player.num('h','sha')) return (button.link[2]=='sha')?1:-1;
            return (button.link[2]=='sha')?1:-1;
        },
                    backup:function (links,player){
            return {
                filterCard:function(card){
                    return get.type(card)=='basic';
                },
                audio:["qqwz杀令",2],
                popname:true,
                viewAs:{name:links[0][2]}
            }
        },
                    prompt:function (links,player){
            return '将一张基本牌当'+get.translation(links[0][2])+'使用';
        },
                },
                ai:{
                    save:true,
                    order:6,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_杀令2:{
                audio:["qqwz杀令",2],
                enable:["chooseToRespond"],
                filterCard:function (card){
        return get.type(card)=='basic';
    },
                viewAs:{
                    name:"shan",
                },
                viewAsFilter:function (player){
                            if(!player.num('h',{type:'basic'})) return false;
    },
                prompt:"将一张基本牌当闪打出",
                check:function (){return 1},
                ai:{
                    respondShan:true,
                    skillTagFilter:function (player){
            if(!player.num('h',{type:'basic'})) return false;
        },
                    result:{
                        target:function (card,player,target,current){
                if(get.tag(card,'respondShan')&&current<0) return 0.6
            },
                    },
                    basic:{
                        useful:[7,2],
                        value:[7,2],
                    },
                },
            },
            qqwz_举国:{
                audio:["qqwz举国",2],
                enable:"phaseUse",
                usable:5,
                filterCard:function (){
        if(ui.selected.targets.length) return false;
        return true;
    },
                position:"he",
                selectCard:1,
                filterTarget:function (card,player,target){
        return target!=player;
    },
                check:function (card){
        switch(ui.selected.cards.length){
            case 0:return 7-ai.get.value(card);
            case 1:return 6-ai.get.value(card);
            case 2:return 3-ai.get.value(card);
            default:return 0;
        }
    },
                content:function (){
        "step 0"
        target.damage()._triggered=null;
        if(target.hp>1){
            event.finish();
        }
        "step 1"
        player.loseHp();
    },
                ai:{
                    order:2,
                    result:{
                        target:function (player,target){
                return ai.get.damageEffect(target,player);
            },
                    },
                    threaten:1.5,
                    expose:0.3,
                },
            },
            qqwz_合纵:{
                trigger:{
                    player:"phaseDrawBegin",
                },
                direct:true,
                audio:["qqwz合纵",2],
                content:function (){
        "step 0"
        var check;
        if(player.num('h')==0){
            check=false;
        }
        else{
            check=(game.countPlayer(function(current){
                return player!=current&&ai.get.attitude(player,current)>1;
            })>=2);
        }
        if(get.is.versus()){
            event.versus=true;
            player.chooseBool(get.prompt('qqwz_合纵'));
        }
        else{
            player.chooseTarget(get.prompt('qqwz_合纵'),[1,3],function(card,player,target){
                return player!=target;
            },function(target){
                if(!_status.event.check) return 0;
                return ai.get.attitude(_status.event.player,target);
            }).set('check',check);
        }
        "step 1"
        if(result.bool){
            var targets;
            if(event.versus){
                targets=game.filterPlayer(function(current){
                    return current!=player&&current.side==player.side;
                });
            }
            else{
                targets=result.targets;
            }
            player.logSkill('qqwz_合纵',targets);
            game.asyncDraw(targets);
            trigger.num--;
        }
    },
            },
            qqwz_连横:{
                audio:["qqwz连横",2],
                trigger:{
                    global:"judge",
                },
                filter:function (event,player){
        return player.num('he')>0;
    },
                logTarget:"player",
                check:function (event,player){
        if(ai.get.attitude(player,event.player)<=0) return false;
        var cards=player.get('he');
        var judge=event.judge(event.player.judging[0]);
        for(var i=0;i<cards.length;i++){
            var judge2=event.judge(cards[i]);
            if(_status.currentPhase!=player&&judge2==judge&&get.color(cards[i])=='red'&&ai.get.useful(cards[i])<5) return true;
            if(judge2>judge) return true;
        }
        return false;
    },
                content:function (){
        "step 0"
        player.draw(2);
        var target=trigger.player;
        player.line(target,'green');
        var judge=trigger.judge(target.judging[0]);
        var attitude=ai.get.attitude(target,player);
        target.choosePlayerCard('请选择代替判定的牌','he','visible',true,player).set('ai',function(button){
            var card=button.link;
            var judge=_status.event.judge;
            var attitude=_status.event.attitude;
            var result=trigger.judge(card)-judge;
            var player=_status.event.player;
            if(result>0){
                return 20+result;
            }
            if(result==0){
                if(_status.currentPhase==player) return 0;
                if(attitude>=0){
                    return get.color(card)=='red'?7:0-ai.get.value(card);
                }
                else{
                    return get.color(card)=='black'?10:0+ai.get.value(card);
                }
            }
            if(attitude>=0){
                return get.color(card)=='red'?0:-10+result;
            }
            else{
                return get.color(card)=='black'?0:-10+result;
            }
        }).set('judge',judge).set('attitude',attitude);
        "step 1"
        if(result.bool){
            event.card=result.links[0];
            player.respond(event.card,'highlight');
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            if(trigger.player.judging[0].clone){
                trigger.player.judging[0].clone.classList.remove('thrownhighlight');
                game.broadcast(function(card){
                    if(card.clone){
                        card.clone.classList.remove('thrownhighlight');
                    }
                },trigger.player.judging[0]);
                game.addVideo('deletenode',player,get.cardsInfo([trigger.player.judging[0].clone]));
            }
            ui.discardPile.appendChild(trigger.player.judging[0]);
            trigger.player.judging[0]=event.card;
            if(!get.owner(event.card,'judge')){
                trigger.position.appendChild(event.card);
            }
            game.log(trigger.player,'的判定牌改为',event.card);
            game.delay(2);
        }
    },
                ai:{
                    tag:{
                        rejudge:1,
                    },
                },
            },
            qqwz_料敌:{
                audio:["qqwz料敌",2],
                trigger:{
                    player:["useCardAfter","respondAfter","discardAfter"],
                },
                frequent:true,
                content:function (){
        player.draw();
        player.recover(2);
    },
                ai:{
                    threaten:0.7,
                },
            },
            qqwz_致死:{
                trigger:{
                    player:"phaseBegin",
                },
                filter:function (event,player){
        return player.storage.qqwz_引敌&&player.storage.qqwz_引敌.length>0;
    },
                direct:true,
                audio:["qqwz致死",2],
                content:function (){
        'step 0'
        player.chooseTarget(get.prompt('qqwz_致死'),function(card,player,target){
            return player.hp>=target.hp;
        }).set('ai',function(target){
            var player=_status.event.player;
            if(target==player){
                if(player.num('h')>=player.maxHp) return 0;
                return 0.5;
            }
            var att=ai.get.attitude(player,target);
            if(att<2) return 0;
            if(target.hp==1&&att>2){
                att+=2;
            }
            if(player.num('j','lebu')){
                if(target.hp==target.maxHp) return att-2;
                return att-1;
            }
            if(target.hp==target.maxHp) return 0;
            if(player.num('h')<player.hp-1){
                return att-3;
            }
            return att-2;
        });
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_致死',result.targets);
            if(result.targets[0]==player){
                player.$throw(player.storage.qqwz_引敌,1000);
                var num=player.maxHp-player.num('h');
                if(num>0) player.draw(num);
                while(player.storage.qqwz_引敌.length){
                    ui.discardPile.appendChild(player.storage.qqwz_引敌.shift());
                }
                player.syncStorage('qqwz_引敌');
                player.unmarkSkill('qqwz_引敌');
            }
            else{
                var target=result.targets[0];
                target.recover(3);
                target.gain(player.storage.qqwz_引敌.slice(0),'gain2','log');
                target.draw(player.storage.qqwz_引敌.length);
                player.storage.qqwz_引敌.length=0;
            }
            player.syncStorage('qqwz_引敌');
            player.unmarkSkill('qqwz_引敌');
        }
    },
            },
            qqwz_引敌:{
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                audio:["qqwz引敌",2],
                init:function (player){
        player.storage.qqwz_引敌=[];
    },
                filter:function (event,player){
        return player.num('he')>0;
    },
                marktext:"敌",
                content:function (){
        "step 0"
        player.chooseCard([1,player.num('he')],'he',get.prompt('qqwz_引敌'),function(card){
            return player.num('he')>0;
        }).set('ai',function(card){
            return 6-ai.get.value(card);
        });
        "step 1"
        if(result.bool){
            player.$give(result.cards,player,false);
            player.logSkill('qqwz_引敌');
            game.log(player,'将',result.cards,'置于武将牌上');
            player.storage.qqwz_引敌=player.storage.qqwz_引敌.concat(result.cards);
            player.lose(result.cards,ui.special);
            player.markSkill('qqwz_引敌');
            player.syncStorage('qqwz_引敌');
        }
    },
                intro:{
                    content:"cards",
                    onunmark:function (storage,player){
            if(storage&&storage.length){
                for(var i=0;i<storage.length;i++){
                    ui.discardPile.appendChild(storage[i]);
                }
                player.$throw(storage);
                delete player.storage.qqwz_引敌;
            }
        },
                },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(card.name=='sha'||card.name=='juedou'){
                    if(current<0) return 1.2;
                }
            },
                    },
                    threaten:function (player,target){
            if(target.storage.yinbing&&target.storage.yinbing.length) return 2;
            return 1;
        },
                },
            },
            qqwz_冷兵:{
                audio:["qqwz冷兵",2],
                trigger:{
                    player:"useCard",
                },
                filter:function (event,player){
        if(event.card.name!='sha') return false;
        return game.hasPlayer(function(current){
            return !event.targets.contains(current)&&get.distance(player,current)<=1&&player.canUse('sha',current);
        });
    },
                direct:true,
                content:function (){
        'step 0'
        player.draw(2);
        player.chooseTarget(get.prompt('qqwz_冷兵'),function(card,player,target){
            return !_status.event.source.contains(target)&&get.distance(player,target)<=1&&player.canUse('sha',target);
        }).set('source',trigger.targets).set('ai',function(target){
            var player=_status.event.player;
            return ai.get.effect(target,{name:'sha'},player,player);
        });
        'step 1'
        if(result.bool){
            if(!event.isMine()&&!_status.connectMode) game.delay(0.5);
            event.target=result.targets[0];
        }
        else{
            event.finish();
        }
        'step 2'
        player.logSkill('qqwz_冷兵',event.target);
        trigger.targets.push(event.target);
    },
                ai:{
                    effect:{
                        player:function (card,player,target){
                if(card.name=='sha'){
                    if(player._duanbingtmp) return;
                    player._duanbingtmp=true;
                    if(ai.get.effect(target,{name:'sha'},player,player)<=0){
                        delete player._duanbingtmp;
                        return;
                    }
                    if(game.hasPlayer(function(current){
                        return current!=target&&get.distance(player,current)<=1&&
                        player.canUse('sha',current)&&ai.get.effect(current,{name:'sha'},player,player)>0;
                    })){
                        delete player._duanbingtmp;
                        return [1,1];
                    }
                    delete player._duanbingtmp;
                }
            },
                    },
                },
            },
            qqwz_迅疾:{
                audio:["qqwz迅疾",2],
                enable:"phaseUse",
                usable:1,
                position:"he",
                filterTarget:function (card,player,target){
        return target!=player;
    },
                content:function (){
        target.loseMaxHp();
        player.storage.qqwz_迅疾2=target;
        player.addTempSkill('qqwz_迅疾2','phaseAfter');
    },
                check:function (card){
        if(card.name=='sha'&&_status.event.player.num('h','sha')<=1) return 0;
        return 6-ai.get.value(card);
    },
                filterCard:true,
                ai:{
                    order:4,
                    result:{
                        player:function (player,target){
                if(get.distance(player,target)<=1) return 0;
                var hs=player.get('h','shunshou');
                if(hs.length&&player.canUse(hs[0],target,false)){
                    return 1;
                }
                var geteff=function(current){
                    return ai.get.effect(current,{name:'sha'},player,player)>0;
                }
                if(player.hasSha()&&geteff(target)){
                    var num=game.countPlayer(function(current){
                        return current!=player&&get.distance(player,current)<=1&&geteff(current);
                    });
                    if(num==0){
                        if(game.hasPlayer(function(current){
                            return player.canUse('sha',current)&&geteff(current)&&current!=target;
                        })){
                            return 1;
                        }
                    }
                    else if(num==1){
                        return 1;
                    }
                }
                return 0;
            },
                    },
                },
            },
            qqwz_迅疾2:{
                mark:"character",
                onremove:true,
                intro:{
                    content:"到$的距离视为1",
                },
                mod:{
                    globalFrom:function (from,to){
                    if(to==from.storage.qqwz_迅疾2){
                        return -Infinity;
                    }
                },
                },
            },
            qqwz_年华:{
                audio:["qqwz年华",2],
                trigger:{
                    global:"phaseUseBegin",
                },
                filter:function (event,player){
        return event.player!=player&&get.distance(event.player,player,'attack')>1;
    },
                logTarget:"player",
                check:function (event,player){
        if(ai.get.attitude(player,event.player)>=0) return false;
        var e2=player.get('e','2');
        if(e2){
            if(e2.name=='tengjia') return true;
            if(e2.name=='bagua') return    true;
        }
        return player.num('h','shan')>0;
    },
                content:function (){
        var target=trigger.player;
        target.addTempSkill('qqwz_年华_viewas','phaseAfter');
        target.addTempSkill('qqwz_年华_range','phaseAfter');
        target.storage.qqwz_年华=player;
        target.markSkillCharacter('qqwz_年华',player,'年华','锦囊牌均视为毒且'+get.translation(player)+'视为在攻击范围内');
    },
                ai:{
                    expose:0.2,
                },
                subSkill:{
                    range:{
                        mod:{
                            targetInRange:function (card,player,target){
                    if(card.name=='du'&&target==player.storage.qqwz_年华){
                        return true;
                    }
                },
                        },
                        onremove:function (player){
                game.broadcast(function(player){
                    if(player.marks.qqwz_年华){
                        player.marks.qqwz_年华.delete();
                        delete player.marks.qqwz_年华;
                    }
                },player);
                if(player.marks.qqwz_年华){
                    player.marks.qqwz_年华.delete();
                    delete player.marks.qqwz_年华;
                    game.addVideo('unmark',player,'qqwz_年华');
                }
            },
                        trigger:{
                            player:"useCard",
                        },
                        forced:true,
                        popup:false,
                        filter:function (event,player){
                return event.skill=='qqwz_年华_viewas'
            },
                        content:function (){
                player.removeSkill('qqwz_年华_viewas');
                game.broadcastAll(function(player){
                    if(player.marks.qqwz_年华&&player.marks.qqwz_年华.info){
                        player.marks.qqwz_年华.info.content=player.marks.qqwz_年华.info.content.slice(8);
                    }
                },player);
            },
                    },
                    viewas:{
                        mod:{
                            cardEnabled:function (card,player){
                    if(card.name!='du'&&get.type(card,'trick')=='trick') return false;
                },
                            cardUsable:function (card,player){
                    if(card.name!='du'&&get.type(card,'trick')=='trick') return false;
                },
                            cardRespondable:function (card,player){
                    if(card.name!='du'&&get.type(card,'trick')=='trick') return false;
                },
                            cardSavable:function (card,player){
                    if(card.name!='du'&&get.type(card,'trick')=='trick') return false;
                },
                        },
                        enable:["chooseToUse","chooseToRespond"],
                        filterCard:function (card){
                return get.type(card,'trick')=='trick';
            },
                        viewAs:{
                            name:"sha",
                            suit:"spade",
                            number:4,
                            cards:[{"node":{"image":{},"info":{},"name":{},"name2":{},"background":{},"intro":{},"range":{}},"storage":{"uncheck":[]},"suit":"spade","number":4,"name":"guohe","clone":{"name":"guohe","suit":"spade","number":4,"node":{"name":{},"info":{},"intro":{},"background":{},"image":{}},"_transitionEnded":true,"timeout":1737},"timeout":1714,"original":"h"}],
                        },
                        check:function (){return 1},
                        ai:{
                            effect:{
                                target:function (card,player,target,current){
                        if(get.tag(card,'respondSha')&&current<0) return 0.8
                    },
                            },
                            respondSha:true,
                            order:4,
                            useful:-1,
                            value:-1,
                            basic:{
                                useful:[5,1],
                                value:[5,1],
                            },
                            result:{
                                target:function (player,target){
                        if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                            if(ai.get.attitude(player,target)>0){
                                return -6;
                            }
                            else{
                                return -3;
                            }
                        }
                        return -1.5;
                    },
                            },
                            tag:{
                                respond:1,
                                respondShan:1,
                                damage:function (card){
                        if(card.nature=='poison') return;
                        return 1;
                    },
                                natureDamage:function (card){
                        if(card.nature) return 1;
                    },
                                fireDamage:function (card,nature){
                        if(card.nature=='fire') return 1;
                    },
                                thunderDamage:function (card,nature){
                        if(card.nature=='thunder') return 1;
                    },
                                poisonDamage:function (card,nature){
                        if(card.nature=='poison') return 1;
                    },
                            },
                        },
                    },
                },
            },
            qqwz_朝露:{
                audio:["qqwz朝露",2],
                enable:"phaseUse",
                usable:1,
                filterCard:function (card,player,target){
        return get.type(card,'basic')=='basic';
    },
                check:function (card){
        return 7-ai.get.value(card);
    },
                filterTarget:function (card,player,target){
        if(target==player) return false;
        return target.get('e','1')||target.get('e','2');
    },
                content:function (){
        'step 0'
        var e1=target.get('e','1');
        var e2=target.get('e','2');
        event.e1=e1;
        event.e2=e2;
        if(e1&&e2){
            player.chooseControl('武器牌','防具牌').set('ai',function(){
                if(_status.event.player.get('e','2')){
                    return '武器牌';
                }
                return '防具牌';
            });
        }
        else if(e1){
            event.choice='武器牌';
        }
        else{
            event.choice='防具牌';
        }
        'step 1'
        var choice=event.choice||result.control;
        if(choice=='武器牌'){
            if(event.e1){
                target.discard(event.e1);
                target.$give(event.e1,player);
            }
            player.recover(2);
        }
        else{
            if(event.e2){
                player.equip(event.e2);
                target.$give(event.e2,player);
            }
        }
    },
                ai:{
                    order:8,
                    result:{
                        target:function (player,target){
                if(target.get('e','2')&&!player.get('e','2')){
                    return -2;
                }
                return -1;
            },
                    },
                },
            },
            qqwz_残戮:{
                audio:["qqwz残戮",2],
                trigger:{
                    player:"phaseDrawBefore",
                },
                check:function (event,player){
        var num=0;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i].hp<game.players[i].maxHp){
                num++;
                if(num>3) return true;
            }
        }
        return false;
    },
                prompt:function (){
        var num=0;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i].hp<game.players[i].maxHp){
                num++;
            }
        }
        return '残戮：是否放弃摸牌，改为摸'+get.cnNumber(num)+'张牌并回复等量体力';
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        var num=0;
        for(var i=0;i<game.players.length;i++){
            if(game.players[i].hp<game.players[i].maxHp){
                num++;
            }
        }
        if(num>0){
            player.draw(num);
            player.recover(num);
        }
    },
            },
            qqwz_血仇:{
                audio:["qqwz血仇",2],
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
        return player.num('h')==0;
    },
                content:function (){
        trigger.player.logSkill('qqwz_血仇');
        trigger.num=0;
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'damage')&&target.num('h')==0) return [1,-2];
            },
                    },
                },
            },
            qqwz_丧命:{
                audio:["qqwz丧命",2],
                enable:"phaseUse",
                usable:1,
                delay:0,
                filter:function (event,player){
        return player.num('h')>0;
    },
                content:function (){
        "step 0"
        player.showHandcards();
        "step 1"
        if(player.num('h',{color:'black'})>=player.num('h',{color:'red'})) player.useCard({name:'tao'},player);
    },
                ai:{
                    order:10,
                    result:{
                        player:function (player){
                if(player.getStat().card.sha>0) return 0;
                if(player.num('h','tao')) return 0;    
                if(player.hasSkill('tao')) return 0;
                if(!player.num('h','tao')) return 0;            
                if(player.num('h',{color:'black'})>=player.num('h',{color:'red'})) return 3;
                return 0;
            },
                    },
                },
            },
            qqwz_凌风:{
                audio:["qqwz凌风",2],
                trigger:{
                    player:"loseEnd",
                },
                usable:5,
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget([1,2],get.prompt('qqwz_凌风'),function(card,player,target){
            if(player==target) return false;
            return target.num('he');
        }).set('ai',function(target){
            return -ai.get.attitude(_status.event.player,target);
        });
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_凌风',result.targets);
            event.targets=result.targets
            if(result.targets.length==1){
                player.discardPlayerCard(event.targets[0],'he',[1,2],true);
            }
            else{
                player.discardPlayerCard(event.targets[0],'he',true);
            }
        }
        else{
            event.finish();
        }
        "step 2"
        if(targets.length==2){
            player.discardPlayerCard(targets[1],'he',true);
        }
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='equip') return [1,3];
            },
                    },
                    noe:true,
                },
            },
            qqwz_御风:{
                audio:["qqwz御风",2],
                trigger:{
                    player:"loseEnd",
                },
                direct:true,
                filter:function (event,player){
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='e') return true;
        }
        return false;
    },
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_御风'),function(card,player,target){
            if(target==player) return false;
            return get.distance(player,target)<=1||player.canUse('sha',target,false);
        }).set('ai',function(target){
            if(get.distance(player,target)<=1){
                return ai.get.damageEffect(target,player,player)*2;
            }
            else{
                return ai.get.effect(target,{name:'sha'},player,player);
            }
        });
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_御风',result.targets);
            var target=result.targets[0];
            var distance=get.distance(player,target);
            if(distance<=1&&player.canUse('sha',target,false)){
                player.chooseControl('出杀','造成伤害').ai=function(){
                    return '造成伤害';
                }
                event.target=target;
            }
            else if(distance<=1){
                target.damage();
                event.finish();
            }
            else{
                player.useCard({name:'sha'},target,false).animate=false;
                game.delay();
                event.finish();
            }
        }
        else{
            event.finish();
        }
        "step 2"
        var target=event.target;
        if(result.control=='出杀'){
            player.useCard({name:'sha'},target,false).animate=false;
            game.delay();
        }
        else{
            target.damage(2);
        }
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='equip') return [1,3];
            },
                    },
                    noe:true,
                },
            },
            qqwz_携手:{
                enable:"phaseUse",
                usable:2,
                audio:["qqwz携手",2],
                selectTarget:2,
                filterTarget:function (card,player,target){
        if(target.isMin()) return false;
        if(ui.selected.targets.length==0) return true;
        if(ui.selected.targets[0].num('e')==0&&target.num('e')==0) return false;
        return Math.abs(ui.selected.targets[0].num('e')-target.num('e'))<=player.maxHp;
    },
                multitarget:true,
                content:function (){
        "step 0"
        event.cards=[targets[0].get('e'),targets[1].get('e')];
        targets[0].lose(event.cards[0],ui.special);
        targets[1].lose(event.cards[1],ui.special);
        if(event.cards[0].length) targets[0].$give(event.cards[0],targets[1]);
        if(event.cards[1].length) targets[1].$give(event.cards[1],targets[0]);
        "step 1"
        for(var i=0;i<event.cards[1].length;i++){
            targets[0].equip(event.cards[1][i]);
        }
        for(var i=0;i<event.cards[0].length;i++){
            targets[1].equip(event.cards[0][i]);
        }
    },
                ai:{
                    order:10,
                    threaten:function (player,target){
            return 0.8*Math.max(1+target.maxHp);
        },
                    result:{
                        target:function (player,target){
                var list1=[];
                var list2=[];
                var num=player.maxHp;
                var players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(ai.get.attitude(player,players[i])>0) list1.push(players[i]);
                    else if(ai.get.attitude(player,players[i])<0) list2.push(players[i]);
                }
                list1.sort(function(a,b){
                    return a.num('e')-b.num('e');
                });
                list2.sort(function(a,b){
                    return b.num('e')-a.num('e');
                });
                var delta;
                for(var i=0;i<list1.length;i++){
                    for(var j=0;j<list2.length;j++){
                        delta=list2[j].num('e')-list1[i].num('e');
                        if(delta<=0) continue;
                        if(delta<=num){
                            if(target==list1[i]||target==list2[j]){
                                return ai.get.attitude(player,target);
                            }
                            return 0;
                        }
                    }
                }
                return 0;
            },
                    },
                    effect:{
                        target:function (card,player,target){
                if(target.hp==target.maxHp&&get.tag(card,'damage')) return 0.2;
            },
                    },
                },
            },
            qqwz_招亲:{
                trigger:{
                    global:"dying",
                },
                priority:6,
                audio:["qqwz招亲",2],
                filter:function (event,player){
        return event.player.hp<=0&&event.player.num('h')>0;
    },
                check:function (event,player){
        if(event.player.isUnderControl(true,player)){
            return event.player.get('h',function(card){
                return get.type(card)!='food';
            }).length>0;
        }
        return ai.get.attitude(player,event.player)>0;
    },
                direct:true,
                content:function (){
        "step 0"
        var check=false;
        if(trigger.player==player){
            if(player.num('h',function(card){
                return get.type(card)!='food';
            })){
                check=true;
            }
        }
        else{
            if(ai.get.attitude(player,trigger.player)>0){
                check=true;
            }
        }
        player.choosePlayerCard(trigger.player,get.prompt('qqwz_招亲',trigger.player),'h').set('ai',function(button){
            if(!_status.event.check) return 0;
            if(_status.event.target.isUnderControl(true,_status.event.player)){
                if(get.type(button.link)!='food'){
                    return 10-ai.get.value(button.link);
                }
                return 0;
            }
            else{
                return Math.random();
            }
        }).set('check',check).set('filterButton',function(button){
            if(_status.event.player==_status.event.target){
                return lib.filter.cardDiscardable(button.link,_status.event.player);
            }
            return true;
        });
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_招亲',trigger.player);
            event.card=result.links[0];
            player.showCards([event.card],get.translation(player)+'展示的手牌');
        }
        else{
            event.finish();
        }
        "step 2"
        if(get.type(event.card)!='food'){
            trigger.player.recover(9999);
            trigger.player.discard(event.card);
        }
    },
                ai:{
                    threaten:1.4,
                },
            },
            qqwz_镇军:{
                trigger:{
                    player:"shaBegin",
                },
                direct:true,
                filter:function (event,player){
        return event.target.hp>0&&event.target.num('he')>0;
    },
                audio:["qqwz镇军",2],
                logTarget:"target",
                content:function (){
        'step 0'
        player.addTempSkill('qqwz_镇军血','phaseAfter');
        player.choosePlayerCard(trigger.target,'he',
            [1,Math.min(trigger.target.num('he'),trigger.target.hp*2)],get.prompt('qqwz_镇军',trigger.target));
        'step 1'
        if(result.bool&&result.links.length){
            player.logSkill('qqwz_镇军');
            if(trigger.target.storage.qqwz_镇军2){
                trigger.target.storage.qqwz_镇军2=trigger.target.storage.qqwz_镇军2.concat(result.links);
            }
            else{
                trigger.target.storage.qqwz_镇军2=result.links;
            }
            game.addVideo('storage',trigger.target,['qqwz_镇军2',get.cardsInfo(trigger.target.storage.qqwz_镇军2),'cards']);
            trigger.target.addSkill('qqwz_镇军2');
            trigger.target.lose(result.links,ui.special);
        }
    },
                ai:{
                    expose:0.2,
                },
            },
            qqwz_镇军血:{
                audio:["qqwz镇军",2],
                trigger:{
                    source:"damageBegin",
                },
                filter:function (event){
                    if(event.player.get('h').length==0) return true;
            },
                forced:true,
                content:function (){
                trigger.num+=2;
            },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                        if(target.get('h').length==0) return [1,-2];
                    },
                    },
                },
            },
            qqwz_定心:{
                enable:"phaseUse",
                usable:2,
                multitarget:true,
                audio:["qqwz定心",2],
                filterTarget:function (card,player,target){
        if(player==target) return false;
        var num=target.num('h');
        if(ui.selected.targets.length){
            return num<ui.selected.targets[0].num('h');
        }
        var players=game.filterPlayer();
        for(var i=0;i<players.length;i++){
            if(num>players[i].num('h')) return true;
        }
        return false;
    },
                selectTarget:2,
                content:function (){
        'step 0'
        var gainner,giver;
        if(targets[0].num('h')<targets[1].num('h')){
            gainner=targets[0];
            giver=targets[1];
        }
        else{
            gainner=targets[1];
            giver=targets[0];
        }
        giver.chooseCard('选择1张手牌交给'+get.translation(gainner),true);
        event.gainner=gainner;
        event.giver=giver;
        'step 1'
        var card=result.cards[0];
        event.gainner.gain(card,event.giver);
        event.giver.$give(1,event.gainner);
        'step 2'
        if(event.gainner.num('h')!=event.giver.num('h')){
            if(player.hp<player.maxHp){
                player.chooseControl('draw_card','recover_hp',function(event,player){
                    if(player.hp>=3&&player.num('h')<player.hp) return 'draw_card';
                    return 'recover_hp';
                });
            }
            else{
                player.draw(2);
                event.finish();
            }
        }
        else{
            event.finish();
        }
        'step 3'
        if(result.control=='draw_card'){
            player.draw(2);
        }
        else{
            player.recover(3);
        }
    },
                ai:{
                    order:10.5,
                    threaten:2,
                    result:{
                        target:function (player,target){
                var num=target.num('h');
                var att=ai.get.attitude(player,target);
                if(ui.selected.targets.length==0){
                    if(att>0) return -1;
                    var players=game.filterPlayer();
                    for(var i=0;i<players.length;i++){
                        var num2=players[i].num('h');
                        var att2=ai.get.attitude(player,players[i]);
                        if(att2>=0&&num2<num) return -1;
                    }
                    return 0;
                }
                else{
                    return 1;
                }
            },
                        player:0.1,
                    },
                },
            },
            qqwz_魂忆:{
                audio:["qqwz魂忆",2],
                trigger:{
                    player:"dieBegin",
                },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_魂忆'),function(card,player,target){
            return player!=target&&_status.event.source!=target;
        }).set('ai',function(target){
            var num=ai.get.attitude(_status.event.player,target);
            if(num>0){
                if(target.hp==1){
                    num+=2;
                }
                if(target.hp<target.maxHp){
                    num+=2;
                }
            }
            return num;
        }).set('source',trigger.source);
        "step 1"
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('qqwz_魂忆',target);
            target.recover(9999);
            target.draw(5);
        }
    },
                ai:{
                    expose:0.5,
                },
            },
            qqwz_佳酿:{
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                audio:["qqwz佳酿",2],
                filter:function (event,player){
        return player.num('h')>0&&!player.storage.qqwz_佳酿.length;
    },
                init:function (player){
        player.storage.qqwz_佳酿=[];
    },
                intro:{
                    content:"cards",
                },
                content:function (){
        'step 0'
        player.chooseCard([1,player.num('h')],get.prompt('qqwz_佳酿')).set('ai',function(){
            return 1;
        });
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_佳酿');
            player.storage.qqwz_佳酿=player.storage.qqwz_佳酿.concat(result.cards);
            player.syncStorage('qqwz_佳酿');
            player.markSkill('qqwz_佳酿');
            player.lose(result.cards,ui.special);
            player.$give(result.cards,player);
        }
    },
                ai:{
                    effect:{
                        player:function (card,player){
                if(_status.currentPhase!=player) return;
                if(player.num('h')<=player.hp&&!player.storage.chunlao.length){
                    return [0,0,0,0];
                }
            },
                    },
                    threaten:1.4,
                },
                group:"qqwz_佳酿2",
            },
            qqwz_佳酿2:{
                audio:["qqwz佳酿",2],
                trigger:{
                    global:"dying",
                },
                priority:6,
                filter:function (event,player){
                return event.player.hp<=0&&player.storage.qqwz_佳酿.length>0;
            },
                direct:true,
                content:function (){
                "step 0"
                var att=ai.get.attitude(player,trigger.player);
                player.chooseCardButton(get.prompt('qqwz_佳酿',trigger.player),player.storage.qqwz_佳酿).set('ai',function(button){
                    if(_status.event.att>0) return 1;
                    return 0;
                }).set('att',att);
                "step 1"
                if(result.bool){
                    player.logSkill('qqwz_佳酿',trigger.player);
                    player.$throw(result.links);
                    player.storage.qqwz_佳酿.remove(result.links[0]);
                    ui.discardPile.appendChild(result.links[0]);
                    player.syncStorage('qqwz_佳酿');
                    trigger.player.useCard({name:'jiu'},trigger.player);
              trigger.player.hp+1;
                    if(!player.storage.qqwz_佳酿.length){
                        player.unmarkSkill('qqwz_佳酿');
                    }
                    else{
                        player.markSkill('qqwz_佳酿');
                    }
                }
            },
                ai:{
                    expose:0.2,
                },
            },
            qqwz_烈火:{
                audio:["qqwz烈火",2],
                trigger:{
                    player:"damageBefore",
                },
                forced:true,
                unique:true,
                filter:function (event){
        return event.nature=='fire';
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
    },
                ai:{
                    effect:{
                        target:function (card){
                if(get.tag(card,'fireDamage')){
                    return [0,2];
                }
            },
                    },
                },
                group:"qqwz_烈火2",
            },
            qqwz_烈火2:{
                audio:["qqwz烈火",2],
                trigger:{
                    player:"damageEnd",
                },
                forced:true,
                content:function (){
        trigger.source.damage(2,'fire')._triggered=null;
    },
            },
            qqwz_弓彰:{
                enable:"phaseUse",
                usable:1,
                audio:["qqwz弓彰",2],
                position:"he",
                filterCard:true,
                check:function (card){
        if(get.type(card)!='equip') return 0;
        var player=_status.currentPhase;
        if(player.num('he',{subtype:get.subtype(card)})>1){
            return 11-ai.get.equipValue(card);
        }
        return 6-ai.get.equipValue(card);
    },
                content:function (){
        "step 0"
        player.addTempSkill('qqwz_弓彰2','phaseAfter');
        "step 1"
        if(get.type(cards[0])=='equip'){
            player.chooseTarget('是否弃置一名角色的2张牌？',function(card,player,target){
                return player!=target&&target.num('he')>0;
            }).set('ai',function(target){
                var player=_status.event.player;
                if(ai.get.attitude(player,target)<0){
                    return Math.max(0.5,ai.get.effect(target,{name:'sha'},player,player));
                }
                return 0;
            });
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            player.line(result.targets,'green');
            event.target=result.targets[0];
            player.draw(2);
            player.discardPlayerCard(event.target,2,'he',true).ai=ai.get.buttonValue;
        }
    },
                ai:{
                    order:9,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_弓彰2:{
                mod:{
                    attackFrom:function (){
            return -Infinity;
        },
                    targetInRange:function (card,player,target,now){
            if(card.name=='sha') return true;
            },
                },
                trigger:{
                    player:"shaBegin",
                },
                forced:true,
                filter:function (event,player){
                return event.card;
            },
                content:function (){
                trigger.directHit=true;
            },
            },
            qqwz_直入:{
                skillAnimation:true,
                audio:["qqwz直入",2],
                unique:true,
                mark:true,
                init:function (player){
        player.storage.qqwz_直入=false;
    },
                enable:"phaseUse",
                filter:function (event,player){
        return !player.storage.qqwz_直入;
    },
                intro:{
                    content:"limited",
                },
                filterTarget:true,
                content:function (){
        "step 0"
        player.awakenSkill('qqwz_直入');
        player.storage.qqwz_直入=true;
        event.players=game.filterPlayer(function(current){
            return current!=target&&get.distance(current,target,'attack')<=1;
        });
        event.players.sortBySeat(target);
        "step 1"
        if(event.players.length){
            event.current=event.players.shift();
            event.current.animate('target');
            if(event.current.num('he')&&target.isAlive()){
                event.current.chooseToDiscard({subtype:'equip1'},'he','弃置一张武器牌或让'+
                get.translation(target)+'摸一张牌并回复2点体力').set('ai',function(card){
                    if(ai.get.attitude(_status.event.player,_status.event.target)<0) return 7-ai.get.value(card);
                    return -1;
                }).set('target',target);
                event.tempbool=false;
            }
            else{
                event.tempbool=true;
            }
        }
        else{
            event.finish();
        }
        "step 2"
        if(event.tempbool||result.bool==false){
            target.draw(2);
            target.recover();
        }
        event.goto(1);
    },
                ai:{
                    order:5,
                    result:{
                        target:function (player,target){
                if(player.hp>2){
                    if(game.phaseNumber<game.players.length*2) return 0;
                }
                var num=0,players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(players[i]!=target&&get.distance(players[i],target,'attack')<=1){
                        num++;
                    }
                }
                return num;
            },
                    },
                },
            },
            qqwz_毒箭:{
                audio:["qqwz毒箭",2],
                trigger:{
                    source:"damageBegin",
                },
                check:function (event,player){
        return ai.get.attitude(player,event.player)<=0;
    },
                forced:true,
                filter:function (event,player){
        return event.card&&get.distance(event.player,player,'attack')>1;
    },
                content:function (){
        trigger.num+=2;
    },
            },
            qqwz_缴械:{
                trigger:{
                    player:"damageEnd",
                },
                filter:function (event,player){
        return player.num('he')>0&&event.source&&event.source.get('e')!=undefined&&
            event.card&&event.card.name=='sha';
    },
                check:function (event,player){
        return ai.get.attitude(player,event.source)<=0;
    },
                direct:true,
                priority:5,
                audio:["qqwz缴械",2],
                content:function (){
        'step 0'
        var next=player.chooseToDiscard('he',get.prompt('qqwz_缴械'));
        next.logSkill=['qqwz_缴械',trigger.source];
        next.set('ai',function(card){
            if(ai.get.attitude(_status.event.player,_status.event.getTrigger().source)<0){
                return 6-ai.get.value(card);
            }
            return 0;
        });
        'step 1'
        if(result.bool){
            trigger.source.$give(trigger.source.get('e'),player);
            player.gain(trigger.source.get('e'),trigger.source);
        }
    },
            },
            qqwz_亡箭:{
                audio:["qqwz亡箭",2],
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='e') return true;
        }
        return false;
    },
                content:function (){
        var num=0;
        for(var i=0;i<trigger.cards.length;i++){
            if(trigger.cards[i].original=='e') num+=2;
        }
        player.recover(num);
    },
                ai:{
                    noe:true,
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='equip') return [1,3];
            },
                    },
                },
            },
            qqwz_擒拿:{
                audio:["qqwz擒拿",2],
                trigger:{
                    global:"recoverBefore",
                },
                forced:true,
                filter:function (event,player){
    return player!=event.player;
},
                content:function (){
       trigger.player.skip('phase')
},
            },
            qqwz_矜持:{
                audio:["qqwz矜持",2],
                trigger:{
                    player:"damageBegin",
                },
                filter:function (event,player){
        return event.source&&event.source.sex=='male';
    },
                direct:true,
                content:function (){
        "step 0"
        var next=player.chooseToDiscard('he','矜持：是否弃置一张牌令伤害-2？',function(card,player){
            return get.type(card)!='equip';
        });
        next.set('ai',function(card){
            var player=_status.event.player;
            if(player.hp==1||_status.event.getTrigger().num>1){
                return 9-ai.get.value(card);
            }
            if(player.hp==2){
                return 8-ai.get.value(card);
            }
            return 7-ai.get.value(card);
        });
        next.logSkill='qqwz_矜持';
        "step 1"
        if(result.bool){
            game.delay(0.5);
            trigger.num-=2;
        }
    },
            },
            qqwz_毁誉:{
                audio:["qqwz毁誉",2],
                trigger:{
                    player:"useCard",
                },
                filter:function (event,player){
        if(_status.currentPhase!=player) return false;
        if(player.hasSkill('qqwz_毁誉2')) return false;
        if(event.targets.length>1) return false;
        var card=event.card;
        if(card.name=='sha') return true;
        if(get.type(card)=='trick') return true;
        return false;
    },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_毁誉'),function(card,player,target){
            if(player==target) return false;
            var trigger=_status.event.getTrigger();
            return player.canUse(trigger.card,target)&&trigger.targets.contains(target)==false;
        }).set('ai',function(target){
            var trigger=_status.event.getTrigger();
            var player=_status.event.player;
            return ai.get.effect(target,trigger.card,player,player)+1;
        });
        "step 1"
        if(result.bool){
            game.delay(0,200);
            event.target=result.targets[0];
        }
        else{
            event.finish();
        }
        "step 2"
        game.delay();
        player.addSkill('qqwz_毁誉2');
        player.logSkill('qqwz_毁誉',event.target);
        event.target.chooseCard('交给'+get.translation(player)+'一张手牌，或成为'+
        get.translation(trigger.card)+'的额外目标').set('ai',function(card){
            return 5-ai.get.value(card);
        });
        "step 3"
        if(result.bool){
            player.gain(result.cards,event.target);
            event.target.$give(1,player);
            game.delay();
            trigger.untrigger();
            trigger.player=event.target;
            trigger.trigger('useCard');
            game.log(event.target,'成为了',trigger.card,'的使用者');
        }
        else{
            game.log(event.target,'成为了',trigger.card,'的额外目标');
            trigger.targets.push(event.target);
        }
    },
            },
            qqwz_耿直:{
                audio:["qqwz耿直",2],
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_耿直')).set('ai',function(target){
            return ai.get.attitude(_status.event.player,target);
        });
        "step 1"
        if(result.bool){
            event.target=result.targets[0];
            player.logSkill('qqwz_耿直',result.targets);
        }
        else{
            event.finish();
        }
        "step 2"
        var cards=get.cards();
        var card=cards[0];
        switch(get.type(card,'trick')){
            case 'basic':event.effect='gainMaxHp';break;
            case 'trick':event.effect='draw';break;
            case 'equip':event.effect='recover';break;
            case 'jiguan':event.effect='damage';break;
        }
        if(get.type(card)=='equip'){
            event.target.equip(card);
            event.target.$draw(card);
            game.delay();
        }
        else{
            event.target.gain(cards,'gain2','log');
        }
        "step 3"
        switch(event.effect){
            case 'recover':event.target.recover();break;
        }
        switch(event.effect){
             case 'draw':event.target.draw(3);break;   
        }
         switch(event.effect){
             case 'gainMaxHp':event.target.gainMaxHp();break;   
        }
         switch(event.effect){
             case 'damage':event.target.damage();break;   
        }
    },
                ai:{
                    expose:0.2,
                    threaten:1.2,
                },
            },
            qqwz_妙玄:{
                audio:["qqwz妙玄",2],
                trigger:{
                    player:"discardAfter",
                },
                filter:function (event,player){
        for(var i=0;i<event.cards.length;i++){
            if(get.position(event.cards[i])=='d'){
                return true;
            }
        }
        return false;
    },
                frequent:true,
                popup:false,
                content:function (){
        "step 0"
        player.draw();
        var cards=[];
        for(var i=0;i<trigger.cards.length;i++){
            if(get.position(trigger.cards[i])=='d'){
                cards.push(trigger.cards[i]);
            }
        }
        player.chooseCardButton(cards,[1,cards.length],'妙玄：将弃置的牌按任意顺序置于牌堆顶（先选择的在上）').set('ai',function(){
            return -1;
        });
        "step 1"
        if(result&&result.bool&&result.links&&result.links.length){
            var cards=result.links.slice(0);
            while(cards.length){
                ui.cardPile.insertBefore(cards.pop(),ui.cardPile.firstChild);
            }
            player.logSkill('qqwz_妙玄');
        }
    },
            },
            qqwz_诱饵:{
                audio:["qqwz诱饵",2],
                trigger:{
                    player:["phaseEnd","phaseBegin"],
                },
                direct:true,
                filter:function (event,player){
        return player.num('he')>0;
    },
                check:function (event,player){
        return player.num('h','sha')<=player.num('h')/3;
    },
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_诱饵'),function(card,player,target){
            return player!=target;
        }).set('ai',function(target){
            if(target.num('he')==0) return 0;
            return -ai.get.attitude(_status.event.player,target);
        });
        "step 1"
        if(result.bool){
            game.delay();
            player.logSkill('qqwz_诱饵',result.targets);
            event.target=result.targets[0];
            event.target.discardPlayerCard(player,'hej',true);
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.links[0].name!='sha'&&event.target.num('he')){
            player.recover(2);
            player.gainPlayerCard(2,'he',event.target,true);
        }
    },
                ai:{
                    expose:0.2,
                    threaten:1.4,
                },
            },
            qqwz_秉正:{
                audio:["qqwz秉正",2],
                trigger:{
                    player:["phaseDiscardEnd","phaseBegin"],
                },
                filter:function (event,player){
        var cards=player.get('h');
        if(cards.length<1) return false;
        var color=get.color(cards[0]);
        for(var i=1;i<cards.length;i++){
            if(get.color(cards[i])!=color) return false;
        }
        return true;
    },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_秉正'),[1,player.num('h')],function(card,player,target){
            return true;
        }).set('ai',function(target){
            return ai.get.attitude(_status.event.player,target);
        });
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_秉正');
            player.showHandcards(get.translation(player)+'发动了【秉正】');
            event.targets=result.targets;
        }
        else{
            event.finish();
        }
        "step 2"
        if(targets&&targets.length){
            player.line(targets,'green');
            game.asyncDraw(targets);
        }
    },
                ai:{
                    expose:0.1,
                },
            },
            qqwz_慎重:{
                audio:["qqwz慎重",2],
                enable:"phaseUse",
                position:"he",
                filterCard:true,
                selectCard:2,
                prompt:"弃置两张牌并摸一张牌回复1点体力增加1点体力上限",
                check:function (card){return 4-ai.get.useful(card)},
                content:function (){
        player.draw();
        player.recover();
        player.gainMaxHp();
    },
                ai:{
                    order:1,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_安邦:{
                audio:["qqwz安邦",2],
                enable:"phaseUse",
                usable:2,
                filterTarget:function (card,player,target){
        return player!=target&&target.num('e')>0;
    },
                content:function (){
        'step 0'
        player.choosePlayerCard(target,'e',true);
        'step 1'
        if(result.links){
            var num=0,players=game.filterPlayer();
            for(var i=0;i<players.length;i++){
                if(get.distance(target,players[i],'attack')<=1){
                    num++;
                }
            }
            event.num=num;
            target.gain(result.links,'gain2');
        }
        else{
            event.finish();
        }
        'step 2'
        var num2=0,players=game.filterPlayer();
        for(var i=0;i<players.length;i++){
            if(get.distance(target,players[i],'attack')<=1){
                num2++;
            }
        }
        if(event.num>num2){
            player.draw(2);
            player.recover(2);
        }
    },
                ai:{
                    order:7,
                    result:{
                        target:function (player,target){
                if(target.hasSkillTag('noe')) return 1;
                if(target.get('e','1')||target.get('e','4')) return -1;
                if(target.get('e','2')) return -0.7;
                return -0.5;
            },
                    },
                },
            },
            qqwz_相助:{
                audio:["qqwz相助",2],
                trigger:{
                    player:"damageEnd",
                    source:"damageEnd",
                },
                direct:true,
                filter:function (event,player){
        var nh=player.num('h');
        return game.hasPlayer(function(current){
            return current.num('h')!=nh;
        });
    },
                content:function (){
        'step 0'
        var nh=player.num('h');
        player.chooseTarget(get.prompt('qqwz_相助'),function(card,player,target){
            return _status.event.nh!=target.num('h');
        }).set('ai',function(target){
            var att=ai.get.attitude(_status.event.player,target);
            if(target.num('h')>_status.event.nh) return -att;
            return att;
        }).set('nh',nh);
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_相助',result.targets);
            var target=result.targets[0];
            if(target.num('h')<player.num('h')){
                target.draw(2);
            }
            else{
                target.discard(target.get('h').randomGet());
            }
        }
    },
                ai:{
                    expose:0.2,
                },
            },
            qqwz_阵邀:{
                audio:["qqwz阵邀",2],
                usable:1,
                trigger:{
                    player:"chooseToRespondBegin",
                },
                filter:function (event,player){
        if(event.responded) return false;
        if(!event.filterCard({name:'shan'})&&!!event.filterCard({name:'sha'})) return false;
        var nh=player.num('h');
        return game.hasPlayer(function(current){
            return current!=player&&current.num('h')<nh;
        });
    },
                direct:true,
                prompt:function (){
                return '与一名角色交换手牌视为使用一张闪';
            },
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_阵邀'),function(card,player,target){
            return target.num('h')<player.num('h');
        }).set('ai',function(target){
            return ai.get.attitude(player,target)
        });
        "step 1"
        if(result.bool){
            trigger.untrigger();
            trigger.responded=true;
            if(trigger.filterCard({name:'shan'})){
                trigger.result={bool:true,card:{name:'shan'}}
            }
            else{
                trigger.result={bool:true,card:{name:'sha'}}
            }
            player.logSkill('qqwz_阵邀',result.targets);
            player.swapHandcards(result.targets[0]);
        }
    },
                group:["qqwz_阵邀_sha","qqwz_阵邀_tao","qqwz_阵邀_jiu"],
            },
            qqwz_阵邀_sha:{
                enable:"chooseToUse",
                usable:1,
                viewAs:{
                    name:"sha",
                },
                log:false,
                viewAsFilter:function (player){
        var nh=player.num('h');
        return game.hasPlayer(function(current){
            return current!=player&&current.num('h')<nh;
        });
    },
                prompt:function (){
                return '与一名角色交换手牌视为使用一张杀';
            },
                precontent:function (){
        'step 0'
        player.chooseTarget('选择交换手牌的目标',function(card,player,target){
            return target.num('h')<player.num('h')
        },true).ai=function(target){
            return ai.get.attitude(player,target);
        }
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_阵邀_sha',result.targets);
            player.swapHandcards(result.targets[0]);
        }
    },
                filterCard:function (card){
        return false;
    },
                selectCard:-1,
                ai:{
                    skillTagFilter:function (player,tag,arg){
            var nh=player.num('h');
            return game.hasPlayer(function(current){
                return current!=player&&current.num('h')<nh;
            });
        },
                    order:function (){
            var player=_status.event.player;
            var nh=player.num('h');
            if(game.hasPlayer(function(current){
                return ai.get.attitude(player,current)>0&&current.num('h')<nh;
            })){
                return 2.9;
            }
            return 0;
        },
                    respondSha:true,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    result:{
                        target:function (player,target){
                if(player.hasSkill('jiu')&&!target.num('e','baiyin')){
                    if(ai.get.attitude(player,target)>0){
                        return -6;
                    }
                    else{
                        return -3;
                    }
                }
                return -1.5;
            },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                if(card.nature=='poison') return;
                return 1;
            },
                        natureDamage:function (card){
                if(card.nature) return 1;
            },
                        fireDamage:function (card,nature){
                if(card.nature=='fire') return 1;
            },
                        thunderDamage:function (card,nature){
                if(card.nature=='thunder') return 1;
            },
                        poisonDamage:function (card,nature){
                if(card.nature=='poison') return 1;
            },
                    },
                },
            },
            qqwz_阵邀_tao:{
                enable:"chooseToUse",
                usable:1,
                viewAs:{
                    name:"tao",
                },
                viewAsFilter:function (player){
        var nh=player.num('h');
        return game.hasPlayer(function(current){
            return current!=player&&current.num('h')<nh;
        });
    },
                log:false,
                prompt:function (){
                return '与一名角色交换手牌视为使用一张桃';
            },
                precontent:function (){
        'step 0'
        player.chooseTarget('选择交换手牌的目标',function(card,player,target){
            return target.num('h')<player.num('h')
        },true).ai=function(target){
            return ai.get.attitude(player,target);
        }
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_阵邀_tao',result.targets);
            player.swapHandcards(result.targets[0]);
        }
    },
                filterCard:function (card){
        return false;
    },
                selectCard:-1,
                ai:{
                    skillTagFilter:function (player,tag,arg){
            var nh=player.num('h');
            return game.hasPlayer(function(current){
                return current!=player&&current.num('h')<nh;
            });
        },
                    order:function (){
            var player=_status.event.player;
            var nh=player.num('h');
            if(game.hasPlayer(function(current){
                return ai.get.attitude(player,current)>0&&current.num('h')<nh;
            })){
                return _status.event.type=='dying'?0.5:4;
            }
            return 0;
        },
                    save:true,
                    basic:{
                        order:function (card,player){
                if(player.hasSkillTag('pretao')) return 5;
                return 2;
            },
                        useful:[8,6.5],
                        value:[8,6.5],
                    },
                    result:{
                        target:function (player,target){
                // if(player==target&&player.hp<=0) return 2;
                var nd=player.needsToDiscard();
                var keep=false;
                if(nd<=0){
                    keep=true;
                }
                else if(nd==1&&target.hp>=2&&target.num('h','tao')<=1){
                    keep=true;
                }
                var mode=get.mode();
                if(target.hp>=2&&keep&&target.hasFriend()){
                    if(target.hp>2||nd==0) return 0;
                    if(target.hp==2){
                        if(game.hasPlayer(function(current){
                            if(target!=current&&ai.get.attitude(target,current)>=3){
                                if(current.hp<=1) return true;
                                if((mode=='identity'||mode=='versus'||mode=='chess')&&current.identity=='zhu'&&current.hp<=2) return true;
                            }
                        })){
                            return 0;
                        }
                    }
                }
                if(target.hp<0&&target!=player&&target.identity!='zhu') return 0;
                var att=ai.get.attitude(player,target);
                if(att<3&&att>=0&&player!=target) return 0;
                var tri=_status.event.getTrigger();
                if(mode=='identity'&&player.identity=='fan'&&target.identity=='fan'){
                    if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='fan'&&tri.source!=target){
                        var num=game.countPlayer(function(current){
                            if(current.identity=='fan'){
                                return current.num('h','tao');
                            }
                        });
                        if(num>1&&player==target) return 2;
                        return 0;
                    }
                }
                if(mode=='identity'&&player.identity=='zhu'&&target.identity=='nei'){
                    if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='zhong'){
                        return 0;
                    }
                }
                if(mode=='stone'&&target.isMin()&&
                player!=target&&tri&&tri.name=='dying'&&player.side==target.side&&
                tri.source!=target.getEnemy()){
                    return 0;
                }
                return 2;
            },
                    },
                    tag:{
                        recover:1,
                        save:1,
                    },
                },
            },
            qqwz_阵邀_jiu:{
                enable:"chooseToUse",
                usable:1,
                viewAs:{
                    name:"jiu",
                },
                viewAsFilter:function (player){
        var nh=player.num('h');
        return game.hasPlayer(function(current){
            return current!=player&&current.num('h')<nh;
        });
    },
                log:false,
                prompt:function (){
                return '与一名角色交换手牌视为使用一张酒';
            },
                precontent:function (){
        'step 0'
        player.chooseTarget('选择交换手牌的目标',function(card,player,target){
            return target.num('h')<player.num('h')
        },true).ai=function(target){
            return ai.get.attitude(player,target);
        }
        'step 1'
        if(result.bool){
            player.logSkill('qqwz_阵邀_jiu',result.targets);
            player.swapHandcards(result.targets[0]);
        }
    },
                filterCard:function (card){
        return false;
    },
                selectCard:-1,
                ai:{
                    skillTagFilter:function (player,tag,arg){
            var nh=player.num('h');
            return game.hasPlayer(function(current){
                return current!=player&&current.num('h')<nh;
            });
        },
                    order:0,
                    save:true,
                    basic:{
                        useful:function (card,i){
                if(_status.event.player.hp>1){
                    if(i==0) return 5;
                    return 1;
                }
                if(i==0) return 7.3;
                return 3;
            },
                        value:function (card,player){
                if(player.hp>1){
                    if(i==0) return 5;
                    return 1;
                }
                if(i==0) return 7.3;
                return 3;
            },
                    },
                    result:{
                        target:function (player,target){
                if(target&&target.isDying()) return 2;
                if(lib.config.mode=='stone'&&!player.isMin()){
                    if(player.getActCount()+1>=player.actcount) return 0;
                }
                var shas=player.get('h','sha');
                if(shas.length>1&&player.getCardUsable('sha')>1){
                    return 0;
                }
                var card;
                if(shas.length){
                    for(var i=0;i<shas.length;i++){
                        if(lib.filter.filterCard(shas[i],target)){
                            card=shas[i];break;
                        }
                    }
                }
                else if(player.hasSha()&&player.needsToDiscard()){
                    if(player.num('h','hufu')!=1){
                        card={name:'sha'};
                    }
                }
                if(card){
                    if(game.hasPlayer(function(current){
                        return (ai.get.attitude(target,current)<0&&
                            target.canUse(card,current,true,true)&&
                            !current.num('e','baiyin')&&
                            ai.get.effect(current,card,target)>0);
                    })){
                        return 1;
                    }
                }
                return 0;
            },
                    },
                    tag:{
                        save:1,
                    },
                },
            },
            qqwz_善学:{
                audio:["qqwz善学",2],
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                content:function (){
        'step 0'
        var num=player.hp;
        if(!player.hasSkill('qqwz_鸿宴')){
            num=player.maxHp;
        }
        player.chooseTarget([1,num],get.prompt('qqwz_善学')).set('ai',function(target){
            var att=ai.get.attitude(_status.event.player,target);
            if(target.num('he')) return att;
            return att/10;
        });
        'step 1'
        if(result.bool){
            player.logSkill("qqwz_善学",result.targets);
            event.targets=result.targets;
            event.targets.sort(lib.sort.seat);
        }
        else{
            event.finish();
        }
        'step 2'
        if(event.targets.length){
            var target=event.targets.shift();
            target.draw(2);
            event.current=target;
        }
        else{
            event.finish();
        }
        'step 3'
        if(event.current&&event.current.num('he')){
            event.current.chooseCard('选择一张牌置于牌堆顶','he',true);
        }
        else{
            event.goto(2);
        }
        'step 4'
        if(result&&result.cards){
            event.card=result.cards[0];
            event.current.lose(result.cards,ui.special);
            game.broadcastAll(function(player){
                var cardx=ui.create.card();
                cardx.classList.add('infohidden');
                cardx.classList.add('infoflip');
                player.$throw(cardx,1000,'nobroadcast');
            },event.current);
        }
        else{
            event.card=null;
        }
        'step 5'
        if(event.current==game.me) game.delay(0.5);
        'step 6'
        if(event.card){
            event.card.fix();
            ui.cardPile.insertBefore(event.card,ui.cardPile.firstChild);
        }
        event.goto(2);
    },
            },
            qqwz_鸿宴:{
                audio:["qqwz鸿宴",2],
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return target.num('he')>0&&target!=player;
    },
                content:function (){
        'step 0'
        if(target.num('e')){
            target.chooseBool('是否将装备区内的所有牌交给'+get.translation(player)+'？').set('ai',function(){
                if(_status.event.player.num('e')>=3) return false;
                return true;
            });
        }
        else{
            target.chooseToDiscard(3,true,'he');
            event.finish();
        }
        'step 1'
        if(result.bool){
            var es=target.get('e');
            player.gain(es,target);
            target.$give(es,player);
            player.removeSkill('qqwz_鸿宴');
        }
        else{
            target.chooseToDiscard(3,true,'he');
        }
    },
                ai:{
                    order:6,
                    result:{
                        target:function (player,target){
                var ne=target.num('e');
                if(!ne) return -2;
                if(ne>=2) return -ne;
                return 0;
            },
                    },
                },
            },
            qqwz_王召:{
                unique:true,
                global:"qqwz_王召2",
                zhuSkill:true,
            },
            qqwz_王召2:{
                mod:{
                    attackTo:function (from,to,distance){
                    if(from.group!='wu') return;
                    var players=game.filterPlayer();
                    for(var i=0;i<players.length;i++){
                        if(from!=players[i]&&to!=players[i]&&
                            players[i].hasZhuSkill('qqwz_王召',from)){
                            if(get.distance(players[i],to)<=1) return distance-100;
                        }
                    }
                },
                },
            },
            qqwz_善民:{
                enable:"phaseUse",
                usable:1,
                audio:["qqwz善民",2],
                filterTarget:function (card,player,target){
        return target!=player&&target.num('he')>0;
    },
                content:function (){
        'step 0'
        target.chooseCard('he',[1,9],'善民：将1~9张牌置于'+get.translation(player)+'的武将牌上',true).set('ai',function(card){
            if(ai.get.attitude(_status.event.player,_status.event.getParent().player)>0){
                return 7-ai.get.value(card);
            }
            return -ai.get.value(card);
        });
        'step 1'
        if(result.bool){
            target.$give(result.cards,player);
            target.lose(result.cards,ui.special);
            player.storage.qqwz_善民_draw=result.cards;
            player.storage.qqwz_善民_draw_source=target;
            player.syncStorage('qqwz_善民_draw');
            player.addSkill('qqwz_善民_draw');
        }
    },
                ai:{
                    order:1,
                    result:{
                        target:function (player,target){
                if(ai.get.attitude(player,target)>0){
                    return Math.sqrt(target.num('he'));
                }
                return 0;
            },
                        player:1,
                    },
                },
                subSkill:{
                    draw:{
                        trigger:{
                            player:"phaseBegin",
                        },
                        forced:true,
                        mark:true,
                        intro:{
                            content:"cards",
                        },
                        content:function (){
                var cards=player.storage.qqwz_善民_draw;
                if(cards){
                    player.gain(cards,'gain2');
                    var target=player.storage.qqwz_善民_draw_source;
                    if(target&&target.isAlive()){
                        target.draw(cards.length);
                    }
                }
                delete player.storage.qqwz_善民_draw;
                delete player.storage.qqwz_善民_draw_source;
                player.removeSkill('qqwz_善民_draw');
            },
                    },
                },
            },
            qqwz_奢豪:{
                audio:["qqwz奢豪",2],
                enable:"phaseUse",
                filter:function (event,player){
        return player.getHandcardLimit()>0;
    },
                init:function (player){
        player.storage.qqwz_奢豪=0;
    },
                usable:20,
                content:function (){
        player.draw(2);
        player.storage.qqwz_奢豪++;
    },
                ai:{
                    order:10,
                    result:{
                        player:function (player){
                if(player.num('h')<player.getHandcardLimit()){
                    return 1;
                }
                return 0;
            },
                    },
                },
                mod:{
                    maxHandcard:function (player,num){
            return num-player.storage.qqwz_奢豪;
        },
                },
                group:["qqwz_奢豪2","qqwz_奢豪3"],
            },
            qqwz_奢豪2:{
                trigger:{
                    player:"phaseAfter",
                },
                forced:true,
                popup:false,
                silent:true,
                content:function (){
                player.storage.qqwz_奢豪=0;
            },
            },
            qqwz_奢豪3:{
                audio:["qqwz奢豪",2],
                trigger:{
                    player:"phaseEnd",
                },
                direct:true,
                filter:function (event,player){
        if(player.num('h')) return false;
        return game.hasPlayer(function(current){
            return !current.isLinked();
        });
    },
                content:function (){
        "step 0"
             player.draw(4);
        var num=game.countPlayer(function(current){
            return !current.isLinked();
        });
        player.chooseTarget(get.prompt('qqwz_奢豪'),[1,Math.min(num,player.hp)],function(card,player,target){
            return !target.isLinked();
        }).set('ai',function(target){
            return -ai.get.attitude(_status.event.player,target);
        });
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_奢豪',result.targets);
            event.targets=result.targets;
            event.num=0;
        }
        else{
            event.finish();
        }
        "step 2"
        if(event.num<event.targets.length){
            event.targets[event.num].link();
            event.num++;
            event.redo();
        }
    },
                ai:{
                    expose:0.3,
                },
            },
            qqwz_罪责:{
                audio:["qqwz罪责",2],
                trigger:{
                    player:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
        return player.isLinked()&&event.notLink()&&event.nature=='fire';
    },
                content:function (){
        trigger.num+=2;
    },
            },
            qqwz_掌控:{
                init2:function (player){
player.storage.qqwz_掌控=[]
},
                trigger:{
                    player:"phaseAfter",
                },
                audio:["qqwz掌控",2],
                forced:true,
                content:function (){
player.gain(player.storage.qqwz_掌控)
player.storage.qqwz_掌控=[]
},
                group:"qqwz_掌控2",
            },
            qqwz_掌控2:{
                trigger:{
                    global:"loseAfter",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player&&_status.currentPhase==player
},
                content:function (){
player.storage.qqwz_掌控=player.storage.qqwz_掌控.concat(trigger.cards)
},
            },
            qqwz_伺机:{
                trigger:{
                    player:"loseEnd",
                },
                audio:["qqwz伺机",2],
                forced:true,
                popup:false,
                content:function (){
trigger.player.logSkill('qqwz_伺机')
for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='wu') game.players[i].draw()._triggered=null;;
}
   for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='wei') game.players[i].loseHp()._triggered=null;;
}
        for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='shu') game.players[i].recover()._triggered=null;;
}
        for(var i=0;i<game.players.length;i++){
if(game.players[i].group=='qun') game.players[i].loseMaxHp()._triggered=null;;
}
},
                group:"qqwz_伺机2",
            },
            qqwz_白衣:{
                skillAnimation:true,
                audio:["qqwz白衣",2],
                unique:true,
                trigger:{
                    player:"phaseBegin",
                },
                forced:true,
                filter:function (event,player){
        if(player.storage.qqwz_白衣) return false;
        if(player.num('h')>=player.hp+3) return true;
        if(player.num('h')>=player.hp+2&&game.players.length+game.dead.length>=7) return true;
        return false;
    },
                content:function (){
        player.storage.qqwz_白衣=true;
        player.loseMaxHp(2);
        player.recover(999);
        player.addSkill('qqwz_掌控');
        player.awakenSkill('qqwz_白衣');
    },
            },
            qqwz_伺机2:{
                trigger:{
                    player:"phaseDiscardBefore",
                },
                audio:["qqwz伺机",2],
                forced:true,
                content:function (){
    trigger.untrigger();
    trigger.finish();
},
            },
            qqwz_锦帆:{
                skillAnimation:true,
                audio:["qqwz锦帆",2],
                unique:true,
                mark:true,
                trigger:{
                    global:"useCard",
                },
                priority:5,
                filter:function (event,player){
        if(get.type(event.card)!='trick') return false;
        if(get.info(event.card).multitarget) return false;
        if(event.targets.length<2) return false;
        if(player.storage.qqwz_锦帆) return false;
        return true;
    },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('qqwz_锦帆'),
            [1,trigger.targets.length],function(card,player,target){
            return _status.event.getTrigger().targets.contains(target);
        }).set('ai',function(target){
            var trigger=_status.event.getTrigger();
            if(game.phaseNumber>game.players.length*2&&trigger.targets.length>=game.players.length-1){
                return -ai.get.effect(target,trigger.card,trigger.player,_status.event.player);
            }
            return -1;
        });
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_锦帆',result.targets);
            for(var i=0;i<result.targets.length;i++){
                trigger.targets.remove(result.targets[i]);
            }
            game.delay();
        }
    },
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'){
                return false;
            }
        },
                },
            },
            qqwz_合围:{
                audio:["qqwz合围",2],
                trigger:{
                    source:"damageEnd",
                },
                forced:true,
                filter:function (event,player){
return player!=event.player&&player.num('he')==0;
},
                content:function (){
trigger.player.die()._triggered=null;
},
                group:["qqwz_合围2","qqwz_合围3"],
            },
            qqwz_合围2:{
                audio:["qqwz合围",2],
                trigger:{
                    player:"useCardAfter",
                },
                forced:true,
                filter:function (event,player){
return get.type(event.card)=='basic'&&Math.random()<=0.5;
},
                content:function (){
player.useCard(trigger.card,trigger.targets,false)._triggered=null;
},
            },
            qqwz_合围3:{
                audio:["qqwz合围",2],
                enable:"phaseUse",
                usable:1,
                position:"he",
                filterCard:true,
                selectCard:2,
                prompt:"弃置两张牌并对全体造成1点神圣伤害",
                check:function (card){return 4-ai.get.useful(card)},
                content:function (){
        for(var i=0;i<game.players.length;i++){
        if(game.players[i]!=player){
            game.players[i].damage(1)._triggered=null;;
        };
            player.recover(999);
    };
    },
                ai:{
                    order:1,
                    result:{
                        player:1,
                    },
                },
            },
            qqwz_霸业:{
                audio:["qqwz霸业",2],
                group:"qqwz_霸业2",
                trigger:{
                    player:"phaseDrawBegin",
                },
                forced:true,
                content:function (){
        trigger.num+=3;
    },
                ai:{
                    threaten:1.5,
                },
                mod:{
                    maxHandcard:function (player,num){
            if(player.hp<player.maxHp) return num+player.maxHp-player.hp;
        },
                },
            },
            qqwz_霸业2:{
                trigger:{
                    source:"damageEnd",
                },
                audio:["qqwz霸业",2],
                forced:true,
                filter:function (event,player){
        if(event.getParent().name!='qqwz_霸业'){
            for(var i=0;i<game.players.length;i++){
                if(game.players[i].get('e','1')&&game.players[i]!=event.player) return true;
            }
        }
        return false;
    },
                content:function (){
        for(var i=0;i<game.players.length;i++){
            if(game.players[i].get('e','1')&&game.players[i]!=trigger.player){
                game.players[i].damage(trigger.num);
            }
        }
    },
            },
            qqwz_控局:{
                audio:["qqwz控局",2],
                enable:"phaseUse",
                usable:2,
                filter:function (event,player){
        return player.num('h')>0;
    },
                filterTarget:function (card,player,target){
        return player!=target;
    },
                filterCard:true,
                check:function (card){
        return 8-ai.get.value(card);
    },
                discard:false,
                prepare:"give",
                content:function (){
        "step 0"
        target.storage.qqwz_控局=cards[0];
        target.gain(cards[0],player);
        "step 1"
        target.chooseControl('展示手牌','流失体力').ai=function(event,player){
            var cards=player.get('he',{suit:get.suit(player.storage.qqwz_控局)});
            if(cards.length==1) return 0;
            if(cards.length>=2){
                for(var i=0;i<cards.length;i++){
                    if(get.tag(cards[i],'save')) return 1;
                }
            }
            if(player.hp==1) return 0;
            for(var i=0;i<cards.length;i++){
                if(ai.get.value(cards[i])>=8) return 1;
            }
            if(cards.length>2&&player.hp>2) return 1;
            if(cards.length>3) return 1;
            return 0;
        }
        "step 2"
        if(result.control=='展示手牌'){
            target.showHandcards();
        }
        else{
            target.loseHp(2);
            event.finish();
        }
        "step 3"
        target.discard(target.get('he',{suit:get.suit(target.storage.qqwz_控局)}))
        delete target.storage.qqwz_控局;
    },
                ai:{
                    order:9,
                    result:{
                        target:function (player,target){
                return -target.num('he')-(player.num('h','du')?1:0);
            },
                    },
                    threaten:2,
                },
            },
            qqwz_谋策:{
                audio:["qqwz谋策",2],
                group:["qqwz_谋策2","qqwz_谋策3"],
                trigger:{
                    target:"useCardToBefore",
                },
                filter:function (event,player){
        if(event.player==player) return false;
        if(event.getParent(2).player&&event.getParent(2).player==player) return false;
        return player.hp!=1;
    },
                frequent:true,
                content:function (){
        "step 0"
        player.draw(3);
        "step 1"                        
        player.chooseToUse();            
    },
            },
            qqwz_谋策2:{
                audio:["qqwz谋策",2],
                trigger:{
                    global:"phaseEnd",
                },
                filter:function (event,player){
        return event.player!=player&&event.player.isAlive();
    },
                logTarget:"player",
                forced:true,
                content:function (){
        'step 0'
        var hs=trigger.player.get('he');
        if(hs.length){
            player.gain(hs.randomGet(),trigger.player);
            trigger.player.$give(2,player);
        }    
        'step 1'
        trigger.player.chooseToUse('谋策：请使用一张锦囊牌，否则受到2点神圣伤害').set('filterCard',function(card,player){
            return get.type(card,'trick')=='trick'&&(lib.filter.cardEnabled(card,player,event.parent.parent)&&lib.filter.cardUsable(card,player,event.parent.parent));
        });
        'step 2'
        if(!result.bool){
            trigger.player.damage(2)._triggered=null;;
        }
    },
            },
            qqwz_谋策3:{
                mod:{
                    targetEnabled:function (card,player,target){
            if(get.type(card)=='delay'){
                return false;
            }
        },
                },
            },
            qqwz_诈曹:{
                trigger:{
                    player:"loseHpEnd",
                },
                forced:true,
                audio:["qqwz诈曹",2],
                content:function (){
        player.draw(3);
        if(_status.currentPhase==player){
            player.addTempSkill('qqwz_诈曹2',{player:'phaseAfter'});
        }
        else{
            game.trySkillAudio('qqwz_诈曹',player);
        }
    },
            },
            qqwz_诈曹2:{
                mod:{
                    targetInRange:function (card,player,target,now){
                    if(card.name=='sha') return true;
                },
                    cardUsable:function (card,player,num){
                    if(card.name=='sha') return num+4;
                },
                },
                trigger:{
                    player:"shaBegin",
                },
                audio:["qqwz诈曹",2],
                forced:true,
                filter:function (event,player){
                return event.card;
            },
                content:function (){
                trigger.directHit=true;
            },
            },
            qqwz_牺牲:{
                audio:["qqwz牺牲",2],
                group:"qqwz_牺牲2",
                enable:"phaseUse",
                usable:1,
                filterCard:true,
                check:function (card){
        return 8-ai.get.value(card);
    },
                position:"he",
                content:function (){
        player.loseHp(2);
    },
                ai:{
                    order:8,
                    result:{
                        player:function (player){
                if(player.hp<=2) return player.num('h')==0?1:0;
                if(player.num('h',{name:'sha',color:'red'})) return 1;
                return player.num('h')<=player.hp?1:0;
            },
                    },
                    effect:function (card,player){
            if(get.tag(card,'damage')){
                if(player.hasSkill('jueqing')) return [1,1];
                return 1.2;
            }
            if(get.tag(card,'loseHp')){
                if(player.hp<=1) return;
                return [0,0];
            }
        },
                },
            },
            qqwz_牺牲2:{
                audio:["qqwz牺牲",2],
                trigger:{
                    player:"loseHp",
                },
                forced:true,
                filter:function (event,player){
return Math.random()<=0.8;
},
                content:function (){
     player.recover();
},
            },
            qqwz_赤焰:{
                audio:["qqwz赤焰",2],
                group:["qqwz_赤焰2","qqwz_赤焰3"],
                trigger:{
                    player:"damageEnd",
                },
                content:function (){
    for(var i=0;i<game.players.length;i++){
        if(game.players[i]!=player){
            game.players[i].damage('fire')._triggered=null;
        };
    };
},
            },
            qqwz_赤焰2:{
                audio:["qqwz赤焰",2],
                trigger:{
                    source:"damageEnd",
                },
                content:function (){
    for(var i=0;i<game.players.length;i++){
        if(game.players[i]!=player){
            game.players[i].damage('fire')._triggered=null;
        };
    };
},
            },
            qqwz_赤焰3:{
                trigger:{
                    player:"damageBefore",
                },
                audio:["qqwz赤焰",2],
                forced:true,
                unique:true,
                filter:function (event){
        return event.nature=='fire';
    },
                content:function (){
        trigger.untrigger();
        trigger.finish();
        player.recover();
    },
                ai:{
                    effect:{
                        target:function (card){
                if(get.tag(card,'fireDamage')){
                    return [0,2];
                }
            },
                    },
                },
            },
            qqwz_雅逊:{
                init:function (player){
        player.storage.qqwz_雅逊2=[];
    },
                group:"qqwz_雅逊3",
                audio:["qqwz雅逊",2],
                trigger:{
                    target:"useCardToBegin",
                    player:"judgeBefore",
                },
                filter:function (event,player){
        if(player.num('h')==0) return false;
        if(event.parent.name=='phaseJudge'){
            if(lib.skill.qqwz_雅逊.trigger.player=='judgeBefore'){
                return true;
            }
            return event.result&&event.result.judge!=0;
        }
        if(event.name=='judge') return false;
        if(event.targets&&event.targets.length>1) return false;
        if(event.card&&get.type(event.card)=='trick'&&event.player!=player) return true;
    },
                content:function (){
        player.storage.qqwz_雅逊2=player.storage.qqwz_雅逊2.concat(player.get('h'));
        game.addVideo('storage',player,['qqwz_雅逊2',get.cardsInfo(player.storage.qqwz_雅逊2),'cards']);
        player.lose(player.get('h'),ui.special);
        player.addSkill('qqwz_雅逊2');
    },
                ai:{
                    effect:function (card,player,target){
            if(!target.hasFriend()) return;
            if(get.type(card,'trick')=='trick'&&ui.selected.targets.length==0) return [1,1];
        },
                },
            },
            qqwz_雅逊2:{
                trigger:{
                    global:"phaseAfter",
                },
                forced:true,
                audio:["qqwz雅逊",2],
                content:function (){
                player.gain(player.storage.qqwz_雅逊2);
                player.removeSkill('qqwz_雅逊2');
                player.storage.qqwz_雅逊2=[];
                game.addVideo('storage',player,['qqwz_雅逊2',get.cardsInfo(player.storage.qqwz_雅逊2),'cards']);
            },
                mark:true,
                intro:{
                    content:"cardCount",
                },
            },
            qqwz_雅逊3:{
                audio:["qqwz雅逊",2],
                trigger:{
                    player:"loseEnd",
                },
                direct:true,
                filter:function (event,player){
        if(player.num('h')) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){
        "step 0"
        var num=0;
        for(var i=0;i<trigger.cards.length;i+=2){
            if(trigger.cards[i].original=='h') num+=2;
        }
        player.chooseTarget('选择发动雅逊的目标',[1,num]).ai=function(target){
            var player=_status.event.player;
            if(player==target) return ai.get.attitude(player,target)+10;
            return ai.get.attitude(player,target);
        }
        "step 1"
        if(result.bool){
            player.logSkill('qqwz_雅逊3',result.targets);
            game.asyncDraw(result.targets,2);
        }
    },
                ai:{
                    threaten:0.8,
                    effect:{
                        target:function (card){
                if(card.name=='guohe'||card.name=='liuxinghuoyu') return 0.5;
            },
                    },
                    noh:true,
                },
            },
            qqwz_妙心:{
                audio:["qqwz妙心",2],
                enable:"phaseUse",
                usable:3,
                discard:false,
                filter:function (event,player){
        return player.num('he',{color:'red'})>0;
    },
                prepare:"throw",
                position:"he",
                filterCard:{
                    color:"red",
                },
                filterTarget:function (card,player,target){
        if(player==target) return false;
        if(target.hasJudge('lebu')) return true;
        return lib.filter.targetEnabled({name:'lebu'},player,target);
    },
                check:function (card){
        return 7-ai.get.value(card);
    },
                content:function (){
        if(target.hasJudge('lebu')){
            target.discard(target.getJudge('lebu'));
        }
        else{
            var next=player.useCard({name:'lebu'},target,cards);
            next.animate=false;
            next.audio=false;
        }
        player.draw();
        player.recover();
    },
                ai:{
                    result:{
                        target:function (player,target){
                if(target.hasJudge('lebu')) return -ai.get.effect(target,{name:'lebu'},player,target);
                return ai.get.effect(target,{name:'lebu'},player,target);
            },
                    },
                    order:9,
                },
            },
            qqwz_娇啸:{
                audio:["qqwz娇啸",2],
                trigger:{
                    target:"shaBefore",
                },
                direct:true,
                priority:5,
                filter:function (event,player){
        if(player.num('he')==0) return false;
        return game.hasPlayer(function(current){
            return current!=event.player&&
                current!=player&&lib.filter.targetEnabled(event.card,event.player,current);
        });
    },
                content:function (){
        "step 0"
        player.draw();
        var next=player.chooseCardTarget({
            position:'he',
            filterCard:lib.filter.cardDiscardable,
            filterTarget:function(card,player,target){
                var trigger=_status.event.getTrigger();
                if(target!=trigger.player&&target!=player){
                    if(player.canUse(trigger.card,target)) return true;
                }
                return false;
            },
            ai1:function(card){
                return ai.get.unuseful(card)+9;
            },
            ai2:function(target){
                if(_status.event.player.num('h','shan')){
                    return -ai.get.attitude(_status.event.player,target);
                }
                if(ai.get.attitude(_status.event.player,target)<5){
                    return 6-ai.get.attitude(_status.event.player,target);
                }
                if(_status.event.player.hp==1&&player.num('h','shan')==0){
                    return 10-ai.get.attitude(_status.event.player,target);
                }
                if(_status.event.player.hp==2&&player.num('h','shan')==0){
                    return 8-ai.get.attitude(_status.event.player,target);
                }
                return -1;
            },
            prompt:get.prompt('qqwz_娇啸')
        });
        "step 1"
        if(result.bool){
            player.discard(result.cards);
            player.logSkill(event.name,result.targets);
            trigger.target=result.targets[0];
            trigger.targets.remove(player);
            trigger.targets.push(result.targets[0]);
        }
        else{
            event.finish();
        }
        "step 2"
        trigger.untrigger();
        trigger.trigger('useCardToBefore');
        trigger.trigger('shaBefore');
        game.delay();
    },
                mod:{
                    globalFrom:function (from,to,distance){
            return distance-999;
        },
                },
                ai:{
                    effect:{
                        target:function (card,player,target){
                if(target.num('he')==0) return;
                if(card.name!='sha') return;
                var min=1;
                var friend=ai.get.attitude(player,target)>0;
                var vcard={name:'shacopy',nature:card.nature,suit:card.suit};
                var players=game.filterPlayer();
                for(var i=0;i<players.length;i++){
                    if(player!=players[i]&&
                        ai.get.attitude(target,players[i])<0&&
                        target.canUse(card,players[i])){
                        if(!friend) return 0;
                        if(ai.get.effect(players[i],vcard,player,player)>0){
                            if(!player.canUse(card,players[0])){
                                return [0,0.1];
                            }
                            min=0;
                        }
                    }
                }
                return min;
            },
                    },
                },
            },
        },
        translate:{
            qqwz_舞月:"舞月",
            qqwz_舞月_info:"结束阶段，你可以摸2张锦囊牌",
            qqwz_离月:"离月",
            qqwz_离月_info:"出牌阶段，你可以弃一张牌，视为一名角色对另一名角色使用一张[决斗]然后你回复1点体力摸一张牌，每阶段限3次",
            qqwz_魔将:"魔将",
            qqwz_魔将_info:"你受到伤害后，你可以令其封印技能1回合，然后你回复1点体力，让其失去1点体力上限，你造成伤害时20%令其直接死亡",
            qqwz_魔将2:"魔将",
            qqwz_魔将2_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_惑心:"惑心",
            qqwz_惑心_info:"你可以说出任何一种基本牌或非延时类锦囊牌，并正面朝下使用或打出一张手牌。体力值不为0的其他角色依次选择是否质疑。若无人质疑，则该牌按你所述之牌结算。若有人质疑则亮出验明：若为真，质疑者各失去2点体力且你摸一张牌；若为假，质疑者各失去1点体力上限且你回复1点体力。无论真假，弃置被质疑的牌。仅当被质疑的牌为红桃花色且为真时，该牌仍然可以进行结算。每当你失去最后一张手牌时可以摸一张牌",
            qqwz_惑心2:"惑心",
            qqwz_惑心2_info:"每当你失去最后一张手牌，可摸一张牌",
            qqwz_雷鸣:"雷鸣",
            qqwz_雷鸣_info:"每当你使用或打出一张【闪】，可令任意一名角色进行一次判定，若结果为红色，其受到2点雷电伤害，然后你回复2点体力；若结果为黑色，其受到4点雷电伤害且你摸3张牌",
            qqwz_天道:"天道",
            qqwz_天道_info:"任意一名角色的判定生效前，你可以打出一张牌替换之",
            qqwz_苍天已死:"苍天已死",
            qqwz_苍天已死_info:"你的回合开始时你可以获得2张闪电，你的回合结束时，你可以获得2张闪，你免疫受到的雷电伤害且摸一张牌",
            qqwz_苍天已死2:"苍天已死",
            qqwz_苍天已死2_info:"受到伤害后，你可以从青钢剑，八卦阵，紫锌中随机获得2张，并失去1点体力",
            qqwz_苍天已死3:"苍天已死",
            qqwz_苍天已死3_info:"锁定技，你防止即将受到的火焰伤害，改为回复1点体力",
            qqwz_虎狼:"虎狼",
            qqwz_虎狼_info:"摸牌阶段，你可以摸3张牌然后改为进行一次判定：你获得此判定牌，且于此回合的出牌阶段，你可以将任意一张与此判定牌不同颜色的手牌当【决斗】使用。你使用决斗可以多结算2次，你使用决斗造成的伤害+2",
            qqwz_虎狼2:"虎狼",
            qqwz_虎狼2_info:"",
            qqwz_虎狼3:"虎狼",
            qqwz_虎狼3_info:"你使用的杀均结算两次，你使用杀无次数限制",
            qqwz_虎狼4:"虎狼",
            qqwz_虎狼4_info:"锁定技，你的【杀】额外造成1点伤害",
            qqwz_箭阵:"箭阵",
            qqwz_箭阵_info:"出牌阶段，你可以将任意两张花色不同的手牌当【万箭齐发】使用并摸2张牌。你使用或打出的万箭齐发造成的伤害+2",
            qqwz_箭阵2:"箭阵",
            qqwz_箭阵2_info:"你使用杀伤害加1",
            qqwz_名门:"名门",
            qqwz_名门_info:"你始终跳过弃牌阶段并可以摸2张牌回复2点体力，你不能被乐不思蜀选做目标",
            qqwz_酗酒:"酗酒",
            qqwz_酗酒_info:"你可将你的任意一张♠手牌当【酒】使用。摸牌阶段你多摸3张牌",
            qqwz_酗酒2:"酗酒",
            qqwz_酗酒2_info:"摸牌阶段，你可以额外摸一张牌",
            qqwz_色欲:"色欲",
            qqwz_色欲_info:"当你对女性角色造成伤害时，其失去1点体力和一点体力上限并翻面，然后你摸2张牌",
            qqwz_掌权:"掌权",
            qqwz_掌权_info:"结束阶段，若你的体力不是全场最少的(或之一)，你须回复2点体力摸1张牌或增加2点体力上限摸1张牌。",
            qqwz_暴凌:"暴凌",
            qqwz_暴凌_info:"你造成的伤害+x（x=你当前的体力）",
            qqwz_绝命:"绝命",
            qqwz_绝命_info:"在你的回合，除你以外，只有处于濒死状态的角色才能使用【桃】。回合结束阶段，你亮出牌堆顶10张牌获得其中的黑色牌",
            qqwz_绝命2:"绝命",
            qqwz_绝命2_info:"",
            qqwz_危局:"危局",
            qqwz_危局_info:"出牌阶段，可令除你外的所有角色依次对与其距离最近的另一名角色使用一张【杀】，无法如此做者失去2点体力。每回合1次，你使用锦囊牌多结算一次效果",
            qqwz_暗幕:"暗幕",
            qqwz_暗幕_info:"当一名其他角色回复体力时，取消结算，延迟类和黑色锦囊无法对你产生效果",
            qqwz_危局2:"危局",
            qqwz_危局2_info:"你使用的基本牌均结算两次<br>75%概率防止你流失体力或受到伤害",
            qqwz_绝命3:"绝命",
            qqwz_绝命3_info:"",
            qqwz_暗幕2:"暗幕",
            qqwz_暗幕2_info:"锁定技，你不能成为延时类锦囊的目标",
            qqwz_万化:"万化",
            qqwz_万化_info:"所有人都展示武将牌后，你随机获得5张未加入游戏的武将牌，选一张置于你面前并声明该武将的一项技能，你拥有该技能且同时将性别和势力属性变成与该武将相同知道该化身被替换。在你的每个准备阶段和结束后，你可以替换化身牌，你须为新的化身重新声明一项技能（你不可声明锁定技、觉醒技或主公技）。",
            qqwz_万化2:"万化",
            qqwz_万化2_info:"",
            qqwz_万化3:"万化",
            qqwz_万化3_info:"",
            qqwz_归魂:"归魂",
            qqwz_归魂_info:"你体力值每次发生变化，可获得2张新化身牌。",
            qqwz_仙道:"仙道",
            qqwz_仙道_info:"锁定技，你在回合结束后随机获得一个势力角色的所有技能，你的红色牌可以当桃使用",
            qqwz_仙道2:"仙道",
            qqwz_仙道2_info:"你可以将一张红色牌当[桃]使用",
            qqwz_离歌:"离歌",
            qqwz_离歌_info:"一名角色每受到伤害，你可以摸一张牌弃一张牌，并令其进行一次判定，判定结果为：♥该角色回复2点体力；♦︎该角色摸3张牌；♣伤害来源弃5张牌；♠伤害来源受到2点体力流失伤害",
            qqwz_月琴:"月琴",
            qqwz_月琴_info:"当你造成1次伤害，你可以令其进行一次判定，判定结果为：♥该角色翻面；♦︎该角色流失1点体力；♣你增加2点体力上限；♠你回复2点体力",
            qqwz_长恨:"长恨",
            qqwz_长恨_info:"锁定技，杀死你的角色失去当前的所有技能直到游戏结束然后其死亡。",
            qqwz_谋诛:"谋诛",
            qqwz_谋诛_info:"出牌阶段你可以多使用2张杀,当你使用【杀】指定一名角色为目标后，其暂时封印技能，你摸2张牌，当你对其造成伤害时若其没有手牌则此伤害+5.你无视其防具",
            qqwz_谋诛2:"谋诛",
            qqwz_谋诛2_info:"",
            qqwz_谋诛3:"谋诛",
            qqwz_谋诛3_info:"",
            qqwz_皇令:"皇令",
            qqwz_皇令_info:"出牌阶段，你可以将所有手牌(至少一张)交给一名其他角色。若如此做，你令该角色与你指定的另一名有手牌的角色拼点。视为拼点赢的角色对没赢的角色使用一张【杀】然后没赢的角色死亡你摸2张牌。每阶段限一次。",
            qqwz_定数:"定数",
            qqwz_定数_info:"当你成为杀的目标时，你摸2张牌此杀对你无效，你受到的伤害最多为1，你始终跳过弃牌阶段，你受到属性伤害时摸2张牌然后此伤害无效",
            qqwz_定数2:"定数",
            qqwz_定数2_info:"你受到的伤害至多为1<br>你始终跳过弃牌阶段",
            qqwz_定数3:"定数",
            qqwz_定数3_info:"你始终跳过弃牌阶段",
            qqwz_定数4:"定数",
            qqwz_定数4_info:"",
            qqwz_谋篡:"谋篡",
            qqwz_谋篡_info:"其他角色的准备阶段，你可以摸2张牌，然后增加1点体力上限，并视为使用1张决斗",
            qqwz_妄尊:"妄尊",
            qqwz_妄尊_info:"摸牌阶段，你多摸x张牌，x=你当前的体力上限，你始终跳过弃牌阶段",
            qqwz_妄尊2:"妄尊",
            qqwz_妄尊2_info:"你始终跳过弃牌阶段",
            qqwz_狮枪:"狮枪",
            qqwz_狮枪_info:"当你使用【杀】指定角色后其处于封印状态，你对于体力值不大于你的角色距离为1，你使用杀可以指定1~4个目标，当你造成伤害后可以回复1点体力获得1张基本牌，你使用或打出的杀不能被闪抵消，你使用杀或决斗造成的伤害+3",
            qqwz_狮枪2:"狮枪",
            qqwz_狮枪2_info:"",
            qqwz_狮枪3:"狮枪",
            qqwz_狮枪3_info:"锁定技，你的【杀】额外造成1点伤害",
            qqwz_升龙:"升龙",
            qqwz_升龙_info:"你可以将[杀]当[闪]，或[闪]当[杀]使用或打出，你的毒可以当桃园结义使用或打出",
            qqwz_飞燕:"飞燕",
            qqwz_飞燕_info:"每当你发动“升龙”使用或打出一张手牌时，你可以立即获得对方的1张手牌。每当你打出1张闪你可以使用一张杀",
            qqwz_飞燕2:"飞燕",
            qqwz_飞燕2_info:"",
            qqwz_飞燕3:"飞燕",
            qqwz_飞燕3_info:"",
            qqwz_飞燕4:"飞燕",
            qqwz_飞燕4_info:"每当你使用或打出一张闪，你可以使用一张杀",
            qqwz_排兵:"排兵",
            qqwz_排兵_info:"当你于出牌阶段内使用【杀】或【决斗】指定目标后，你可以选择一项：1.摸X张牌；2.此牌造成的伤害+X（X为你手牌和装备牌的数量）",
            qqwz_排兵2:"排兵",
            qqwz_排兵2_info:"",
            qqwz_傀儡:"傀儡",
            qqwz_傀儡_info:"出牌阶段，你可以弃置一张牌，若如此做，你指定一名角色，获得其所有手牌装备牌和判定牌然后其死亡。每回合限一次",
            qqwz_驭魂:"驭魂",
            qqwz_驭魂_info:"结束阶段，你可以摸2张牌增加1点体力上限，回复1点体力",
            qqwz_蝎心:"蝎心",
            qqwz_蝎心_info:"其他角色的出牌阶段开始时，你可以弃置一张手牌然后你对其造成2点神圣伤害流失1点体力且本回合该角色无法回复体力。",
            qqwz_蝎心2:"蝎心",
            qqwz_蝎心2_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_乱政:"乱政",
            qqwz_乱政_info:"当你杀死一名角色后，你可于此回合结束后摸三张牌并进行一个额外回合",
            qqwz_乱政2:"乱政",
            qqwz_乱政2_info:"",
            qqwz_狮枪闪:"狮枪",
            qqwz_狮枪闪_info:"你使用或打出的杀无法被闪响应",
            qqwz_舍粮:"舍粮",
            qqwz_舍粮_info:"回合开始和结束阶段，若你的武将牌上没有牌，你可以摸5张牌。若如此做，你将5张牌置于武将牌上，称为“粮”；当“粮”移至其他区域后，若你的武将牌上没有“粮”，你回复体力至体力上限并摸3张牌，你跳过弃牌阶段",
            qqwz_渡世:"渡世",
            qqwz_渡世_info:"当你受到1点伤害后，或其他角色受到你造成的1点伤害后，受到伤害的角色可以获得一张“粮”",
            qqwz_顺道:"顺道",
            qqwz_顺道_info:"出牌阶段，你可以弃置1张'粮'令一名角色摸2张牌",
            qqwz_舍粮2:"舍粮",
            qqwz_舍粮2_info:"",
            qqwz_舍粮3:"舍粮",
            qqwz_舍粮3_info:"你始终跳过弃牌阶段",
            qqwz_计筹:"计筹",
            qqwz_计筹_info:"出牌阶段开始时，你可以弃置任意张装备牌，然后亮出牌堆顶5倍数量的牌，你获得其中的锦囊牌，你不能被延迟类锦囊选中",
            qqwz_星蝶:"星蝶",
            qqwz_星蝶_info:"锁定技，若你的装备区没有防具牌，视为你装备着【八卦阵】；若你的装备区没有坐骑牌，你的手牌上限+x(x=你当前的体力)；若你的装备区没有宝物牌，你使用锦囊牌无距离限制，每当你使用或打出一张非转化非延迟类锦囊牌你可以获得一张锦囊牌",
            qqwz_星蝶2:"星蝶",
            qqwz_星蝶2_info:"每当你使用一张非转化的普通锦囊牌，可以摸一张牌",
            qqwz_将酒:"将酒",
            qqwz_将酒_info:"锁定技，你的【酒】均视为【决斗】",
            qqwz_破敌:"破敌",
            qqwz_破敌_info:"出牌阶段，你可以与一名角色拼点。若你赢，你获得以下技能直到回合结束：无视与该角色的距离；无视防具且可使用任意数量的【杀】且你使用杀不可被闪抵消且伤害+2。若你没赢，你本回合使用杀造成伤害后其死亡。每回合限一次",
            qqwz_破敌2:"破敌",
            qqwz_破敌2_info:"",
            qqwz_破敌3:"破敌",
            qqwz_破敌3_info:"当你用杀造成伤害后，其死亡",
            qqwz_破敌4:"破敌",
            qqwz_破敌4_info:"",
            qqwz_破敌5:"破敌",
            qqwz_破敌5_info:"锁定技，你的【杀】额外造成1点伤害",
            qqwz_篱下:"篱下",
            qqwz_篱下_info:"锁定技，当一名其他角色成为基本牌或普通锦囊牌的目标时，若其与你的距离为1且你既不是此牌的使用者也不是目标，你也成为此牌的目标",
            qqwz_散财:"散财",
            qqwz_散财_info:"锁定技，当你对区域里有牌的其他角色造成伤害后，你获得其手牌、装备区里的各2张牌",
            qqwz_策定:"策定",
            qqwz_策定_info:"出牌阶段，你可以交给任一其他角色一张装备牌或【杀】或1张基本牌，该角色进行二选一：1. 视为对其攻击范围内的另一名由你指定的角色使用一张【杀】和决斗。2. 摸2张牌。每回合限一次。",
            qqwz_殉道:"殉道",
            qqwz_殉道_info:"锁定技，你的回合外，你每受到一次伤害，任何伤害对你无效，直到该回合结束。",
            qqwz_殉道2:"殉道",
            qqwz_殉道2_info:"",
            qqwz_殉道3:"殉道",
            qqwz_殉道3_info:"你免疫体力流失伤害",
            qqwz_殉道4:"殉道",
            qqwz_殉道4_info:"你免疫体力流失伤害",
            qqwz_繁华:"繁华",
            qqwz_繁华_info:"摸牌阶段摸牌时，你可以额外摸3张牌若如此做，你本回合每次使用基本牌都可以获得一张锦囊牌",
            qqwz_繁华2:"繁华",
            qqwz_繁华2_info:"",
            qqwz_汉室:"汉室",
            qqwz_汉室_info:"弃牌阶段,你增加1点体力上限然后跳过弃牌阶段，其他角色与你计算距离始终+2，出牌阶段你可以用2张花色相同的手牌当桃使用(每回合限2次)",
            qqwz_汉室2:"汉室",
            qqwz_汉室2_info:"出牌阶段，你可以将两张花色一样的牌当桃使用，每回合限2次",
            qqwz_威视:"威视",
            qqwz_威视_info:"一名其他角色的准备阶段，你可以与该角色拼点，若你赢，该角色本回合使用的牌不能指定除该角色外的角色为目标,且此人每使用一张牌30%流失1点体力",
            qqwz_威视2:"威视",
            qqwz_威视2_info:"",
            qqwz_牵连:"牵连",
            qqwz_牵连_info:"当你成为【杀】的目标时，你可以令另1~3名其他角色选择一项：①、交给你一张【闪】；②、成为此【杀】的额外目标然后你回复1点体力。",
            qqwz_抵命:"抵命",
            qqwz_抵命_info:"锁定技，你的【桃】均视为【过河拆桥】",
            qqwz_毒谋:"毒谋",
            qqwz_毒谋_info:"结束阶段开始时，你可以对没有手牌的1~5名角色造成2点体力流失伤害",
            qqwz_火牢:"火牢",
            qqwz_火牢_info:"限定技。出牌阶段，你可以令所有其他角色各选择一项：弃置至少X张牌(X为该角色的上家以此法弃置牌的数量+2)；或受到你对其造成的4点火焰伤害",
            qqwz_火刑:"火刑",
            qqwz_火刑_info:"其他角色失去或使用牌后，你可以令其受到2点神圣火焰伤害，每回合限2次",
            qqwz_破计:"破计",
            qqwz_破计_info:"锁定技，你使用的普通锦囊牌不能被无懈可击响应；你不能成为其他角色的延时类锦囊的目标且回合结束你摸2张牌",
            qqwz_诛族:"诛族",
            qqwz_诛族_info:"出牌阶段限2次，你可以展示一张锦囊牌并将之置于牌堆顶，然后令有手牌的一名其他角色选择一项：弃置3张锦囊牌；或弃置2张非锦囊牌",
            qqwz_去病:"去病",
            qqwz_去病_info:"出牌阶段，你可以弃置一张手牌令一名角色受到2点神圣伤害，每阶段限一次，你每次受到伤害时回复1点体力",
            qqwz_医心:"医心",
            qqwz_医心_info:"回合外，你可以将一张红色牌当[桃]使用，当你回复体力时，你的体力=你的体力上限",
            qqwz_医心2:"医心",
            qqwz_医心2_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_去病2:"去病",
            qqwz_去病2_info:"你死亡时，可以令一名其他角色（杀死你的角色除外）摸三张牌，然后令其回复1点体力。",
            qqwz_缓图:"缓图",
            qqwz_缓图_info:"你使用或打出一张牌后50%摸一张牌回复1点体力，你使用或打出基本牌40%外执行1次效果",
            qqwz_缓图2:"缓图",
            qqwz_缓图2_info:"你使用的基本牌均结算两次<br>75%概率防止你流失体力或受到伤害",
            qqwz_鸿鹄:"鸿鹄",
            qqwz_鸿鹄_info:"锁定技，每当你受到一次伤害，你可以摸1张牌回复1点体力，当一名角色的牌因弃置而置入弃牌堆时，你可以将其中的任意张牌交给其他角色",
            qqwz_鸿鹄2:"鸿鹄",
            qqwz_鸿鹄2_info:"当其他角色的牌因弃置而置入弃牌堆时，你可以将其中的任意张牌交给其他角色",
            qqwz_隔墙:"隔墙",
            qqwz_隔墙_info:"一名其他角色的结束阶段，你可以选择一项：将其装备区里的1张牌移动至你装备区里的相应位置（可替换原装备）并令其翻面；或摸2张牌。",
            qqwz_投曹:"投曹",
            qqwz_投曹_info:"限定技。出牌阶段，你可以将装备区里的所有牌交给一名其他角色，然后该角色选择一项：令你回复X点体力并摸X张牌;或对其攻击范围内的X名角色各造成2点伤害(X为你以此法交给该角色的牌的数量)。",
            qqwz_罪业:"罪业",
            qqwz_罪业_info:"出牌阶段限一次，你可以展示所有手牌，若其中包含不止一种颜色，则你选择一种颜色并弃置该颜色的所有手牌，然后你可以获得至多X名角色的各2张牌（X为你以此法弃置的手牌数）。若你以此法获得的牌不少于5张，则你失去1点体力上限，你不会被翻面且免疫体力流失伤害",
            qqwz_罪业2:"罪业",
            qqwz_罪业2_info:"你始终跳过弃牌阶段",
            qqwz_罪业3:"罪业",
            qqwz_罪业3_info:"你免疫体力流失伤害",
            qqwz_推卸:"推卸",
            qqwz_推卸_info:"当你收到伤害时，你可以令一名角色摸2张牌，然后你摸一张牌加1点体力上限取消本次伤害",
            qqwz_谗言:"谗言",
            qqwz_谗言_info:"出牌阶段开始时，你可以摸3张牌。若如此做，此回合你的手牌上限改为X(X为你此阶段造成的伤害数)且本回合你每次造成伤害可以摸一张牌",
            qqwz_谗言2:"谗言",
            qqwz_谗言2_info:"",
            qqwz_乱国:"乱国",
            qqwz_乱国_info:"出牌阶段，你可以视为使用或打出1张【机关.锦囊.延迟锦囊.基本.食物】牌，每种牌限2次，其他角色回合开始时，你进行一个额外回合",
            qqwz_乱国锦囊:"乱国",
            qqwz_乱国锦囊_info:"",
            qqwz_乱国基本:"乱国",
            qqwz_乱国基本_info:"",
            qqwz_乱国机关:"乱国",
            qqwz_乱国机关_info:"",
            qqwz_乱国延迟锦囊:"乱国",
            qqwz_乱国延迟锦囊_info:"",
            qqwz_乱国回合:"乱国",
            qqwz_乱国回合_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_并起:"并起",
            qqwz_并起_info:"出牌阶段，你可以指定1~4名除你之外的角色，令这些角色各摸4张牌，每选定一名角色你摸2张牌回复3点体力",
            qqwz_让梨:"让梨",
            qqwz_让梨_info:"摸牌阶段，你可以额外摸3张牌，你始终跳过弃牌阶段",
            qqwz_儒门:"儒门",
            qqwz_儒门_info:"当你即将受到伤害时，若伤害来源的体力值小于你，则此伤害=0",
            qqwz_让梨2:"让梨",
            qqwz_让梨2_info:"你始终跳过弃牌阶段",
            qqwz_秉忠:"秉忠",
            qqwz_秉忠_info:"当你因弃置失去一张手牌时，你可以弃置1名其他角色的2张牌。",
            qqwz_孤援:"孤援",
            qqwz_孤援_info:"当一名角色受到伤害时，你可以令一名角色摸1张牌然后你回复2点体力",
            qqwz_妖艳:"妖艳",
            qqwz_妖艳_info:"锁定技，准备阶段，你令所有其他角色的非锁定技失效直到回合结束，当你收到伤害时若次伤害来源为男性角色则取消本次伤害并令其失去1点体力",
            qqwz_醉魂:"醉魂",
            qqwz_醉魂_info:"出牌阶段，你可以弃置一张装备牌，然后令一名角色翻面并摸1张牌然后你摸一张牌",
            qqwz_妖艳2:"妖艳",
            qqwz_妖艳2_info:"你对女性角色、女性角色对你使用【杀】时，都需连续使用两张【闪】才能抵消。",
            qqwz_战神:"战神",
            qqwz_战神_info:"锁定技,你的闪可以当杀使用或打出，你使用的[决斗]需要2张[杀]响应,回合结束若你本回合造成的伤害大于或等于4则你可以选择一名角色令其受到4点神圣伤害，你使用或打出杀不能被闪抵消，你受到的伤害最多为1，你免疫致死，你无视其防具",
            qqwz_战神决斗:"战神",
            qqwz_战神决斗_info:"",
            qqwz_战神闪杀:"战神",
            qqwz_战神闪杀_info:"",
            qqwz_战神伤害:"战神",
            qqwz_战神伤害_info:"",
            qqwz_战神绝境:"战神",
            qqwz_战神绝境_info:"你受到的伤害至多为1<br>你始终跳过弃牌阶段",
            qqwz_战神免致死:"战神",
            qqwz_战神免致死_info:"",
            qqwz_无前:"无前",
            qqwz_无前_info:"锁定技.你造成伤害后可以获得1张决斗，你使用决斗造成伤害70%令其死亡，一名角色获得牌时你60%摸一张牌，回合开始阶段你增加x点护甲(x=你装备区里的牌数)当一名其他角色受到伤害时你的体力+1",
            qqwz_无前2:"无前",
            qqwz_无前2_info:"你使用的杀均结算两次，你使用杀无次数限制",
            qqwz_无前3:"无前",
            qqwz_无前3_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_无前4:"无前",
            qqwz_无前4_info:"日轮啊，化作甲胄，游戏开始前，你获得∞点护甲，你的体力不会流失，体力上限不会被扣除，你不会被即死",
            qqwz_无前5:"无前",
            qqwz_无前5_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_战神无视防具:"战神",
            qqwz_战神无视防具_info:"",
            qqwz_进击:"进击",
            qqwz_进击_info:"每当你使用【杀】对一名角色造成伤害后，你可以弃置该角色装备区里的一张牌，若此牌是坐骑牌，你于此牌置入弃牌堆时获得之。你的出牌阶段，你计算与其他角色距离始终为1，且使用杀可以额外指定6个目标",
            qqwz_进击2:"进击",
            qqwz_进击2_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_进击3:"进击",
            qqwz_进击3_info:"",
            qqwz_白马:"白马",
            qqwz_白马_info:"锁定技，只要你的体力值大于6点，你的进攻距离+2；只要你的体力值为4点或更低，你的防御距离+3，回合结束，直到你的回合开始你不能成为他们使用卡牌的目标且其他角色每使用1张装备牌你可以摸2张牌",
            qqwz_白马2:"白马",
            qqwz_白马2_info:"",
            qqwz_英雄:"英雄",
            qqwz_英雄_info:"你的准备阶段开始时，场上的吴国角色摸2张牌，你的结束阶段，全场魏国势受到2点神圣火焰伤害，当你被翻面时，全场群雄势力翻面",
            qqwz_英雄2:"英雄",
            qqwz_英雄2_info:"准备阶段，场上的吴国角色摸一张牌",
            qqwz_英雄3:"英雄",
            qqwz_英雄3_info:"准备阶段，场上的吴国角色摸一张牌",
            qqwz_急援:"急援",
            qqwz_急援_info:"主公技，锁定技，濒死阶段，吴势力角色对你使用的[桃]额外回复2点体力并你摸2张牌，当你受到伤害时若此伤害来源是吴势力则取消本次伤害，改为回复2点体力摸1张牌",
            qqwz_急援2:"急援",
            qqwz_急援2_info:"主公技，锁定技，濒死阶段，吴势力角色对你使用的[桃]额外回复一点体力",
            qqwz_权衡:"权衡",
            qqwz_权衡_info:"出牌阶段，你可以弃置任意张牌并摸等量X2的牌，每回合限3次你的手牌上限=你当前的体力上限",
            qqwz_权衡2:"权衡",
            qqwz_权衡2_info:"锁定技，摸牌阶段摸牌时，你额外摸一张牌；你的手牌上限不会因体力值的减少而减少。",
            qqwz_踏浪:"踏浪",
            qqwz_踏浪_info:"你可以将一张牌当[过河拆桥]使用，你不能被过河拆桥和乐不思蜀选做目标，你受到伤害时若手牌不等于0则取消本次伤害，你造成伤害时若其手牌=0则其失去3点体力上限",
            qqwz_踏浪2:"踏浪",
            qqwz_踏浪2_info:"锁定技，你不能成为[顺手牵羊]和[乐不思蜀]的目标",
            qqwz_踏浪3:"踏浪",
            qqwz_踏浪3_info:"你使用的基本牌均结算两次<br>75%概率防止你流失体力或受到伤害",
            qqwz_踏浪4:"踏浪",
            qqwz_踏浪4_info:"",
            qqwz_雄发:"雄发",
            qqwz_雄发_info:"摸牌阶段，你可以额外摸X张牌(X=你当前的体力上限)，你计算与其其他角色距离始终-3",
            qqwz_揣测:"揣测",
            qqwz_揣测_info:"出牌阶段，你可以令1名角色选择一种花色并展示你的一张手牌，若选择的花色与展示的不同，该角色受到来自你的2点神圣伤害。结算结束后该角色获得展示的牌。每阶段限3次",
            qqwz_焦凤:"焦凤",
            qqwz_焦凤_info:"你可以将一张红色的手牌当[乐不思蜀]使用，锁定技，每当你使用或打出一张红色牌，你摸一张牌然后你的手牌上限便+1，直到你的回合结束",
            qqwz_焦凤2:"焦凤",
            qqwz_焦凤2_info:"锁定技，每当你使用或打出一张红色牌，你的手牌上限便+1，直到你的回合结束",
            qqwz_流年:"流年",
            qqwz_流年_info:"你不能成为【杀】和【乐不思蜀】的目标，当你受到伤害后，你可以弃置一张牌回复1点体力",
            qqwz_鸳鸯:"鸳鸯",
            qqwz_鸳鸯_info:"出牌阶段，你可以弃置1张牌并选择1名已经受伤的男性角色，你回复1点体力且本回合可以多使用2张杀，其回复2点体力并增加1点体力上限摸2张牌，每阶段限一次",
            qqwz_影剑2:"影剑",
            qqwz_影剑2_info:"锁定技，每当一名其他角色使用一张基本牌或锦囊牌，你获得一张与之同名的牌",
            qqwz_影剑:"影剑",
            qqwz_影剑_info:"每当你失去一张装备牌，可以摸两张牌，其他角色使用装备牌时你可以随机将一件装备牌置于你的装备区，你可以无限装备武器牌",
            qqwz_影剑3:"影剑",
            qqwz_影剑3_info:"",
            qqwz_鸳鸯2:"鸳鸯",
            qqwz_鸳鸯2_info:"",
            qqwz_绿荫:"绿荫",
            qqwz_绿荫_info:"锁定技，你的红桃牌均视为【无中生有】",
            qqwz_花落:"花落",
            qqwz_花落_info:"当你收到伤害时，本次伤害无效并反弹目标本次伤害的神圣伤害，你的黑桃牌均视为红桃牌",
            qqwz_花落2:"花落",
            qqwz_花落2_info:"锁定技，你的黑桃牌均视为红桃",
            qqwz_铁壁:"铁壁",
            qqwz_铁壁_info:"每当一名角色的手牌于回合外被弃置时，你可以受到1点伤害，然后该角色摸3张牌你摸一张牌。",
            qqwz_冷血:"冷血",
            qqwz_冷血_info:"锁定技，在你死亡前，若你的体力值不大于0，亮出牌堆顶的一张牌并置于你的武将牌上，若此牌的点数与你武将牌上已有的牌点数均不同，则你的当前体力=你的原始体力上限。只要你的武将牌上有牌，你的手牌上限便与这些牌数量相等",
            qqwz_奋命:"奋命",
            qqwz_奋命_info:"当一名角色受到伤害时若其是吴王光耀则取消伤害，然后你受到2点伤害",
            qqwz_烈士:"烈士",
            qqwz_烈士_info:"出牌阶段，你可以和一名角色拼点，若你赢，你获得以下技能直到回合结束：攻击范围无限；可额外使用一张【杀】；使用【杀】时可额外指定1~7个目标，若你没赢，你摸2张牌。每回合限一次。",
            qqwz_烈士2:"烈士",
            qqwz_烈士2_info:"",
            qqwz_酣战:"酣战",
            qqwz_酣战_info:"你造成伤害时，取消本次伤害令其失去1点体力上限和1点体力",
            qqwz_睥睨:"睥睨",
            qqwz_睥睨_info:"回合开始阶段,你可以召唤\"吴王光耀\",\"策马扬鞭\",\"笃烈之士\",\"豪饮鲸吞\"上场，然后你失去此技能",
            qqwz_魂佑:"魂佑",
            qqwz_魂佑_info:"你的回合结束阶段，场上的吴国角色摸2张牌,魏国角色受到2点伤害",
            qqwz_虎踞:"虎踞",
            qqwz_虎踞_info:"摸牌阶段，你可以额外摸2张牌，你计算与其他角色距离始终-2",
            qqwz_军霸2:"军霸",
            qqwz_军霸2_info:"你受到的伤害始终为1，你不能被延迟类锦囊牌选中，你始终跳过弃牌阶段",
            qqwz_军霸3:"军霸",
            qqwz_军霸3_info:"",
            qqwz_转日:"转日",
            qqwz_转日_info:"每当你使用（指定目标后）或被使用（成为目标后）一张【决斗】或【杀】时，你可以摸一张牌回复1点体力。当你受到决斗造成的伤害时取消之并摸一张牌",
            qqwz_转日2:"转日",
            qqwz_转日2_info:"当你用杀造成伤害后，其死亡",
            qqwz_卧虎:"卧虎",
            qqwz_卧虎_info:"觉醒技，准备阶段，若你的体力不等于你的手牌，你须流失3点体力，并永久获得技能“虎踞”和“庇佑”。",
            qqwz_庇佑:"庇佑",
            qqwz_庇佑_info:"准备阶段开始时，若你已受伤，你可令1~2名其他角色执行一项：摸X张牌增加X点护甲，然后弃置一张牌；或受到X点伤害，然后弃置X张牌（X为你已损失的体力值，若你装备区里牌的数量不小于你的体力值，则X改为你的体力上限）",
            qqwz_联盟:"联盟",
            qqwz_联盟_info:"出牌阶段，你可以令一名角色获得你的全部手牌，然后你摸2张牌，每回合1次，回合结束你可以摸3张牌",
            qqwz_联盟2:"联盟",
            qqwz_联盟2_info:"结束阶段，你可以摸一张牌",
            qqwz_人杰:"人杰",
            qqwz_人杰_info:"锁定技，你的回合内，其他角色的手牌对你可见；每当你造成或受到伤害时，你可以置换任意两名角色的手牌",
            qqwz_人杰2:"人杰",
            qqwz_人杰2_info:"",
            qqwz_施财:"施财",
            qqwz_施财_info:"摸牌阶段，你可以额外摸4张牌，若此时你的手牌数多于8张，你必须将一半(向下取整)的手牌交给场上除你外手牌数最少的一名角色。",
            qqwz_施财2:"施财",
            qqwz_施财2_info:"",
            qqwz_明谏:"明谏",
            qqwz_明谏_info:"出牌阶段，你可以将你手牌中的一张装备牌置于一名其他角色装备区里，然后摸一张牌。(其可以无限装备)",
            qqwz_暗谏:"暗谏",
            qqwz_暗谏_info:"",
            qqwz_修政:"修政",
            qqwz_修政_info:"其他角色的弃牌阶段结束时，你可将其弃置的一张牌返回其手牌，然后获得其弃置的其它牌",
            qqwz_魂佑2:"魂佑",
            qqwz_魂佑2_info:"准备阶段，场上的吴国角色摸一张牌",
            qqwz_芙蓉:"芙蓉",
            qqwz_芙蓉_info:"弃牌阶段开始时，你可以将一张与你本回合使用的牌颜色均不同的手牌置于武将牌上：若你有至少2张“芙蓉”牌，你移去“芙蓉”牌并选择一名男性角色，该角色受到4点神圣伤害并弃置其装备区的所有牌",
            qqwz_沉鱼:"沉鱼",
            qqwz_沉鱼_info:"回合结束阶段获得技能“花落”和“流年”直到你的回合开始。",
            qqwz_狂傲:"狂傲",
            qqwz_狂傲_info:"当你于回合外需要使用或打出一张基本牌时，你可以观看牌堆顶的十张牌。若你观看的牌中有此牌，你可以使用打出之。",
            qqwz_杀令:"杀令",
            qqwz_杀令_info:"你可以将基本牌当作任意基本牌使用或打出",
            qqwz_杀令2:"杀令",
            qqwz_杀令2_info:"",
            qqwz_举国:"举国",
            qqwz_举国_info:"出牌阶段，你可以弃置1张牌对你攻击范围内的一名其他角色造成1点神圣伤害。每回合限5次",
            qqwz_合纵:"合纵",
            qqwz_合纵_info:"摸牌阶段摸牌时，你可以少摸一张牌，然后指定至多三名其他角色各摸一张牌。",
            qqwz_连横:"连横",
            qqwz_连横_info:"一名角色的判定牌生效前，你可令其观看你的手牌。若如此做，该角色选择你的一张牌，令你打出此牌代替之然后你可以摸2张牌。",
            qqwz_料敌:"料敌",
            qqwz_料敌_info:"每当你因使用、打出或弃置而失去一张牌时，你可以摸一张牌回复2点体力。",
            qqwz_致死:"致死",
            qqwz_致死_info:"锁定技，准备阶段，你选择一项：1.移去“引敌”牌，将手牌补至体力上限数；2.将“引敌”牌交给一名体力值不大于你的其他角色，其回复3点体力，摸等量的牌",
            qqwz_引敌:"引敌",
            qqwz_引敌_info:"结束阶段开始时，你可以将至少一张牌置于武将牌上",
            qqwz_冷兵:"冷兵",
            qqwz_冷兵_info:"你使用【杀】可以多选择1名距离为1的角色为目标，触发此效果你可以摸2张牌",
            qqwz_迅疾:"迅疾",
            qqwz_迅疾_info:"出牌阶段限一次，你可以弃置一张牌并选择一名其他角色，然后本回合你计算与其的距离视为1然后其失去1点体力上限",
            qqwz_迅疾2:"迅疾",
            qqwz_迅疾2_info:"",
            qqwz_年华:"年华",
            qqwz_年华_info:"一名其他角色的出牌阶段开始时，若你不在其攻击范围内，你可以令该角色的锦囊牌均视为【毒】，直到该角色以此法使用了一张【毒】或回合结束。若如此做，则直到回合结束，视为你在其攻击范围内",
            qqwz_朝露:"朝露",
            qqwz_朝露_info:"出牌阶段限一次，你可以弃置一张基本牌，然后选择一项：弃置场上一张武器牌，然后你回复2点体力并获得其弃置的武器牌；或将场上的一张防具牌移动到你的装备区里（可替换原防具）",
            qqwz_残戮:"残戮",
            qqwz_残戮_info:"摸牌阶段开始时，你可以放弃摸牌，改为摸x张牌回复x点体力（x为已受伤的角色数量)",
            qqwz_血仇:"血仇",
            qqwz_血仇_info:"当你受到伤害时，若你没有手牌，则此伤害=0",
            qqwz_丧命:"丧命",
            qqwz_丧命_info:"出牌阶段限1次，你可以展示所有手牌，若黑色牌不少于红色牌，则视为你使用了一张【桃】",
            qqwz_凌风:"凌风",
            qqwz_凌风_info:"当你失去牌时,你可以依次弃置一至两名其他角色的共计两张牌。每回合限5次",
            qqwz_御风:"御风",
            qqwz_御风_info:"每当你失去一次装备区里的牌时，你可以执行下列两项中的一项：1.视为对任意一名其他角色使用一张【杀】（此【杀】不计入每回合的使用限制）；2.对与你距离1以内的一名其他角色造成2点伤害",
            qqwz_携手:"携手",
            qqwz_携手_info:"出牌阶段，你可以选择两名角色，交换他们装备区里的所有牌。以此法交换的装备数差不能超过X(X为你当前的体力上限)。每回合限2次。",
            qqwz_招亲:"招亲",
            qqwz_招亲_info:"当有角色进入濒死状态时，你可以展示该角色的一张手牌：若此牌不为食物牌，则该角色弃掉这张牌并回复全部体力。",
            qqwz_镇军:"镇军",
            qqwz_镇军_info:"当你于出牌阶段内使用【杀】指定一个目标后，你可以将其至多X张牌扣置于该角色的武将牌旁（X为其体力值*2）。若如此做，你本回合造成伤害时若其没有手牌则受到伤害+2",
            qqwz_镇军血:"镇军",
            qqwz_镇军血_info:"",
            qqwz_定心:"定心",
            qqwz_定心_info:"出牌阶段限2次，你可以选择两名手牌数不同的其他角色，令其中手牌多的角色将1张手牌交给手牌少的角色，然后若这两名角色手牌数不相等，你摸2张牌或回复3点体力",
            qqwz_魂忆:"魂忆",
            qqwz_魂忆_info:"你死亡时，可以令一名其他角色（杀死你的角色除外）摸5张牌，然后令其回复全部体力。",
            qqwz_佳酿:"佳酿",
            qqwz_佳酿_info:"结束阶段开始时，若没有“佳酿”，你可以将至少一张手牌置于你的武将牌上，称为“佳酿”。当一名角色处于濒死状态时，你可以移去一张“佳酿”，视为该角色使用一张【酒】",
            qqwz_佳酿2:"佳酿",
            qqwz_佳酿2_info:"",
            qqwz_烈火:"烈火",
            qqwz_烈火_info:"你收到伤害后对其反弹2点神圣火焰伤害，你免疫受到的火焰伤害",
            qqwz_烈火2:"烈火",
            qqwz_烈火2_info:"你可以立即获得对你造成伤害的牌",
            qqwz_弓彰:"弓彰",
            qqwz_弓彰_info:"出牌阶段，你可以弃置一张牌，令你的攻击范围无限且出杀不能被闪抵消，直到回合结束，然后若你以此法弃置的牌为装备牌，你可以弃置一名其他角色的2张牌然后你摸2张牌。每回合限一次。",
            qqwz_弓彰2:"弓彰",
            qqwz_弓彰2_info:"",
            qqwz_直入:"直入",
            qqwz_直入_info:"限定技，出牌阶段，你可以选择一名角色，令攻击范围内含有该角色的所有角色各选择一项：1.弃置一张武器牌；2.令其摸2张牌回复1点体力。",
            qqwz_毒箭:"毒箭",
            qqwz_毒箭_info:"当你对目标角色造成伤害时，若你不在其攻击范围内，则此伤害+2",
            qqwz_缴械:"缴械",
            qqwz_缴械_info:"每当你受到杀造成的一次伤害后，你可以弃置一张牌，然后获得伤害来源装备区里的全部牌",
            qqwz_亡箭:"亡箭",
            qqwz_亡箭_info:"每当你失去一张装备牌，可以回复2点体力",
            qqwz_擒拿:"擒拿",
            qqwz_擒拿_info:"当一名其他角色回复体力时，你令其失去下一个回合",
            qqwz_矜持:"矜持",
            qqwz_矜持_info:"每当你受到一名男性角色造成的伤害时，你可以弃置一张非装备牌，令此伤害-2。",
            qqwz_毁誉:"毁誉",
            qqwz_毁誉_info:"出牌阶段，当你使用【杀】或普通锦囊牌指定唯一目标时，你可令可以成为此牌目标的另一名其他角色选择一项：交给你一张牌并成为此牌的使用者;或成为此牌的额外目标。",
            qqwz_耿直:"耿直",
            qqwz_耿直_info:"结束阶段，你可以令一名角色摸一张并展示之，若是装备牌，其立即装备之并回复一点体力，若是锦囊牌则摸3张牌，若是基本牌则增加1点体力上限，若是机关牌则受到1点伤害",
            qqwz_妙玄:"妙玄",
            qqwz_妙玄_info:"每当你的牌被弃置，你摸一张牌然后可以将其按任意顺序置于牌堆顶",
            qqwz_诱饵:"诱饵",
            qqwz_诱饵_info:"结束阶段和回合开始时，你可以令一名其他角色弃置你的一张牌，若此牌不为【杀】，你获得该角色的2张牌并回复2点体力。",
            qqwz_秉正:"秉正",
            qqwz_秉正_info:"结束阶段和回合开始时，你可以展示所有手牌，若均为同一颜色，则你令至多X名角色各摸1张牌(X为你的手牌数)。",
            qqwz_慎重:"慎重",
            qqwz_慎重_info:"出牌阶段，你可以弃置两张牌，然后摸一张牌回复1体力增加1点体力上限。",
            qqwz_安邦:"安邦",
            qqwz_安邦_info:"出牌阶段限2次，你可以选择一名其他角色装备区里的一张牌，令其将此牌收回手牌。然后若该角色攻击范围内的角色数因此减少，则你摸2张牌回复2点体力",
            qqwz_相助:"相助",
            qqwz_相助_info:"当你造成或受到伤害后，你可以选择一项：1. 弃置手牌数大于你的一名角色的一张手牌；2. 令手牌数小于你的一名角色摸2张牌",
            qqwz_阵邀:"阵邀",
            qqwz_阵邀_info:"每回合限一次，每当你需要使用或打出一张基本牌时，你可以与一名手牌数少于你的角色交换手牌。若如此做，视为你使用或打出了此牌",
            qqwz_阵邀_sha:"阵邀",
            qqwz_阵邀_sha_info:"",
            qqwz_阵邀_tao:"阵邀",
            qqwz_阵邀_tao_info:"",
            qqwz_阵邀_jiu:"阵邀",
            qqwz_阵邀_jiu_info:"",
            qqwz_善学:"善学",
            qqwz_善学_info:"结束阶段开始时，你可以令至多X名角色依次摸2张牌并将一张牌置于牌堆顶（X为你的体力值）；若你已失去技能“鸿宴”，则将X改为你的体力上限",
            qqwz_鸿宴:"鸿宴",
            qqwz_鸿宴_info:"出牌阶段限一次，你可以令一名有牌的其他角色选择一项：令你获得其装备区里所有的牌，然后你失去技能“鸿宴”，直到游戏结束；或弃置3张牌",
            qqwz_王召:"王召",
            qqwz_王召_info:"主公技，锁定技，你距离为1的角色视为在其他吴势力角色的攻击范围内",
            qqwz_王召2:"王召",
            qqwz_王召2_info:"",
            qqwz_善民:"善民",
            qqwz_善民_info:"出牌阶段限一次，你可以选择一名有牌的其他角色，该角色将其一至九张牌置于你的武将牌上。若如此做，你的下准备阶段，你获得武将牌上的所有牌，然后其摸等量的牌",
            qqwz_奢豪:"奢豪",
            qqwz_奢豪_info:"出牌阶段，若你的手牌上限大于0，你可以摸一张牌，然后你本回合的手牌上限-1。结束阶段开始时，若你没有手牌，则你可以横置至多X名角色的武将牌（X为你的体力值上限）然后你可以摸4张牌",
            qqwz_奢豪2:"奢豪",
            qqwz_奢豪2_info:"",
            qqwz_奢豪3:"奢豪",
            qqwz_奢豪3_info:"",
            qqwz_罪责:"罪责",
            qqwz_罪责_info:"锁定技，当你受到火焰伤害时，若你处于“连环状态”且你是传导伤害的起点，则此伤害+2",
            qqwz_掌控:"掌控",
            qqwz_掌控_info:"结束阶段，你获得其他角色本回合失去的牌",
            qqwz_掌控2:"掌控",
            qqwz_掌控2_info:"",
            qqwz_伺机:"伺机",
            qqwz_伺机_info:"你每次,打出或失去牌时，全场的吴国武将摸一张牌，全场魏国武将失去1点体力,全场蜀国武将回复1点体力,全场群雄武将失去1点体力上限，你始终跳过弃牌阶段",
            qqwz_白衣:"白衣",
            qqwz_白衣_info:"觉醒技，准备阶段开始时，若你的手牌数比体力值多3（人数不少于7时改为2）或更多，你须减2点体力上限回复全部体力并获得技能【掌控】",
            qqwz_伺机2:"伺机",
            qqwz_伺机2_info:"你始终跳过弃牌阶段",
            qqwz_锦帆:"锦帆",
            qqwz_锦帆_info:"当一名角色使用的锦囊牌指定了至少两名角色为目标时，你可以令此牌对其中任意名角色无效。你不能被延迟类锦囊选中",
            qqwz_合围:"合围",
            qqwz_合围_info:"你造成非神圣伤害时若其手牌=0则其死亡，你使用或打出基本牌50%额外结算1次，出牌阶段，你可以弃置2张牌视为对全体造成1点神圣伤害然后回复全部体力(限一次)",
            qqwz_合围2:"合围",
            qqwz_合围2_info:"当一名其他角色回复体力时，50%概率终止回复结算，然后你回复一点体力",
            qqwz_合围3:"合围",
            qqwz_合围3_info:"出牌阶段，你可以弃置两张牌，然后摸一张牌。",
            qqwz_霸业:"霸业",
            qqwz_霸业_info:"锁定技，摸牌阶段摸牌时，你额外摸3张牌；你的手牌上限不会因体力值的减少而减少。你造成伤害时，若场上角色装备区内有防具牌，令该名角色也受到等量伤害。",
            qqwz_霸业2:"霸业",
            qqwz_霸业2_info:"",
            qqwz_控局:"控局",
            qqwz_控局_info:"出牌阶段限2次，你可以展示一张手牌并将此牌交给一名其他角色。然后该角色选择一项：展示其手牌并弃置所有与此牌花色相同的牌，或失去2点体力。",
            qqwz_谋策:"谋策",
            qqwz_谋策_info:"每当你于出牌阶段外成为其他角色使用牌的目标后，若你的体力值不为1，你可以立即摸3张牌并可使用1张牌，其他角色回合结束阶段须交给你一张牌，然后使用一张锦囊牌，或受到2点神圣伤害。你不能被延迟类锦囊选中",
            qqwz_谋策2:"谋策",
            qqwz_谋策2_info:"其他角色回合结束阶段须交给你一张牌，然后使用一张锦囊牌，或受到2点神圣伤害。",
            qqwz_谋策3:"谋策",
            qqwz_谋策3_info:"锁定技，你不能成为延时类锦囊的目标",
            qqwz_诈曹:"诈曹",
            qqwz_诈曹_info:"锁定技 每当你失去1点体力后，你摸三张牌增加1点体力上限。然后若此时是你的出牌阶段，则直到回合结束，你使用【杀】无距离限制且不能被【闪】响应，你可以额外使用4张【杀】。",
            qqwz_诈曹2:"诈曹",
            qqwz_诈曹2_info:"",
            qqwz_牺牲:"牺牲",
            qqwz_牺牲_info:"出牌阶段限一次，你可以弃置一张牌，然后失去2点体力。当你受到体力流失伤害后80%回复1点体力",
            qqwz_牺牲2:"牺牲",
            qqwz_牺牲2_info:"你使用的基本牌均结算两次<br>75%概率防止你流失体力或受到伤害",
            qqwz_赤焰:"赤焰",
            qqwz_赤焰_info:"每当你造成伤害时，你可以对全场造成1点神圣火焰伤害，你受到伤害后反弹其1点神圣火焰伤害，你受到火焰伤害均视为回复体力",
            qqwz_赤焰2:"赤焰",
            qqwz_赤焰2_info:"你可以对全场，造成1点体力流失伤害，每回合10次",
            qqwz_赤焰3:"赤焰",
            qqwz_赤焰3_info:"锁定技，你防止即将受到的火焰伤害，改为回复1点体力",
            qqwz_雅逊:"雅逊",
            qqwz_雅逊_info:"每当一张延时类锦囊牌或其他角色使用的普通锦囊牌生效时，若你是此牌的唯一目标，你可以将所有手牌置于你的武将牌上，若如此做，此回合结束时，你获得你武将牌上的所有牌。当你失去最后的手牌时，你可以令至多X名角色各摸2张牌（X为你此次失去的手牌数*2）。",
            qqwz_雅逊2:"雅逊",
            qqwz_雅逊2_info:"",
            qqwz_雅逊3:"雅逊",
            qqwz_雅逊3_info:"当你失去最后的手牌时，你可以令至多X名角色各摸一张牌（X为你此次失去的手牌数）。",
            qqwz_妙心:"妙心",
            qqwz_妙心_info:"出牌阶段限一次，你可以选择一项：将一张方片花色牌当做【乐不思蜀】使用；或弃置一张方片花色牌并弃置场上的一张【乐不思蜀】。选择完成后，你摸一张牌。",
            qqwz_娇啸:"娇啸",
            qqwz_娇啸_info:"当你成为[杀]的目标时你摸一张牌然后可以弃置一张牌将其转移给一名其他角色，此角色不能是[杀]的使用者，你计算与其他角色距离为1",
        },
    },
},files:{"character":["qqwz骁勇虎将.jpg","qqwz舞动生花.jpg","qqwz烈焰燃天.jpg","qqwz玉蟾仙子.jpg","qqwz斩将攫石.jpg","qqwz幻惑众心.jpg","qqwz经达权变.jpg","qqwz雷鸣天启.jpg","qqwz专擅朝政.jpg","qqwz身陷囹圄.jpg","qqwz汉末龙裔.jpg","qqwz月下琵琶.jpg","qqwz登极至尊.jpg","qqwz妙笔为龙.jpg","qqwz西凉猛狮.jpg","qqwz斜倚凤榻.jpg","qqwz真龙之意.jpg","qqwz豪贵名门.jpg","qqwz英姿雄发.jpg","qqwz驭魂千机.jpg","qqwz披坚持锐.jpg","qqwz不鏖遗民.jpg","qqwz拿刀动杖.jpg","qqwz陷阵克敌.jpg","qqwz坐也思君.jpg","qqwz威仪雍容.jpg","qqwz一战而就.jpg","qqwz孤注一掷.jpg","qqwz眉颦笑浅.jpg","qqwz监军谋国.jpg","qqwz烈火焚城.jpg","qqwz目语额瞬.jpg","qqwz独饮醉卧.jpg","qqwz祸乱朝纲.jpg","qqwz夜袭许昌.jpg","qqwz师表海内.jpg","qqwz计权合变.jpg","qqwz善战无前.jpg","qqwz淯水香魂.jpg","qqwz威震塞外.jpg","qqwz赤壁破曹.jpg","qqwz披星踏浪.jpg","qqwz吴王光耀.jpg","qqwz魅影剑舞.jpg","qqwz折冲将军.jpg","qqwz当涂掌事.jpg","qqwz饕餮盛宴.jpg","qqwz矫情之花.jpg","qqwz望君早归.jpg","qqwz缔造联盟.jpg","qqwz豪饮鲸吞.jpg","qqwz魂佑江东.jpg","qqwz笃烈之士.jpg","qqwz少年才俊.jpg","qqwz志善好学.jpg","qqwz药坛圣手.jpg","qqwz策马扬鞭.jpg","qqwz辅国安邦.jpg","qqwz东兴大捷.jpg","qqwz临阵献策.jpg","qqwz安国将军.jpg","qqwz赞国经纶.jpg","qqwz傲世轻物.jpg","qqwz狂直之士.jpg","qqwz倚虎弄权.jpg","qqwz伏路断道.jpg","qqwz才猷蕴借.jpg","qqwz并蒂芙蓉.jpg","qqwz旋击敌寇.jpg","qqwz杀身成仁.jpg","qqwz神行太保.jpg","qqwz溺酒残戮.jpg","qqwz刹那芳华.jpg","qqwz醉酒提矛.jpg","qqwz缘后雅志.jpg","qqwz胆略器用.jpg","qqwz德隆望重.jpg","qqwz豪情烈胆.jpg"],"card":[],"skill":[]}})